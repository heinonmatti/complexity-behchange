<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Recurrence-based Analyses</title>

<script src="site_libs/header-attrs-2.1/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Complexity in behaviour change</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">About</a>
</li>
<li>
  <a href="psyarxiv-in-progress">Manuscript</a>
</li>
<li>
  <a href="assumption-tests.html">Assumption tests</a>
</li>
<li>
  <a href="Recurrence-plots.html">Recurrence-based Analyses</a>
</li>
<li>
  <a href="dataset-info.html">Dataset</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Recurrence-based Analyses</h1>

</div>


<!-- <div style="line-height: 1.7em;"> -->
<p>Source code for this document is found <a href="https://raw.githubusercontent.com/heinonmatti/complexity-behchange/master/Recurrence-plots.Rmd">here</a>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>emadata &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_rds</span>(<span class="st">&quot;./data/EMA_data_Moti13.RDS&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a>emadata_nested &lt;-<span class="st"> </span>emadata <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(User) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="st">                  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="co">#autonomy, competence, relatedness,</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>                                pleasure, interest, importance,</span>
<span id="cb1-6"><a href="#cb1-6"></a>                                <span class="dt">situation_requires =</span> required, </span>
<span id="cb1-7"><a href="#cb1-7"></a>                                <span class="dt">anxiety_guilt_avoidance =</span> anxiety_guilt, </span>
<span id="cb1-8"><a href="#cb1-8"></a>                                <span class="dt">another_wants =</span> for_others,</span>
<span id="cb1-9"><a href="#cb1-9"></a>                                <span class="dt">Date =</span> dateTime,</span>
<span id="cb1-10"><a href="#cb1-10"></a>                                User,</span>
<span id="cb1-11"><a href="#cb1-11"></a>                                task) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="st">                  </span><span class="kw">na.omit</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="co">### </span><span class="al">NOTE</span><span class="co">! NAs removed!</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">nest</span>() </span>
<span id="cb1-14"><a href="#cb1-14"></a></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co"># Show sample size for each participant:</span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="co"># emadata_nested %&gt;% </span></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co">#   mutate(n = map_dbl(data, nrow))</span></span>
<span id="cb1-18"><a href="#cb1-18"></a></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="kw">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb1-20"><a href="#cb1-20"></a></span>
<span id="cb1-21"><a href="#cb1-21"></a>emadata_nested_wrangled &lt;-<span class="st"> </span>emadata_nested <span class="op">%&gt;%</span></span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data =</span> purrr<span class="op">::</span><span class="kw">map</span>(data, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate</span>(.x, </span>
<span id="cb1-23"><a href="#cb1-23"></a>                                                       <span class="dt">date =</span> <span class="kw">as.Date</span>(Date),</span>
<span id="cb1-24"><a href="#cb1-24"></a>                                                       <span class="dt">timediff =</span> <span class="kw">c</span>(<span class="ot">NA</span>, <span class="kw">diff</span>(Date))))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="st">  </span><span class="co"># Filter out answers less than 15 minutes from the last one, then remove the difference variable</span></span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data =</span> purrr<span class="op">::</span><span class="kw">map</span>(data, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">filter</span>(.x, timediff <span class="op">&gt;</span><span class="st"> </span><span class="dv">15</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data =</span> purrr<span class="op">::</span><span class="kw">map</span>(data, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">select</span>(.x, <span class="op">-</span>timediff))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-28"><a href="#cb1-28"></a><span class="st">  </span><span class="co"># Create three datasets, where one daily observation is randomly selected from those available:</span></span>
<span id="cb1-29"><a href="#cb1-29"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">sample1 =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> data, </span>
<span id="cb1-30"><a href="#cb1-30"></a>                                     <span class="dt">.f =</span> <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">group_by</span>(.x, date) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-31"><a href="#cb1-31"></a><span class="st">                                       </span>dplyr<span class="op">::</span><span class="kw">sample_n</span>(., <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-32"><a href="#cb1-32"></a><span class="st">                                       </span>dplyr<span class="op">::</span><span class="kw">ungroup</span>())) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-33"><a href="#cb1-33"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">sample2 =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> data, </span>
<span id="cb1-34"><a href="#cb1-34"></a>                                     <span class="dt">.f =</span> <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">group_by</span>(.x, date) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-35"><a href="#cb1-35"></a><span class="st">                                       </span>dplyr<span class="op">::</span><span class="kw">sample_n</span>(., <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-36"><a href="#cb1-36"></a><span class="st">                                       </span>dplyr<span class="op">::</span><span class="kw">ungroup</span>())) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-37"><a href="#cb1-37"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">sample3 =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> data, </span>
<span id="cb1-38"><a href="#cb1-38"></a>                                     <span class="dt">.f =</span> <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">group_by</span>(.x, date) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-39"><a href="#cb1-39"></a><span class="st">                                       </span>dplyr<span class="op">::</span><span class="kw">sample_n</span>(., <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-40"><a href="#cb1-40"></a><span class="st">                                       </span>dplyr<span class="op">::</span><span class="kw">ungroup</span>())) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-41"><a href="#cb1-41"></a><span class="st">  </span><span class="co"># Create &quot;task-normed&quot; variables, where the previous instance of the task is substracted from the current one:</span></span>
<span id="cb1-42"><a href="#cb1-42"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">taskNormed =</span> purrr<span class="op">::</span><span class="kw">map</span>(data, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">group_by</span>(., task))) <span class="op">%&gt;%</span></span>
<span id="cb1-43"><a href="#cb1-43"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">taskNormed =</span> purrr<span class="op">::</span><span class="kw">map</span>(taskNormed, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate_if</span>(.x, is.numeric, <span class="op">~</span>(.<span class="op">-</span><span class="kw">lag</span>(.))))) <span class="op">%&gt;%</span></span>
<span id="cb1-44"><a href="#cb1-44"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">taskNormed =</span> purrr<span class="op">::</span><span class="kw">map</span>(taskNormed, <span class="op">~</span><span class="kw">na.omit</span>(.x))) <span class="op">%&gt;%</span></span>
<span id="cb1-45"><a href="#cb1-45"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">taskNormed =</span> purrr<span class="op">::</span><span class="kw">map</span>(taskNormed, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">ungroup</span>(.x))) <span class="op">%&gt;%</span></span>
<span id="cb1-46"><a href="#cb1-46"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">taskNormed =</span> purrr<span class="op">::</span><span class="kw">map</span>(taskNormed, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate_if</span>(.x, </span>
<span id="cb1-47"><a href="#cb1-47"></a>                                                                      is.numeric, </span>
<span id="cb1-48"><a href="#cb1-48"></a>                                                                      <span class="op">~</span>scales<span class="op">::</span><span class="kw">rescale</span>(.x, </span>
<span id="cb1-49"><a href="#cb1-49"></a>                                                                                       <span class="dt">to =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">49</span>))))) <span class="op">%&gt;%</span></span>
<span id="cb1-50"><a href="#cb1-50"></a><span class="st">  </span><span class="co"># # Take daily averages to ensure ~equally spaced observations: </span></span>
<span id="cb1-51"><a href="#cb1-51"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data_daily =</span> purrr<span class="op">::</span><span class="kw">map</span>(data, </span>
<span id="cb1-52"><a href="#cb1-52"></a>                                        <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">group_by</span>(., date))) <span class="op">%&gt;%</span></span>
<span id="cb1-53"><a href="#cb1-53"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data_daily =</span> purrr<span class="op">::</span><span class="kw">map</span>(data_daily, </span>
<span id="cb1-54"><a href="#cb1-54"></a>                                        <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">summarise_if</span>(.x, is.numeric, mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) <span class="op">%&gt;%</span></span>
<span id="cb1-55"><a href="#cb1-55"></a><span class="st">  </span><span class="co"># Remove day and task variables</span></span>
<span id="cb1-56"><a href="#cb1-56"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data_with_tasks_and_dates =</span> data,</span>
<span id="cb1-57"><a href="#cb1-57"></a>                <span class="dt">data =</span> purrr<span class="op">::</span><span class="kw">map</span>(data, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">select</span>(.x, <span class="op">-</span>Date, <span class="op">-</span>date, <span class="op">-</span>task))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-58"><a href="#cb1-58"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">taskNormed =</span> purrr<span class="op">::</span><span class="kw">map</span>(taskNormed, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">select</span>(.x, <span class="op">-</span>Date, <span class="op">-</span>date, <span class="op">-</span>task))) <span class="op">%&gt;%</span></span>
<span id="cb1-59"><a href="#cb1-59"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data_daily_with_tasks_and_dates =</span> data_daily,</span>
<span id="cb1-60"><a href="#cb1-60"></a>                <span class="dt">data_daily =</span> purrr<span class="op">::</span><span class="kw">map</span>(data_daily, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">select</span>(.x, <span class="op">-</span>date))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-61"><a href="#cb1-61"></a><span class="st">  </span><span class="co"># Normalise all numeric variables</span></span>
<span id="cb1-62"><a href="#cb1-62"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data_standardised =</span> purrr<span class="op">::</span><span class="kw">map</span>(data, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate_if</span>(.x, is.numeric,</span>
<span id="cb1-63"><a href="#cb1-63"></a>                                                           <span class="op">~</span>((.x <span class="op">/</span><span class="st"> </span><span class="kw">max</span>(.x)))))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-64"><a href="#cb1-64"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">sample1_standardised =</span> purrr<span class="op">::</span><span class="kw">map</span>(sample1, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate_if</span>(.x, is.numeric,</span>
<span id="cb1-65"><a href="#cb1-65"></a>                                                           <span class="op">~</span>((.x <span class="op">/</span><span class="st"> </span><span class="kw">max</span>(.x)))))) <span class="op">%&gt;%</span></span>
<span id="cb1-66"><a href="#cb1-66"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">sample2_standardised =</span> purrr<span class="op">::</span><span class="kw">map</span>(sample2, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate_if</span>(.x, is.numeric,</span>
<span id="cb1-67"><a href="#cb1-67"></a>                                                           <span class="op">~</span>((.x <span class="op">/</span><span class="st"> </span><span class="kw">max</span>(.x)))))) <span class="op">%&gt;%</span></span>
<span id="cb1-68"><a href="#cb1-68"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">sample3_standardised =</span> purrr<span class="op">::</span><span class="kw">map</span>(sample3, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate_if</span>(.x, is.numeric,</span>
<span id="cb1-69"><a href="#cb1-69"></a>                                                           <span class="op">~</span>((.x <span class="op">/</span><span class="st"> </span><span class="kw">max</span>(.x)))))) <span class="op">%&gt;%</span></span>
<span id="cb1-70"><a href="#cb1-70"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data_daily_standardised =</span> purrr<span class="op">::</span><span class="kw">map</span>(data_daily, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate_if</span>(.x, is.numeric,</span>
<span id="cb1-71"><a href="#cb1-71"></a>                                                           <span class="op">~</span>((.x <span class="op">/</span><span class="st"> </span><span class="kw">max</span>(.x)))))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-72"><a href="#cb1-72"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">taskNormed_standardised =</span> purrr<span class="op">::</span><span class="kw">map</span>(taskNormed, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate_if</span>(.x, is.numeric,</span>
<span id="cb1-73"><a href="#cb1-73"></a>                                                           <span class="op">~</span>((.x <span class="op">/</span><span class="st"> </span><span class="kw">max</span>(.x)))))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-74"><a href="#cb1-74"></a><span class="st">  </span><span class="co"># Retain first and last observation of the day:</span></span>
<span id="cb1-75"><a href="#cb1-75"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data_firstlast_divided_by_max =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> data_with_tasks_and_dates, </span>
<span id="cb1-76"><a href="#cb1-76"></a>                                           <span class="dt">.f =</span> <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">group_by</span>(.x, date) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-77"><a href="#cb1-77"></a><span class="st">                                             </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(Date) <span class="op">%&gt;%</span></span>
<span id="cb1-78"><a href="#cb1-78"></a><span class="st">                                             </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">row_number</span>() <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span><span class="kw">row_number</span>() <span class="op">==</span><span class="st"> </span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-79"><a href="#cb1-79"></a><span class="st">                                             </span>dplyr<span class="op">::</span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-80"><a href="#cb1-80"></a><span class="st">                                             </span>dplyr<span class="op">::</span><span class="kw">mutate_if</span>(., is.numeric,</span>
<span id="cb1-81"><a href="#cb1-81"></a>                                                              <span class="op">~</span>(. <span class="op">/</span><span class="st"> </span><span class="kw">max</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)))),</span>
<span id="cb1-82"><a href="#cb1-82"></a>                <span class="dt">data_firstlast_divided_by_max_with_tasks_and_dates =</span> data_firstlast_divided_by_max,</span>
<span id="cb1-83"><a href="#cb1-83"></a>                <span class="dt">data_firstlast_divided_by_max =</span> purrr<span class="op">::</span><span class="kw">map</span>(data_firstlast_divided_by_max, </span>
<span id="cb1-84"><a href="#cb1-84"></a>                                                           <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">select</span>(.x, <span class="op">-</span>Date, <span class="op">-</span>date, <span class="op">-</span>task)))</span></code></pre></div>
<p>In this document, we provide supplementary information about recurrence-based analyses. We also provide code for the figures in the manuscript.</p>
<div id="recurrence-network-demo" class="section level1 tabset">
<h1 class="tabset">Recurrence network demo</h1>
<p>Our participant was beeped 5 times a day for all the questions, during an 8-hour period they determined as their workday. In order to meet the requirement of approximately equidistant measures as well as possible, in the analysis presented in the manuscript, we chose to only use the first and last observation of the day (when more than 2 time points were available for a given day).</p>
<p>Below, we present other choices that could have been made as sensitivity analyses. Results in three tabs come from sampling one time point randomly from all available measurement occasions each day, with the aim of fulfilling the equidistance requirement as well as possible. We also present results for using all the data, ignoring the equidistance requirement completely. Lastly, we present results for “task-norming” the data – that is, substracting from the current six values of the variables, those from the previous time the task was conducted (and ignoring the equidistance requirement). It can be seen, that most of the profiles can be found from analysis, although their order may differ. We opted not to take the average of daily measures, as the ecological momentary assessment questions were tied to the particular tasks and moments at hand, and an average would not have necessarily represented any of the occasions it consisted of.</p>
<div id="first-and-last-daily-observations" class="section level2">
<h2>First and last daily observations</h2>
<p>Here’s the 6-dimensional motivation system’s recurrence plot, weighted by similarity.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#######################</span></span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co"># si = similarity under the radius</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">RN =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> data_firstlast_divided_by_max,</span>
<span id="cb2-8"><a href="#cb2-8"></a>                                <span class="dt">.f =</span>  <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rn</span>(.x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="co">#autonomy, competence, relatedness,</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>                                                                       pleasure, interest, importance,</span>
<span id="cb2-10"><a href="#cb2-10"></a>                                                                       situation_requires, </span>
<span id="cb2-11"><a href="#cb2-11"></a>                                                                       anxiety_guilt_avoidance, </span>
<span id="cb2-12"><a href="#cb2-12"></a>                                                                       another_wants), </span>
<span id="cb2-13"><a href="#cb2-13"></a>                                                  <span class="dt">doEmbed =</span> <span class="ot">FALSE</span>, </span>
<span id="cb2-14"><a href="#cb2-14"></a>                                                  <span class="dt">weighted =</span> <span class="ot">TRUE</span>, </span>
<span id="cb2-15"><a href="#cb2-15"></a>                                                  <span class="dt">weightedBy =</span> <span class="st">&quot;si&quot;</span>, </span>
<span id="cb2-16"><a href="#cb2-16"></a>                                                  <span class="dt">emRad =</span> <span class="ot">NA</span>)))</span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="co">## </span></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co">## Auto-recurrence: Setting diagonal to (1 + max. distance) for analyses</span></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="co">## </span></span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="co">## Searching for a radius that will yield 0.05 for RR</span></span>
<span id="cb2-21"><a href="#cb2-21"></a></span>
<span id="cb2-22"><a href="#cb2-22"></a>emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-23"><a href="#cb2-23"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">graph_from_adjacency =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> RN,</span>
<span id="cb2-24"><a href="#cb2-24"></a>                                                  <span class="dt">.f =</span> <span class="op">~</span>igraph<span class="op">::</span><span class="kw">graph_from_adjacency_matrix</span>(.x, </span>
<span id="cb2-25"><a href="#cb2-25"></a>                                                                                            <span class="dt">weighted =</span> <span class="ot">TRUE</span>, </span>
<span id="cb2-26"><a href="#cb2-26"></a>                                                                                            <span class="dt">mode =</span> <span class="st">&quot;upper&quot;</span>, </span>
<span id="cb2-27"><a href="#cb2-27"></a>                                                                                            <span class="dt">diag =</span> <span class="ot">FALSE</span>)))</span>
<span id="cb2-28"><a href="#cb2-28"></a></span>
<span id="cb2-29"><a href="#cb2-29"></a><span class="co"># Edges with their distances</span></span>
<span id="cb2-30"><a href="#cb2-30"></a>emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-31"><a href="#cb2-31"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">edges_with_distances =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> graph_from_adjacency,</span>
<span id="cb2-32"><a href="#cb2-32"></a>                                                  <span class="dt">.f =</span> <span class="op">~</span>igraph<span class="op">::</span><span class="kw">E</span>(.x)<span class="op">$</span>weight),</span>
<span id="cb2-33"><a href="#cb2-33"></a>                <span class="dt">graph_from_adjacency_orig =</span> graph_from_adjacency)</span>
<span id="cb2-34"><a href="#cb2-34"></a></span>
<span id="cb2-35"><a href="#cb2-35"></a><span class="co"># Larger values are closer to the state; inverse of weight makes it more intuitive</span></span>
<span id="cb2-36"><a href="#cb2-36"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets)) {</span>
<span id="cb2-37"><a href="#cb2-37"></a>igraph<span class="op">::</span><span class="kw">E</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>weight &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>emadata_nested_wrangled_both_recnets<span class="op">$</span>edges_with_distances[[i]])</span>
<span id="cb2-38"><a href="#cb2-38"></a>}</span>
<span id="cb2-39"><a href="#cb2-39"></a><span class="co"># A later note to self: Now weight is a measure of distance; how far apart two time points are</span></span>
<span id="cb2-40"><a href="#cb2-40"></a><span class="co"># (under the radius, i.e. they&#39;re reasonably similar to begin with)</span></span>
<span id="cb2-41"><a href="#cb2-41"></a></span>
<span id="cb2-42"><a href="#cb2-42"></a><span class="co">####### To check:</span></span>
<span id="cb2-43"><a href="#cb2-43"></a><span class="co"># igraph::E(emadata_nested_wrangled_both_recnets$graph_from_adjacency[[1]])$weight</span></span>
<span id="cb2-44"><a href="#cb2-44"></a><span class="co"># igraph::E(emadata_nested_wrangled_both_recnets$graph_from_adjacency_orig[[1]])$weight</span></span>
<span id="cb2-45"><a href="#cb2-45"></a></span>
<span id="cb2-46"><a href="#cb2-46"></a>emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-47"><a href="#cb2-47"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">RN_plot =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> RN,</span>
<span id="cb2-48"><a href="#cb2-48"></a>                                <span class="dt">.f =</span>  <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rn_plot</span>(.x,</span>
<span id="cb2-49"><a href="#cb2-49"></a>                                                       <span class="dt">plotDimensions =</span> <span class="ot">TRUE</span>,</span>
<span id="cb2-50"><a href="#cb2-50"></a>                                                       <span class="dt">xlab =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>,</span>
<span id="cb2-51"><a href="#cb2-51"></a>                                                       <span class="dt">ylab =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>)))</span></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/firstlast-weighted-1.png" width="2100" /></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co"># Make node size equal to strength. Strength is the sum of a node&#39;s edge weights.</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets)) {</span>
<span id="cb3-4"><a href="#cb3-4"></a>igraph<span class="op">::</span><span class="kw">V</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>size &lt;-<span class="st"> </span>(igraph<span class="op">::</span><span class="kw">strength</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]]))</span>
<span id="cb3-5"><a href="#cb3-5"></a>}</span>
<span id="cb3-6"><a href="#cb3-6"></a></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co"># Rescaling weight as &quot;width&quot;; varies between 5 and 10</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets)) {</span>
<span id="cb3-9"><a href="#cb3-9"></a>igraph<span class="op">::</span><span class="kw">E</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>width &lt;-<span class="st"> </span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="st">  </span>casnet<span class="op">::</span><span class="kw">elascer</span>(igraph<span class="op">::</span><span class="kw">E</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>weight, <span class="dt">lo =</span> <span class="dv">5</span>, <span class="dt">hi =</span> <span class="dv">10</span>)</span>
<span id="cb3-11"><a href="#cb3-11"></a>}</span></code></pre></div>
<p>The lengthy code chunk below extracts and marks attractors in the data.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Get number of maximally connected node</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">max_connected_day =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> graph_from_adjacency,</span>
<span id="cb4-4"><a href="#cb4-4"></a>                                     <span class="dt">.f =</span>  <span class="op">~</span><span class="kw">which.max</span>(igraph<span class="op">::</span><span class="kw">degree</span>(.x))</span>
<span id="cb4-5"><a href="#cb4-5"></a>                                     ))</span>
<span id="cb4-6"><a href="#cb4-6"></a></span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a></span>
<span id="cb4-9"><a href="#cb4-9"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">list_of_edges =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> graph_from_adjacency,</span>
<span id="cb4-11"><a href="#cb4-11"></a>                                     <span class="dt">.f =</span>  <span class="op">~</span>igraph<span class="op">::</span><span class="kw">get.data.frame</span>(.x)</span>
<span id="cb4-12"><a href="#cb4-12"></a>                                     ))</span>
<span id="cb4-13"><a href="#cb4-13"></a></span>
<span id="cb4-14"><a href="#cb4-14"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> </span>
<span id="cb4-16"><a href="#cb4-16"></a>                  purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> data_firstlast_divided_by_max,</span>
<span id="cb4-17"><a href="#cb4-17"></a>                              <span class="dt">.y =</span> graph_from_adjacency,</span>
<span id="cb4-18"><a href="#cb4-18"></a>                              <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb4-19"><a href="#cb4-19"></a>                                <span class="kw">data.frame</span>(.x <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-20"><a href="#cb4-20"></a><span class="st">                                             </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="co">#autonomy, competence, relatedness,</span></span>
<span id="cb4-21"><a href="#cb4-21"></a>                                                                       pleasure, interest, importance,</span>
<span id="cb4-22"><a href="#cb4-22"></a>                                                                       situation_requires, anxiety_guilt_avoidance, another_wants), </span>
<span id="cb4-23"><a href="#cb4-23"></a>                                           <span class="dt">strength =</span> igraph<span class="op">::</span><span class="kw">strength</span>(.y)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-24"><a href="#cb4-24"></a><span class="st">                                  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">time =</span> dplyr<span class="op">::</span><span class="kw">row_number</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-25"><a href="#cb4-25"></a><span class="st">                                  </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(<span class="op">-</span>strength, <span class="op">-</span>time))</span>
<span id="cb4-26"><a href="#cb4-26"></a>                              }</span>
<span id="cb4-27"><a href="#cb4-27"></a>  ))</span>
<span id="cb4-28"><a href="#cb4-28"></a></span>
<span id="cb4-29"><a href="#cb4-29"></a><span class="co"># Extract nodes (i.e. times) which connect to the strongest (i.e. most connected) node</span></span>
<span id="cb4-30"><a href="#cb4-30"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-31"><a href="#cb4-31"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</span>
<span id="cb4-32"><a href="#cb4-32"></a>                                                      <span class="dt">.y =</span> max_connected_day,</span>
<span id="cb4-33"><a href="#cb4-33"></a>                                                      <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb4-34"><a href="#cb4-34"></a>                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-35"><a href="#cb4-35"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-36"><a href="#cb4-36"></a><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</span>
<span id="cb4-37"><a href="#cb4-37"></a>                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-38"><a href="#cb4-38"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </span>
<span id="cb4-39"><a href="#cb4-39"></a>                                                                          <span class="co">#.keep_all = TRUE</span></span>
<span id="cb4-40"><a href="#cb4-40"></a>                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-41"><a href="#cb4-41"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</span>
<span id="cb4-42"><a href="#cb4-42"></a>                                                      }</span>
<span id="cb4-43"><a href="#cb4-43"></a>                                                      )</span>
<span id="cb4-44"><a href="#cb4-44"></a>  )</span>
<span id="cb4-45"><a href="#cb4-45"></a></span>
<span id="cb4-46"><a href="#cb4-46"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-47"><a href="#cb4-47"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb4-48"><a href="#cb4-48"></a>                                                       <span class="dt">.y =</span> connecting_to_strongest,</span>
<span id="cb4-49"><a href="#cb4-49"></a>                                                       <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb4-50"><a href="#cb4-50"></a>                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb4-51"><a href="#cb4-51"></a>                                                                       <span class="dt">connecting_to_strongest =</span> </span>
<span id="cb4-52"><a href="#cb4-52"></a>                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb4-53"><a href="#cb4-53"></a>                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb4-54"><a href="#cb4-54"></a>                                                       }</span>
<span id="cb4-55"><a href="#cb4-55"></a>  ))</span>
<span id="cb4-56"><a href="#cb4-56"></a></span>
<span id="cb4-57"><a href="#cb4-57"></a><span class="co"># Get number of 2nd maximally connected node, which doesn&#39;t connect to the 1st</span></span>
<span id="cb4-58"><a href="#cb4-58"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-59"><a href="#cb4-59"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">secondary_attractor_day =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> graph_from_adjacency,</span>
<span id="cb4-60"><a href="#cb4-60"></a>                                                      <span class="dt">.y =</span> connecting_to_strongest,</span>
<span id="cb4-61"><a href="#cb4-61"></a>                                                      <span class="dt">.f =</span>  <span class="op">~</span>{</span>
<span id="cb4-62"><a href="#cb4-62"></a>                                                        <span class="kw">data.frame</span>(<span class="dt">degree =</span> igraph<span class="op">::</span><span class="kw">degree</span>(.x), </span>
<span id="cb4-63"><a href="#cb4-63"></a>                                                                   <span class="dt">time =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(igraph<span class="op">::</span><span class="kw">degree</span>(.x))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-64"><a href="#cb4-64"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-65"><a href="#cb4-65"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(degree)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-66"><a href="#cb4-66"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-67"><a href="#cb4-67"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(time)</span>
<span id="cb4-68"><a href="#cb4-68"></a>                                                      }                                                    </span>
<span id="cb4-69"><a href="#cb4-69"></a>  ))</span>
<span id="cb4-70"><a href="#cb4-70"></a></span>
<span id="cb4-71"><a href="#cb4-71"></a><span class="co"># Extract nodes (i.e. times) which connect to the 2nd strongest node, which doesn&#39;t connect to the 1st</span></span>
<span id="cb4-72"><a href="#cb4-72"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-73"><a href="#cb4-73"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_2nd_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</span>
<span id="cb4-74"><a href="#cb4-74"></a>                                                      <span class="dt">.y =</span> secondary_attractor_day,</span>
<span id="cb4-75"><a href="#cb4-75"></a>                                                      <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb4-76"><a href="#cb4-76"></a>                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-77"><a href="#cb4-77"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-78"><a href="#cb4-78"></a><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</span>
<span id="cb4-79"><a href="#cb4-79"></a>                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-80"><a href="#cb4-80"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </span>
<span id="cb4-81"><a href="#cb4-81"></a>                                                                          <span class="co">#.keep_all = TRUE</span></span>
<span id="cb4-82"><a href="#cb4-82"></a>                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-83"><a href="#cb4-83"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</span>
<span id="cb4-84"><a href="#cb4-84"></a>                                                      }</span>
<span id="cb4-85"><a href="#cb4-85"></a>                                                      )</span>
<span id="cb4-86"><a href="#cb4-86"></a>  )</span>
<span id="cb4-87"><a href="#cb4-87"></a></span>
<span id="cb4-88"><a href="#cb4-88"></a><span class="co"># Save as a variable in the dataset</span></span>
<span id="cb4-89"><a href="#cb4-89"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-90"><a href="#cb4-90"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb4-91"><a href="#cb4-91"></a>                                                       <span class="dt">.y =</span> connecting_to_2nd_strongest,</span>
<span id="cb4-92"><a href="#cb4-92"></a>                                                       <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb4-93"><a href="#cb4-93"></a>                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb4-94"><a href="#cb4-94"></a>                                                                       <span class="dt">connecting_to_2nd_strongest =</span> </span>
<span id="cb4-95"><a href="#cb4-95"></a>                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb4-96"><a href="#cb4-96"></a>                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb4-97"><a href="#cb4-97"></a>                                                       }</span>
<span id="cb4-98"><a href="#cb4-98"></a>  ))</span>
<span id="cb4-99"><a href="#cb4-99"></a></span>
<span id="cb4-100"><a href="#cb4-100"></a><span class="co"># Get number of 3rd maximally connected node, which doesn&#39;t connect to the 1st or second</span></span>
<span id="cb4-101"><a href="#cb4-101"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-102"><a href="#cb4-102"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">tertiary_attractor_day =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> graph_from_adjacency,</span>
<span id="cb4-103"><a href="#cb4-103"></a>                                                      <span class="dt">..2 =</span> connecting_to_strongest,</span>
<span id="cb4-104"><a href="#cb4-104"></a>                                                      <span class="dt">..3 =</span> connecting_to_2nd_strongest),</span>
<span id="cb4-105"><a href="#cb4-105"></a>                                                      <span class="dt">.f =</span>  <span class="op">~</span>{</span>
<span id="cb4-106"><a href="#cb4-106"></a>                                                        <span class="kw">data.frame</span>(<span class="dt">degree =</span> igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>), </span>
<span id="cb4-107"><a href="#cb4-107"></a>                                                                   <span class="dt">time =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-108"><a href="#cb4-108"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">2</span>, </span>
<span id="cb4-109"><a href="#cb4-109"></a>                                                                        <span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-110"><a href="#cb4-110"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(degree)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-111"><a href="#cb4-111"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-112"><a href="#cb4-112"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(time)</span>
<span id="cb4-113"><a href="#cb4-113"></a>                                                      }                                                    </span>
<span id="cb4-114"><a href="#cb4-114"></a>  ))</span>
<span id="cb4-115"><a href="#cb4-115"></a></span>
<span id="cb4-116"><a href="#cb4-116"></a><span class="co"># Extract nodes (i.e. times) which connect to the 3rd strongest node</span></span>
<span id="cb4-117"><a href="#cb4-117"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-118"><a href="#cb4-118"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_3rd_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</span>
<span id="cb4-119"><a href="#cb4-119"></a>                                                      <span class="dt">.y =</span> tertiary_attractor_day,</span>
<span id="cb4-120"><a href="#cb4-120"></a>                                                      <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb4-121"><a href="#cb4-121"></a>                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-122"><a href="#cb4-122"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-123"><a href="#cb4-123"></a><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</span>
<span id="cb4-124"><a href="#cb4-124"></a>                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-125"><a href="#cb4-125"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </span>
<span id="cb4-126"><a href="#cb4-126"></a>                                                                          <span class="co">#.keep_all = TRUE</span></span>
<span id="cb4-127"><a href="#cb4-127"></a>                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-128"><a href="#cb4-128"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</span>
<span id="cb4-129"><a href="#cb4-129"></a>                                                      }</span>
<span id="cb4-130"><a href="#cb4-130"></a>                                                      )</span>
<span id="cb4-131"><a href="#cb4-131"></a>  )</span>
<span id="cb4-132"><a href="#cb4-132"></a></span>
<span id="cb4-133"><a href="#cb4-133"></a><span class="co"># Save as a variable</span></span>
<span id="cb4-134"><a href="#cb4-134"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-135"><a href="#cb4-135"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb4-136"><a href="#cb4-136"></a>                                                       <span class="dt">.y =</span> connecting_to_3rd_strongest,</span>
<span id="cb4-137"><a href="#cb4-137"></a>                                                       <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb4-138"><a href="#cb4-138"></a>                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb4-139"><a href="#cb4-139"></a>                                                                       <span class="dt">connecting_to_3rd_strongest =</span> </span>
<span id="cb4-140"><a href="#cb4-140"></a>                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb4-141"><a href="#cb4-141"></a>                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb4-142"><a href="#cb4-142"></a>                                                       }</span>
<span id="cb4-143"><a href="#cb4-143"></a>  ))</span>
<span id="cb4-144"><a href="#cb4-144"></a></span>
<span id="cb4-145"><a href="#cb4-145"></a></span>
<span id="cb4-146"><a href="#cb4-146"></a></span>
<span id="cb4-147"><a href="#cb4-147"></a><span class="co"># Get number of 4th maximally connected node, which doesn&#39;t connect to the 1st or second</span></span>
<span id="cb4-148"><a href="#cb4-148"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-149"><a href="#cb4-149"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">fourth_attractor_day =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> graph_from_adjacency,</span>
<span id="cb4-150"><a href="#cb4-150"></a>                                                      <span class="dt">..2 =</span> connecting_to_strongest,</span>
<span id="cb4-151"><a href="#cb4-151"></a>                                                      <span class="dt">..3 =</span> connecting_to_2nd_strongest,</span>
<span id="cb4-152"><a href="#cb4-152"></a>                                                      <span class="dt">..4 =</span> connecting_to_3rd_strongest),</span>
<span id="cb4-153"><a href="#cb4-153"></a>                                                      <span class="dt">.f =</span>  <span class="op">~</span>{</span>
<span id="cb4-154"><a href="#cb4-154"></a>                                                        <span class="kw">data.frame</span>(<span class="dt">degree =</span> igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>), </span>
<span id="cb4-155"><a href="#cb4-155"></a>                                                                   <span class="dt">time =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-156"><a href="#cb4-156"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">2</span>, </span>
<span id="cb4-157"><a href="#cb4-157"></a>                                                                        <span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">3</span>, </span>
<span id="cb4-158"><a href="#cb4-158"></a>                                                                        <span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-159"><a href="#cb4-159"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(degree)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-160"><a href="#cb4-160"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-161"><a href="#cb4-161"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(time)</span>
<span id="cb4-162"><a href="#cb4-162"></a>                                                      }                                                    </span>
<span id="cb4-163"><a href="#cb4-163"></a>  ))</span>
<span id="cb4-164"><a href="#cb4-164"></a></span>
<span id="cb4-165"><a href="#cb4-165"></a><span class="co"># Extract nodes (i.e. times) which connect to the 3rd strongest node</span></span>
<span id="cb4-166"><a href="#cb4-166"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-167"><a href="#cb4-167"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_4th_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</span>
<span id="cb4-168"><a href="#cb4-168"></a>                                                      <span class="dt">.y =</span> fourth_attractor_day,</span>
<span id="cb4-169"><a href="#cb4-169"></a>                                                      <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb4-170"><a href="#cb4-170"></a>                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-171"><a href="#cb4-171"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-172"><a href="#cb4-172"></a><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</span>
<span id="cb4-173"><a href="#cb4-173"></a>                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-174"><a href="#cb4-174"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </span>
<span id="cb4-175"><a href="#cb4-175"></a>                                                                          <span class="co">#.keep_all = TRUE</span></span>
<span id="cb4-176"><a href="#cb4-176"></a>                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-177"><a href="#cb4-177"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</span>
<span id="cb4-178"><a href="#cb4-178"></a>                                                      }</span>
<span id="cb4-179"><a href="#cb4-179"></a>                                                      )</span>
<span id="cb4-180"><a href="#cb4-180"></a>  )</span>
<span id="cb4-181"><a href="#cb4-181"></a></span>
<span id="cb4-182"><a href="#cb4-182"></a><span class="co"># Save as a variable</span></span>
<span id="cb4-183"><a href="#cb4-183"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-184"><a href="#cb4-184"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb4-185"><a href="#cb4-185"></a>                                                       <span class="dt">.y =</span> connecting_to_4th_strongest,</span>
<span id="cb4-186"><a href="#cb4-186"></a>                                                       <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb4-187"><a href="#cb4-187"></a>                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb4-188"><a href="#cb4-188"></a>                                                                       <span class="dt">connecting_to_4th_strongest =</span> </span>
<span id="cb4-189"><a href="#cb4-189"></a>                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb4-190"><a href="#cb4-190"></a>                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb4-191"><a href="#cb4-191"></a>                                                       }</span>
<span id="cb4-192"><a href="#cb4-192"></a>  ))</span>
<span id="cb4-193"><a href="#cb4-193"></a></span>
<span id="cb4-194"><a href="#cb4-194"></a><span class="co">################### Make plots</span></span>
<span id="cb4-195"><a href="#cb4-195"></a></span>
<span id="cb4-196"><a href="#cb4-196"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-197"><a href="#cb4-197"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> </span>
<span id="cb4-198"><a href="#cb4-198"></a>                  purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb4-199"><a href="#cb4-199"></a>                             <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb4-200"><a href="#cb4-200"></a>                               dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb4-201"><a href="#cb4-201"></a>                                             <span class="dt">attractors =</span> dplyr<span class="op">::</span><span class="kw">case_when</span>(</span>
<span id="cb4-202"><a href="#cb4-202"></a>                                               strength <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> &quot;Unique&quot;</span>,</span>
<span id="cb4-203"><a href="#cb4-203"></a>                                               connecting_to_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;1st&quot;</span>,</span>
<span id="cb4-204"><a href="#cb4-204"></a>                                               connecting_to_2nd_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;2nd&quot;</span>,</span>
<span id="cb4-205"><a href="#cb4-205"></a>                                               connecting_to_3rd_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;3rd&quot;</span>,</span>
<span id="cb4-206"><a href="#cb4-206"></a>                                               connecting_to_4th_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;4th&quot;</span>,</span>
<span id="cb4-207"><a href="#cb4-207"></a>                                               <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Uncategorised&quot;</span>),</span>
<span id="cb4-208"><a href="#cb4-208"></a>                                             <span class="dt">attractors =</span> <span class="kw">factor</span>(attractors,</span>
<span id="cb4-209"><a href="#cb4-209"></a>                                                                 <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;1st&quot;</span>,</span>
<span id="cb4-210"><a href="#cb4-210"></a>                                                                            <span class="st">&quot;2nd&quot;</span>,</span>
<span id="cb4-211"><a href="#cb4-211"></a>                                                                            <span class="st">&quot;3rd&quot;</span>,</span>
<span id="cb4-212"><a href="#cb4-212"></a>                                                                            <span class="st">&quot;4th&quot;</span>,</span>
<span id="cb4-213"><a href="#cb4-213"></a>                                                                            <span class="st">&quot;Uncategorised&quot;</span>,</span>
<span id="cb4-214"><a href="#cb4-214"></a>                                                                            <span class="st">&quot;Unique&quot;</span>)),</span>
<span id="cb4-215"><a href="#cb4-215"></a>                                             <span class="dt">name =</span> <span class="kw">factor</span>(name,</span>
<span id="cb4-216"><a href="#cb4-216"></a>                                                           <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;pleasure&quot;</span>,</span>
<span id="cb4-217"><a href="#cb4-217"></a>                                                                      <span class="st">&quot;interest&quot;</span>,</span>
<span id="cb4-218"><a href="#cb4-218"></a>                                                                      <span class="st">&quot;importance&quot;</span>,</span>
<span id="cb4-219"><a href="#cb4-219"></a>                                                                      <span class="st">&quot;situation_requires&quot;</span>,</span>
<span id="cb4-220"><a href="#cb4-220"></a>                                                                      <span class="st">&quot;anxiety_guilt_avoidance&quot;</span>,</span>
<span id="cb4-221"><a href="#cb4-221"></a>                                                                      <span class="st">&quot;another_wants&quot;</span>),</span>
<span id="cb4-222"><a href="#cb4-222"></a>                                                           <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Pleasure&quot;</span>,</span>
<span id="cb4-223"><a href="#cb4-223"></a>                                                                      <span class="st">&quot;Interest&quot;</span>,</span>
<span id="cb4-224"><a href="#cb4-224"></a>                                                                      <span class="st">&quot;Importance&quot;</span>,</span>
<span id="cb4-225"><a href="#cb4-225"></a>                                                                      <span class="st">&quot;Situation requires&quot;</span>,</span>
<span id="cb4-226"><a href="#cb4-226"></a>                                                                      <span class="st">&quot;Anxiety guilt avoidance&quot;</span>,</span>
<span id="cb4-227"><a href="#cb4-227"></a>                                                                      <span class="st">&quot;Another wants&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-228"><a href="#cb4-228"></a><span class="st">                                               </span>forcats<span class="op">::</span><span class="kw">fct_drop</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-229"><a href="#cb4-229"></a><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(attractors, name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-230"><a href="#cb4-230"></a><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-231"><a href="#cb4-231"></a><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb4-232"><a href="#cb4-232"></a><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">maxtime =</span> <span class="kw">max</span>(time),</span>
<span id="cb4-233"><a href="#cb4-233"></a>                                               <span class="dt">percentage_of_total =</span></span>
<span id="cb4-234"><a href="#cb4-234"></a>                                                 (n <span class="op">/</span><span class="st"> </span>maxtime) <span class="op">%&gt;%</span><span class="st"> </span>scales<span class="op">::</span><span class="kw">percent</span>(<span class="dt">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb4-235"><a href="#cb4-235"></a>                                               <span class="dt">proportion_of_total =</span> n<span class="op">/</span>maxtime,</span>
<span id="cb4-236"><a href="#cb4-236"></a>                                               <span class="dt">attractors_n =</span> </span>
<span id="cb4-237"><a href="#cb4-237"></a>                                                 <span class="kw">factor</span>(<span class="kw">paste0</span>(attractors,</span>
<span id="cb4-238"><a href="#cb4-238"></a>                                                               <span class="st">&quot; (n = &quot;</span>, n, <span class="st">&quot;; &quot;</span>, </span>
<span id="cb4-239"><a href="#cb4-239"></a>                                                               percentage_of_total, <span class="st">&quot;)&quot;</span>)))</span>
<span id="cb4-240"><a href="#cb4-240"></a>                             }</span>
<span id="cb4-241"><a href="#cb4-241"></a>                  ))</span></code></pre></div>
<div id="spiral-graph-with-colored-nodes" class="section level3">
<h3>Spiral graph with colored nodes</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">node_colors =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb5-3"><a href="#cb5-3"></a>                                         <span class="dt">.f =</span> <span class="op">~</span>{tidyr<span class="op">::</span><span class="kw">pivot_wider</span>(.x, <span class="dt">names_from =</span> name) <span class="op">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="st">                                             </span>dplyr<span class="op">::</span><span class="kw">pull</span>(attractors)}))</span>
<span id="cb5-5"><a href="#cb5-5"></a></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets_nodes_plots)) {</span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="kw">levels</span>(emadata_nested_wrangled_both_recnets_nodes_plots<span class="op">$</span>node_colors[[i]]) &lt;-<span class="st"> </span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="st">  </span><span class="kw">c</span>(viridisLite<span class="op">::</span><span class="kw">plasma</span>(<span class="dv">4</span>, </span>
<span id="cb5-9"><a href="#cb5-9"></a>                      <span class="dt">end =</span> <span class="fl">0.8</span>, </span>
<span id="cb5-10"><a href="#cb5-10"></a>                      <span class="dt">direction =</span> <span class="dv">-1</span>), <span class="st">&quot;gray48&quot;</span>, <span class="st">&quot;white&quot;</span>)</span>
<span id="cb5-11"><a href="#cb5-11"></a>  }</span>
<span id="cb5-12"><a href="#cb5-12"></a></span>
<span id="cb5-13"><a href="#cb5-13"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">spiralgraph_epochs =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> graph_from_adjacency,</span>
<span id="cb5-15"><a href="#cb5-15"></a>                                          <span class="dt">..2 =</span> node_colors,</span>
<span id="cb5-16"><a href="#cb5-16"></a>                                          <span class="dt">..3 =</span> User),</span>
<span id="cb5-17"><a href="#cb5-17"></a>                                     <span class="dt">.f =</span>  <span class="op">~</span>casnet<span class="op">::</span><span class="kw">make_spiral_graph</span>(<span class="dt">g =</span> ..<span class="dv">1</span>, </span>
<span id="cb5-18"><a href="#cb5-18"></a>                                                                      <span class="dt">arcs =</span> <span class="dv">4</span>, </span>
<span id="cb5-19"><a href="#cb5-19"></a>                                                                      <span class="co"># a = .1, </span></span>
<span id="cb5-20"><a href="#cb5-20"></a>                                                                      <span class="co"># b = 2, </span></span>
<span id="cb5-21"><a href="#cb5-21"></a>                                                                      <span class="dt">markTimeBy =</span> <span class="ot">TRUE</span>,</span>
<span id="cb5-22"><a href="#cb5-22"></a>                                                                      <span class="dt">markEpochsBy =</span> ..<span class="dv">2</span>,</span>
<span id="cb5-23"><a href="#cb5-23"></a>                                                                      <span class="dt">epochColours =</span> ..<span class="dv">2</span>,</span>
<span id="cb5-24"><a href="#cb5-24"></a>                                                                      <span class="dt">showEpochLegend =</span> <span class="ot">FALSE</span>,</span>
<span id="cb5-25"><a href="#cb5-25"></a>                                                                      <span class="dt">scaleEdgeSize =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">10</span>,</span>
<span id="cb5-26"><a href="#cb5-26"></a>                                                                      <span class="dt">scaleVertexSize =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">5</span>),</span>
<span id="cb5-27"><a href="#cb5-27"></a>                                                                      <span class="dt">showSizeLegend =</span> <span class="ot">FALSE</span>,</span>
<span id="cb5-28"><a href="#cb5-28"></a>                                                                      <span class="dt">sizeLabel =</span> <span class="st">&quot;Node strength&quot;</span>,</span>
<span id="cb5-29"><a href="#cb5-29"></a>                                                                      <span class="dt">type =</span> <span class="st">&quot;Euler&quot;</span>,</span>
<span id="cb5-30"><a href="#cb5-30"></a>                                                                      <span class="co"># alphaE = 0.1</span></span>
<span id="cb5-31"><a href="#cb5-31"></a>                                                                      <span class="co"># title = ..3</span></span>
<span id="cb5-32"><a href="#cb5-32"></a>                                     )))</span></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/firstlast-spiralgraph-1.png" width="2100" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co"># emadata_nested_wrangled_both_recnets_nodes_plots$spiralgraph_epochs[[1]] +</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">#   theme(plot.margin=grid::unit(c(0,0,0,0), &quot;mm&quot;))</span></span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co"># ggsave(filename = &quot;./figures/recnetwork.png&quot;,</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co">#        width = 7, </span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co">#        height = 7)</span></span>
<span id="cb6-8"><a href="#cb6-8"></a></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="co"># emadata_nested_wrangled_both_recnets_nodes_plots$all_nodes_with_strengths[[1]]</span></span></code></pre></div>
</div>
<div id="attractor-plot" class="section level3">
<h3>Attractor plot</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">observations =</span> purrr<span class="op">::</span><span class="kw">map_dbl</span>(<span class="dt">.x =</span> data_firstlast_divided_by_max,</span>
<span id="cb7-3"><a href="#cb7-3"></a>                                              <span class="dt">.f =</span> <span class="op">~</span><span class="kw">nrow</span>(.)))</span>
<span id="cb7-4"><a href="#cb7-4"></a></span>
<span id="cb7-5"><a href="#cb7-5"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">observations_daily =</span> purrr<span class="op">::</span><span class="kw">map_dbl</span>(<span class="dt">.x =</span> data_daily,</span>
<span id="cb7-7"><a href="#cb7-7"></a>                                              <span class="dt">.f =</span> <span class="op">~</span><span class="kw">nrow</span>(.)))</span>
<span id="cb7-8"><a href="#cb7-8"></a></span>
<span id="cb7-9"><a href="#cb7-9"></a></span>
<span id="cb7-10"><a href="#cb7-10"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(</span>
<span id="cb7-12"><a href="#cb7-12"></a>    <span class="dt">attractor_plots =</span> </span>
<span id="cb7-13"><a href="#cb7-13"></a>      purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> all_nodes_with_strengths,</span>
<span id="cb7-14"><a href="#cb7-14"></a>                       <span class="dt">..2 =</span> observations,</span>
<span id="cb7-15"><a href="#cb7-15"></a>                       <span class="dt">..3 =</span> observations_daily,</span>
<span id="cb7-16"><a href="#cb7-16"></a>                       <span class="dt">..4 =</span> User),</span>
<span id="cb7-17"><a href="#cb7-17"></a>                  <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb7-18"><a href="#cb7-18"></a>                    dplyr<span class="op">::</span><span class="kw">mutate</span>(..<span class="dv">1</span>,</span>
<span id="cb7-19"><a href="#cb7-19"></a>                                  <span class="dt">strength_rescaled =</span> </span>
<span id="cb7-20"><a href="#cb7-20"></a>                                    scales<span class="op">::</span><span class="kw">rescale</span>(strength, <span class="dt">to =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">1.1</span>)),</span>
<span id="cb7-21"><a href="#cb7-21"></a>                                  <span class="dt">alpha_strength =</span> <span class="kw">ifelse</span>(strength_rescaled <span class="op">==</span><span class="st"> </span><span class="fl">0.3</span>, </span>
<span id="cb7-22"><a href="#cb7-22"></a>                                                          <span class="fl">0.5</span>, </span>
<span id="cb7-23"><a href="#cb7-23"></a>                                                          strength_rescaled)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-24"><a href="#cb7-24"></a><span class="st">                      </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</span>
<span id="cb7-25"><a href="#cb7-25"></a>                             <span class="kw">aes</span>(<span class="dt">x =</span> forcats<span class="op">::</span><span class="kw">fct_rev</span>(name), </span>
<span id="cb7-26"><a href="#cb7-26"></a>                                 <span class="dt">y =</span> value, </span>
<span id="cb7-27"><a href="#cb7-27"></a>                                 <span class="dt">size =</span> strength_rescaled,</span>
<span id="cb7-28"><a href="#cb7-28"></a>                                 <span class="dt">alpha =</span> alpha_strength,</span>
<span id="cb7-29"><a href="#cb7-29"></a>                                 <span class="dt">color =</span> attractors_n)) <span class="op">+</span></span>
<span id="cb7-30"><a href="#cb7-30"></a><span class="st">                      </span><span class="kw">scale_size_identity</span>() <span class="op">+</span></span>
<span id="cb7-31"><a href="#cb7-31"></a><span class="st">                      </span><span class="kw">scale_alpha_identity</span>() <span class="op">+</span></span>
<span id="cb7-32"><a href="#cb7-32"></a><span class="st">                      </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">alpha =</span> alpha_strength)) <span class="op">+</span></span>
<span id="cb7-33"><a href="#cb7-33"></a><span class="st">                      </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> time,</span>
<span id="cb7-34"><a href="#cb7-34"></a>                                    <span class="dt">alpha =</span> alpha_strength)) <span class="op">+</span></span>
<span id="cb7-35"><a href="#cb7-35"></a><span class="st">                      </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(viridisLite<span class="op">::</span><span class="kw">plasma</span>(<span class="dv">4</span>, </span>
<span id="cb7-36"><a href="#cb7-36"></a>                                                                        <span class="dt">end =</span> <span class="fl">0.8</span>, </span>
<span id="cb7-37"><a href="#cb7-37"></a>                                                                        <span class="dt">direction =</span> <span class="dv">-1</span>), </span>
<span id="cb7-38"><a href="#cb7-38"></a>                                                    <span class="st">&quot;gray40&quot;</span>, <span class="st">&quot;gray50&quot;</span>)) <span class="op">+</span></span>
<span id="cb7-39"><a href="#cb7-39"></a><span class="st">                      </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">label_percent</span>(<span class="dt">accuracy =</span> <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb7-40"><a href="#cb7-40"></a><span class="st">                      </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb7-41"><a href="#cb7-41"></a><span class="st">                      </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb7-42"><a href="#cb7-42"></a><span class="st">                      </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Percentage of maximum reported value of variable, across full time series&quot;</span>,</span>
<span id="cb7-43"><a href="#cb7-43"></a>                           <span class="dt">x =</span> <span class="ot">NULL</span>,</span>
<span id="cb7-44"><a href="#cb7-44"></a>                           <span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&quot;Participant </span><span class="ch">\&quot;</span><span class="st">&quot;</span>, ..<span class="dv">4</span>, <span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st"> - based on &quot;</span>, ..<span class="dv">2</span>, <span class="st">&quot; data points (&quot;</span>, ..<span class="dv">3</span>, <span class="st">&quot; days)&quot;</span>)) <span class="op">+</span></span>
<span id="cb7-45"><a href="#cb7-45"></a><span class="st">                      </span><span class="kw">facet_wrap</span>(<span class="op">~</span>attractors_n) <span class="op">+</span></span>
<span id="cb7-46"><a href="#cb7-46"></a><span class="st">                      </span><span class="kw">coord_flip</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb7-47"><a href="#cb7-47"></a>                  }</span>
<span id="cb7-48"><a href="#cb7-48"></a>      ))</span>
<span id="cb7-49"><a href="#cb7-49"></a></span>
<span id="cb7-50"><a href="#cb7-50"></a>emadata_nested_wrangled_both_recnets_nodes_plots<span class="op">$</span>attractor_plots[[<span class="dv">1</span>]]</span></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/attractor-plots-1.png" width="2100" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># emadata_nested_wrangled_both_recnets_nodes_plots$all_nodes_with_strengths[[1]]</span></span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co"># Save this to be used for the task analysis later; otherwise overwritten by sensitivity analyses:</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>firstlast_emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="st">  </span>emadata_nested_wrangled_both_recnets_nodes_plots</span>
<span id="cb8-6"><a href="#cb8-6"></a></span>
<span id="cb8-7"><a href="#cb8-7"></a>cowplot<span class="op">::</span><span class="kw">save_plot</span>(<span class="st">&quot;./figures/attractors.png&quot;</span>, </span>
<span id="cb8-8"><a href="#cb8-8"></a>                   emadata_nested_wrangled_both_recnets_nodes_plots<span class="op">$</span>attractor_plots[[<span class="dv">1</span>]], </span>
<span id="cb8-9"><a href="#cb8-9"></a>                   <span class="dt">dpi =</span> <span class="dv">300</span>,</span>
<span id="cb8-10"><a href="#cb8-10"></a>                   <span class="dt">base_height =</span> <span class="fl">11.69</span><span class="op">/</span><span class="dv">2</span>)</span></code></pre></div>
<p>We can observe four main attractors in the plot. The panel labeled <em>1st</em> shows a relatively balanced profile, with situational requirements slightly elevated. The modal task (see next section) in this profile is internal meetings. The <em>2nd</em> panel indicates a profile, which is quite high on the pleasure, interest and importance dimensions, with intermediate values on situational requirements and avoiding anxiety or guilt but extrinsic demands are low. This profile, too, is dominated by internal meetings. The <em>3rd</em> attractor resembles the 1st, but has lower situational requirements and extrinsic demands; the most common task in this profile is email. The <em>4th</em> attractor shows the theoretically most optimal profile for this person; high on the three autonomous motivation types and low on the extrinsic motivations. This profile consists of providing training, writing a book, as well as single cases of internal meetings, participating in an event, and reading a report.</p>
<p>A few additional attractors can be seen in the <em>Uncategorised</em> panel. These uncharted, weaker profiles (as measured by their frequency and homogeneity), seem to consist of mostly low profiles on the “another wants” dimension. Two profiles seem to be distinguished; one consisting of high values on pleasure, interest and importance, combined with low values on situational requirements and avoiding anxiety or guilt, whereas another uncategorised profile seems to indicate the opposite of these. Tasks vary widely, the modal ones being internal meetings and email.</p>
<p>The <em>Unique</em> panel depicts profiles that cannot be grouped under one of the other configurations, thus deemed to only occur once. These also consist mostly of internal meetings and email.</p>
</div>
</div>
<div id="single-randomly-sampled-daily-observation" class="section level2 unlisted unnumbered">
<h2 class="unlisted unnumbered">1. Single randomly sampled daily observation</h2>
<p>Here’s the 6-dimensional motivation system’s recurrence plot, weighted by similarity.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">#######################</span></span>
<span id="cb9-4"><a href="#cb9-4"></a></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co"># si = similarity under the radius</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">RN =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> sample1_standardised,</span>
<span id="cb9-8"><a href="#cb9-8"></a>                                <span class="dt">.f =</span>  <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rn</span>(.x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="co">#autonomy, competence, relatedness,</span></span>
<span id="cb9-9"><a href="#cb9-9"></a>                                                                       pleasure, interest, importance,</span>
<span id="cb9-10"><a href="#cb9-10"></a>                                                                       situation_requires, </span>
<span id="cb9-11"><a href="#cb9-11"></a>                                                                       anxiety_guilt_avoidance, </span>
<span id="cb9-12"><a href="#cb9-12"></a>                                                                       another_wants), </span>
<span id="cb9-13"><a href="#cb9-13"></a>                                                  <span class="dt">doEmbed =</span> <span class="ot">FALSE</span>, </span>
<span id="cb9-14"><a href="#cb9-14"></a>                                                  <span class="dt">weighted =</span> <span class="ot">TRUE</span>, </span>
<span id="cb9-15"><a href="#cb9-15"></a>                                                  <span class="dt">weightedBy =</span> <span class="st">&quot;si&quot;</span>, </span>
<span id="cb9-16"><a href="#cb9-16"></a>                                                  <span class="dt">emRad =</span> <span class="ot">NA</span>)))</span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="co">## </span></span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="co">## Auto-recurrence: Setting diagonal to (1 + max. distance) for analyses</span></span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="co">## </span></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="co">## Searching for a radius that will yield 0.05 for RR</span></span>
<span id="cb9-21"><a href="#cb9-21"></a></span>
<span id="cb9-22"><a href="#cb9-22"></a>emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-23"><a href="#cb9-23"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">graph_from_adjacency =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> RN,</span>
<span id="cb9-24"><a href="#cb9-24"></a>                                                  <span class="dt">.f =</span> <span class="op">~</span>igraph<span class="op">::</span><span class="kw">graph_from_adjacency_matrix</span>(.x, </span>
<span id="cb9-25"><a href="#cb9-25"></a>                                                                                            <span class="dt">weighted =</span> <span class="ot">TRUE</span>, </span>
<span id="cb9-26"><a href="#cb9-26"></a>                                                                                            <span class="dt">mode =</span> <span class="st">&quot;upper&quot;</span>, </span>
<span id="cb9-27"><a href="#cb9-27"></a>                                                                                            <span class="dt">diag =</span> <span class="ot">FALSE</span>)))</span>
<span id="cb9-28"><a href="#cb9-28"></a></span>
<span id="cb9-29"><a href="#cb9-29"></a><span class="co"># Edges with their distances</span></span>
<span id="cb9-30"><a href="#cb9-30"></a>emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-31"><a href="#cb9-31"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">edges_with_distances =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> graph_from_adjacency,</span>
<span id="cb9-32"><a href="#cb9-32"></a>                                                  <span class="dt">.f =</span> <span class="op">~</span>igraph<span class="op">::</span><span class="kw">E</span>(.x)<span class="op">$</span>weight),</span>
<span id="cb9-33"><a href="#cb9-33"></a>                <span class="dt">graph_from_adjacency_orig =</span> graph_from_adjacency)</span>
<span id="cb9-34"><a href="#cb9-34"></a></span>
<span id="cb9-35"><a href="#cb9-35"></a><span class="co"># Larger values are closer to the state; inverse of weight makes it more intuitive</span></span>
<span id="cb9-36"><a href="#cb9-36"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets)) {</span>
<span id="cb9-37"><a href="#cb9-37"></a>igraph<span class="op">::</span><span class="kw">E</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>weight &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>emadata_nested_wrangled_both_recnets<span class="op">$</span>edges_with_distances[[i]])</span>
<span id="cb9-38"><a href="#cb9-38"></a>}</span>
<span id="cb9-39"><a href="#cb9-39"></a><span class="co"># A later note to self: Now weight is a measure of distance; how far apart two time points are</span></span>
<span id="cb9-40"><a href="#cb9-40"></a><span class="co"># (under the radius, i.e. they&#39;re reasonably similar to begin with)</span></span>
<span id="cb9-41"><a href="#cb9-41"></a></span>
<span id="cb9-42"><a href="#cb9-42"></a><span class="co">####### To check:</span></span>
<span id="cb9-43"><a href="#cb9-43"></a><span class="co"># igraph::E(emadata_nested_wrangled_both_recnets$graph_from_adjacency[[1]])$weight</span></span>
<span id="cb9-44"><a href="#cb9-44"></a><span class="co"># igraph::E(emadata_nested_wrangled_both_recnets$graph_from_adjacency_orig[[1]])$weight</span></span>
<span id="cb9-45"><a href="#cb9-45"></a></span>
<span id="cb9-46"><a href="#cb9-46"></a>emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-47"><a href="#cb9-47"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">RN_plot =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> RN,</span>
<span id="cb9-48"><a href="#cb9-48"></a>                                <span class="dt">.f =</span>  <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rn_plot</span>(.x,</span>
<span id="cb9-49"><a href="#cb9-49"></a>                                                       <span class="dt">plotDimensions =</span> <span class="ot">TRUE</span>,</span>
<span id="cb9-50"><a href="#cb9-50"></a>                                                       <span class="dt">xlab =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>,</span>
<span id="cb9-51"><a href="#cb9-51"></a>                                                       <span class="dt">ylab =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>)))</span></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/unnamed-chunk-1-1.png" width="2100" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co"># Make node size equal to strength. Strength is the sum of a node&#39;s edge weights.</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets)) {</span>
<span id="cb10-4"><a href="#cb10-4"></a>igraph<span class="op">::</span><span class="kw">V</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>size &lt;-<span class="st"> </span>(igraph<span class="op">::</span><span class="kw">strength</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]]))</span>
<span id="cb10-5"><a href="#cb10-5"></a>}</span>
<span id="cb10-6"><a href="#cb10-6"></a></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co"># Rescaling weight as &quot;width&quot;; varies between 5 and 10</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets)) {</span>
<span id="cb10-9"><a href="#cb10-9"></a>igraph<span class="op">::</span><span class="kw">E</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>width &lt;-<span class="st"> </span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="st">  </span>casnet<span class="op">::</span><span class="kw">elascer</span>(igraph<span class="op">::</span><span class="kw">E</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>weight, <span class="dt">lo =</span> <span class="dv">5</span>, <span class="dt">hi =</span> <span class="dv">10</span>)</span>
<span id="cb10-11"><a href="#cb10-11"></a>}</span></code></pre></div>
<p>The lengthy code chunk below extracts and marks attractors in the data.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># Get number of maximally connected node</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">max_connected_day =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> graph_from_adjacency,</span>
<span id="cb11-4"><a href="#cb11-4"></a>                                     <span class="dt">.f =</span>  <span class="op">~</span><span class="kw">which.max</span>(igraph<span class="op">::</span><span class="kw">degree</span>(.x))</span>
<span id="cb11-5"><a href="#cb11-5"></a>                                     ))</span>
<span id="cb11-6"><a href="#cb11-6"></a></span>
<span id="cb11-7"><a href="#cb11-7"></a></span>
<span id="cb11-8"><a href="#cb11-8"></a></span>
<span id="cb11-9"><a href="#cb11-9"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">list_of_edges =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> graph_from_adjacency,</span>
<span id="cb11-11"><a href="#cb11-11"></a>                                     <span class="dt">.f =</span>  <span class="op">~</span>igraph<span class="op">::</span><span class="kw">get.data.frame</span>(.x)</span>
<span id="cb11-12"><a href="#cb11-12"></a>                                     ))</span>
<span id="cb11-13"><a href="#cb11-13"></a></span>
<span id="cb11-14"><a href="#cb11-14"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> </span>
<span id="cb11-16"><a href="#cb11-16"></a>                  purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> sample1_standardised,</span>
<span id="cb11-17"><a href="#cb11-17"></a>                              <span class="dt">.y =</span> graph_from_adjacency,</span>
<span id="cb11-18"><a href="#cb11-18"></a>                              <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb11-19"><a href="#cb11-19"></a>                                <span class="kw">data.frame</span>(.x <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-20"><a href="#cb11-20"></a><span class="st">                                             </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="co">#autonomy, competence, relatedness,</span></span>
<span id="cb11-21"><a href="#cb11-21"></a>                                                                       pleasure, interest, importance,</span>
<span id="cb11-22"><a href="#cb11-22"></a>                                                                       situation_requires, anxiety_guilt_avoidance, another_wants), </span>
<span id="cb11-23"><a href="#cb11-23"></a>                                           <span class="dt">strength =</span> igraph<span class="op">::</span><span class="kw">strength</span>(.y)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-24"><a href="#cb11-24"></a><span class="st">                                  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">time =</span> dplyr<span class="op">::</span><span class="kw">row_number</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-25"><a href="#cb11-25"></a><span class="st">                                  </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(<span class="op">-</span>strength, <span class="op">-</span>time))</span>
<span id="cb11-26"><a href="#cb11-26"></a>                              }</span>
<span id="cb11-27"><a href="#cb11-27"></a>  ))</span>
<span id="cb11-28"><a href="#cb11-28"></a></span>
<span id="cb11-29"><a href="#cb11-29"></a><span class="co"># Extract nodes (i.e. times) which connect to the strongest (i.e. most connected) node</span></span>
<span id="cb11-30"><a href="#cb11-30"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-31"><a href="#cb11-31"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</span>
<span id="cb11-32"><a href="#cb11-32"></a>                                                      <span class="dt">.y =</span> max_connected_day,</span>
<span id="cb11-33"><a href="#cb11-33"></a>                                                      <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb11-34"><a href="#cb11-34"></a>                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-35"><a href="#cb11-35"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-36"><a href="#cb11-36"></a><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</span>
<span id="cb11-37"><a href="#cb11-37"></a>                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-38"><a href="#cb11-38"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </span>
<span id="cb11-39"><a href="#cb11-39"></a>                                                                          <span class="co">#.keep_all = TRUE</span></span>
<span id="cb11-40"><a href="#cb11-40"></a>                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-41"><a href="#cb11-41"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</span>
<span id="cb11-42"><a href="#cb11-42"></a>                                                      }</span>
<span id="cb11-43"><a href="#cb11-43"></a>                                                      )</span>
<span id="cb11-44"><a href="#cb11-44"></a>  )</span>
<span id="cb11-45"><a href="#cb11-45"></a></span>
<span id="cb11-46"><a href="#cb11-46"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-47"><a href="#cb11-47"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb11-48"><a href="#cb11-48"></a>                                                       <span class="dt">.y =</span> connecting_to_strongest,</span>
<span id="cb11-49"><a href="#cb11-49"></a>                                                       <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb11-50"><a href="#cb11-50"></a>                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb11-51"><a href="#cb11-51"></a>                                                                       <span class="dt">connecting_to_strongest =</span> </span>
<span id="cb11-52"><a href="#cb11-52"></a>                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb11-53"><a href="#cb11-53"></a>                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb11-54"><a href="#cb11-54"></a>                                                       }</span>
<span id="cb11-55"><a href="#cb11-55"></a>  ))</span>
<span id="cb11-56"><a href="#cb11-56"></a></span>
<span id="cb11-57"><a href="#cb11-57"></a><span class="co"># Get number of 2nd maximally connected node, which doesn&#39;t connect to the 1st</span></span>
<span id="cb11-58"><a href="#cb11-58"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-59"><a href="#cb11-59"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">secondary_attractor_day =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> graph_from_adjacency,</span>
<span id="cb11-60"><a href="#cb11-60"></a>                                                      <span class="dt">.y =</span> connecting_to_strongest,</span>
<span id="cb11-61"><a href="#cb11-61"></a>                                                      <span class="dt">.f =</span>  <span class="op">~</span>{</span>
<span id="cb11-62"><a href="#cb11-62"></a>                                                        <span class="kw">data.frame</span>(<span class="dt">degree =</span> igraph<span class="op">::</span><span class="kw">degree</span>(.x), </span>
<span id="cb11-63"><a href="#cb11-63"></a>                                                                   <span class="dt">time =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(igraph<span class="op">::</span><span class="kw">degree</span>(.x))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-64"><a href="#cb11-64"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-65"><a href="#cb11-65"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(degree)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-66"><a href="#cb11-66"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-67"><a href="#cb11-67"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(time)</span>
<span id="cb11-68"><a href="#cb11-68"></a>                                                      }                                                    </span>
<span id="cb11-69"><a href="#cb11-69"></a>  ))</span>
<span id="cb11-70"><a href="#cb11-70"></a></span>
<span id="cb11-71"><a href="#cb11-71"></a><span class="co"># Extract nodes (i.e. times) which connect to the 2nd strongest node, which doesn&#39;t connect to the 1st</span></span>
<span id="cb11-72"><a href="#cb11-72"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-73"><a href="#cb11-73"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_2nd_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</span>
<span id="cb11-74"><a href="#cb11-74"></a>                                                      <span class="dt">.y =</span> secondary_attractor_day,</span>
<span id="cb11-75"><a href="#cb11-75"></a>                                                      <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb11-76"><a href="#cb11-76"></a>                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-77"><a href="#cb11-77"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-78"><a href="#cb11-78"></a><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</span>
<span id="cb11-79"><a href="#cb11-79"></a>                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-80"><a href="#cb11-80"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </span>
<span id="cb11-81"><a href="#cb11-81"></a>                                                                          <span class="co">#.keep_all = TRUE</span></span>
<span id="cb11-82"><a href="#cb11-82"></a>                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-83"><a href="#cb11-83"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</span>
<span id="cb11-84"><a href="#cb11-84"></a>                                                      }</span>
<span id="cb11-85"><a href="#cb11-85"></a>                                                      )</span>
<span id="cb11-86"><a href="#cb11-86"></a>  )</span>
<span id="cb11-87"><a href="#cb11-87"></a></span>
<span id="cb11-88"><a href="#cb11-88"></a><span class="co"># Save as a variable in the dataset</span></span>
<span id="cb11-89"><a href="#cb11-89"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-90"><a href="#cb11-90"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb11-91"><a href="#cb11-91"></a>                                                       <span class="dt">.y =</span> connecting_to_2nd_strongest,</span>
<span id="cb11-92"><a href="#cb11-92"></a>                                                       <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb11-93"><a href="#cb11-93"></a>                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb11-94"><a href="#cb11-94"></a>                                                                       <span class="dt">connecting_to_2nd_strongest =</span> </span>
<span id="cb11-95"><a href="#cb11-95"></a>                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb11-96"><a href="#cb11-96"></a>                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb11-97"><a href="#cb11-97"></a>                                                       }</span>
<span id="cb11-98"><a href="#cb11-98"></a>  ))</span>
<span id="cb11-99"><a href="#cb11-99"></a></span>
<span id="cb11-100"><a href="#cb11-100"></a><span class="co"># Get number of 3rd maximally connected node, which doesn&#39;t connect to the 1st or second</span></span>
<span id="cb11-101"><a href="#cb11-101"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-102"><a href="#cb11-102"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">tertiary_attractor_day =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> graph_from_adjacency,</span>
<span id="cb11-103"><a href="#cb11-103"></a>                                                      <span class="dt">..2 =</span> connecting_to_strongest,</span>
<span id="cb11-104"><a href="#cb11-104"></a>                                                      <span class="dt">..3 =</span> connecting_to_2nd_strongest),</span>
<span id="cb11-105"><a href="#cb11-105"></a>                                                      <span class="dt">.f =</span>  <span class="op">~</span>{</span>
<span id="cb11-106"><a href="#cb11-106"></a>                                                        <span class="kw">data.frame</span>(<span class="dt">degree =</span> igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>), </span>
<span id="cb11-107"><a href="#cb11-107"></a>                                                                   <span class="dt">time =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-108"><a href="#cb11-108"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">2</span>, </span>
<span id="cb11-109"><a href="#cb11-109"></a>                                                                        <span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-110"><a href="#cb11-110"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(degree)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-111"><a href="#cb11-111"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-112"><a href="#cb11-112"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(time)</span>
<span id="cb11-113"><a href="#cb11-113"></a>                                                      }                                                    </span>
<span id="cb11-114"><a href="#cb11-114"></a>  ))</span>
<span id="cb11-115"><a href="#cb11-115"></a></span>
<span id="cb11-116"><a href="#cb11-116"></a><span class="co"># Extract nodes (i.e. times) which connect to the 3rd strongest node</span></span>
<span id="cb11-117"><a href="#cb11-117"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-118"><a href="#cb11-118"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_3rd_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</span>
<span id="cb11-119"><a href="#cb11-119"></a>                                                      <span class="dt">.y =</span> tertiary_attractor_day,</span>
<span id="cb11-120"><a href="#cb11-120"></a>                                                      <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb11-121"><a href="#cb11-121"></a>                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-122"><a href="#cb11-122"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-123"><a href="#cb11-123"></a><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</span>
<span id="cb11-124"><a href="#cb11-124"></a>                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-125"><a href="#cb11-125"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </span>
<span id="cb11-126"><a href="#cb11-126"></a>                                                                          <span class="co">#.keep_all = TRUE</span></span>
<span id="cb11-127"><a href="#cb11-127"></a>                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-128"><a href="#cb11-128"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</span>
<span id="cb11-129"><a href="#cb11-129"></a>                                                      }</span>
<span id="cb11-130"><a href="#cb11-130"></a>                                                      )</span>
<span id="cb11-131"><a href="#cb11-131"></a>  )</span>
<span id="cb11-132"><a href="#cb11-132"></a></span>
<span id="cb11-133"><a href="#cb11-133"></a><span class="co"># Save as a variable</span></span>
<span id="cb11-134"><a href="#cb11-134"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-135"><a href="#cb11-135"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb11-136"><a href="#cb11-136"></a>                                                       <span class="dt">.y =</span> connecting_to_3rd_strongest,</span>
<span id="cb11-137"><a href="#cb11-137"></a>                                                       <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb11-138"><a href="#cb11-138"></a>                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb11-139"><a href="#cb11-139"></a>                                                                       <span class="dt">connecting_to_3rd_strongest =</span> </span>
<span id="cb11-140"><a href="#cb11-140"></a>                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb11-141"><a href="#cb11-141"></a>                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb11-142"><a href="#cb11-142"></a>                                                       }</span>
<span id="cb11-143"><a href="#cb11-143"></a>  ))</span>
<span id="cb11-144"><a href="#cb11-144"></a></span>
<span id="cb11-145"><a href="#cb11-145"></a></span>
<span id="cb11-146"><a href="#cb11-146"></a></span>
<span id="cb11-147"><a href="#cb11-147"></a><span class="co"># Get number of 4th maximally connected node, which doesn&#39;t connect to the 1st or second</span></span>
<span id="cb11-148"><a href="#cb11-148"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-149"><a href="#cb11-149"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">fourth_attractor_day =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> graph_from_adjacency,</span>
<span id="cb11-150"><a href="#cb11-150"></a>                                                      <span class="dt">..2 =</span> connecting_to_strongest,</span>
<span id="cb11-151"><a href="#cb11-151"></a>                                                      <span class="dt">..3 =</span> connecting_to_2nd_strongest,</span>
<span id="cb11-152"><a href="#cb11-152"></a>                                                      <span class="dt">..4 =</span> connecting_to_3rd_strongest),</span>
<span id="cb11-153"><a href="#cb11-153"></a>                                                      <span class="dt">.f =</span>  <span class="op">~</span>{</span>
<span id="cb11-154"><a href="#cb11-154"></a>                                                        <span class="kw">data.frame</span>(<span class="dt">degree =</span> igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>), </span>
<span id="cb11-155"><a href="#cb11-155"></a>                                                                   <span class="dt">time =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-156"><a href="#cb11-156"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">2</span>, </span>
<span id="cb11-157"><a href="#cb11-157"></a>                                                                        <span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">3</span>, </span>
<span id="cb11-158"><a href="#cb11-158"></a>                                                                        <span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-159"><a href="#cb11-159"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(degree)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-160"><a href="#cb11-160"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-161"><a href="#cb11-161"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(time)</span>
<span id="cb11-162"><a href="#cb11-162"></a>                                                      }                                                    </span>
<span id="cb11-163"><a href="#cb11-163"></a>  ))</span>
<span id="cb11-164"><a href="#cb11-164"></a></span>
<span id="cb11-165"><a href="#cb11-165"></a><span class="co"># Extract nodes (i.e. times) which connect to the 3rd strongest node</span></span>
<span id="cb11-166"><a href="#cb11-166"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-167"><a href="#cb11-167"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_4th_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</span>
<span id="cb11-168"><a href="#cb11-168"></a>                                                      <span class="dt">.y =</span> fourth_attractor_day,</span>
<span id="cb11-169"><a href="#cb11-169"></a>                                                      <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb11-170"><a href="#cb11-170"></a>                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-171"><a href="#cb11-171"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-172"><a href="#cb11-172"></a><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</span>
<span id="cb11-173"><a href="#cb11-173"></a>                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-174"><a href="#cb11-174"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </span>
<span id="cb11-175"><a href="#cb11-175"></a>                                                                          <span class="co">#.keep_all = TRUE</span></span>
<span id="cb11-176"><a href="#cb11-176"></a>                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-177"><a href="#cb11-177"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</span>
<span id="cb11-178"><a href="#cb11-178"></a>                                                      }</span>
<span id="cb11-179"><a href="#cb11-179"></a>                                                      )</span>
<span id="cb11-180"><a href="#cb11-180"></a>  )</span>
<span id="cb11-181"><a href="#cb11-181"></a></span>
<span id="cb11-182"><a href="#cb11-182"></a><span class="co"># Save as a variable</span></span>
<span id="cb11-183"><a href="#cb11-183"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-184"><a href="#cb11-184"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb11-185"><a href="#cb11-185"></a>                                                       <span class="dt">.y =</span> connecting_to_4th_strongest,</span>
<span id="cb11-186"><a href="#cb11-186"></a>                                                       <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb11-187"><a href="#cb11-187"></a>                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb11-188"><a href="#cb11-188"></a>                                                                       <span class="dt">connecting_to_4th_strongest =</span> </span>
<span id="cb11-189"><a href="#cb11-189"></a>                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb11-190"><a href="#cb11-190"></a>                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb11-191"><a href="#cb11-191"></a>                                                       }</span>
<span id="cb11-192"><a href="#cb11-192"></a>  ))</span>
<span id="cb11-193"><a href="#cb11-193"></a></span>
<span id="cb11-194"><a href="#cb11-194"></a><span class="co">################### Make plots</span></span>
<span id="cb11-195"><a href="#cb11-195"></a></span>
<span id="cb11-196"><a href="#cb11-196"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-197"><a href="#cb11-197"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> </span>
<span id="cb11-198"><a href="#cb11-198"></a>                  purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb11-199"><a href="#cb11-199"></a>                             <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb11-200"><a href="#cb11-200"></a>                               dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb11-201"><a href="#cb11-201"></a>                                             <span class="dt">attractors =</span> dplyr<span class="op">::</span><span class="kw">case_when</span>(</span>
<span id="cb11-202"><a href="#cb11-202"></a>                                               strength <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> &quot;Unique&quot;</span>,</span>
<span id="cb11-203"><a href="#cb11-203"></a>                                               connecting_to_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;1st&quot;</span>,</span>
<span id="cb11-204"><a href="#cb11-204"></a>                                               connecting_to_2nd_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;2nd&quot;</span>,</span>
<span id="cb11-205"><a href="#cb11-205"></a>                                               connecting_to_3rd_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;3rd&quot;</span>,</span>
<span id="cb11-206"><a href="#cb11-206"></a>                                               connecting_to_4th_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;4th&quot;</span>,</span>
<span id="cb11-207"><a href="#cb11-207"></a>                                               <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Uncategorised&quot;</span>),</span>
<span id="cb11-208"><a href="#cb11-208"></a>                                             <span class="dt">attractors =</span> <span class="kw">factor</span>(attractors,</span>
<span id="cb11-209"><a href="#cb11-209"></a>                                                                 <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;1st&quot;</span>,</span>
<span id="cb11-210"><a href="#cb11-210"></a>                                                                            <span class="st">&quot;2nd&quot;</span>,</span>
<span id="cb11-211"><a href="#cb11-211"></a>                                                                            <span class="st">&quot;3rd&quot;</span>,</span>
<span id="cb11-212"><a href="#cb11-212"></a>                                                                            <span class="st">&quot;4th&quot;</span>,</span>
<span id="cb11-213"><a href="#cb11-213"></a>                                                                            <span class="st">&quot;Uncategorised&quot;</span>,</span>
<span id="cb11-214"><a href="#cb11-214"></a>                                                                            <span class="st">&quot;Unique&quot;</span>)),</span>
<span id="cb11-215"><a href="#cb11-215"></a>                                             <span class="dt">name =</span> <span class="kw">factor</span>(name,</span>
<span id="cb11-216"><a href="#cb11-216"></a>                                                           <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;pleasure&quot;</span>,</span>
<span id="cb11-217"><a href="#cb11-217"></a>                                                                      <span class="st">&quot;interest&quot;</span>,</span>
<span id="cb11-218"><a href="#cb11-218"></a>                                                                      <span class="st">&quot;importance&quot;</span>,</span>
<span id="cb11-219"><a href="#cb11-219"></a>                                                                      <span class="st">&quot;situation_requires&quot;</span>,</span>
<span id="cb11-220"><a href="#cb11-220"></a>                                                                      <span class="st">&quot;anxiety_guilt_avoidance&quot;</span>,</span>
<span id="cb11-221"><a href="#cb11-221"></a>                                                                      <span class="st">&quot;another_wants&quot;</span>),</span>
<span id="cb11-222"><a href="#cb11-222"></a>                                                           <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Pleasure&quot;</span>,</span>
<span id="cb11-223"><a href="#cb11-223"></a>                                                                      <span class="st">&quot;Interest&quot;</span>,</span>
<span id="cb11-224"><a href="#cb11-224"></a>                                                                      <span class="st">&quot;Importance&quot;</span>,</span>
<span id="cb11-225"><a href="#cb11-225"></a>                                                                      <span class="st">&quot;Situation requires&quot;</span>,</span>
<span id="cb11-226"><a href="#cb11-226"></a>                                                                      <span class="st">&quot;Anxiety guilt avoidance&quot;</span>,</span>
<span id="cb11-227"><a href="#cb11-227"></a>                                                                      <span class="st">&quot;Another wants&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-228"><a href="#cb11-228"></a><span class="st">                                               </span>forcats<span class="op">::</span><span class="kw">fct_drop</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-229"><a href="#cb11-229"></a><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(attractors, name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-230"><a href="#cb11-230"></a><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-231"><a href="#cb11-231"></a><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb11-232"><a href="#cb11-232"></a><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">maxtime =</span> <span class="kw">max</span>(time),</span>
<span id="cb11-233"><a href="#cb11-233"></a>                                               <span class="dt">percentage_of_total =</span></span>
<span id="cb11-234"><a href="#cb11-234"></a>                                                 (n <span class="op">/</span><span class="st"> </span>maxtime) <span class="op">%&gt;%</span><span class="st"> </span>scales<span class="op">::</span><span class="kw">percent</span>(<span class="dt">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb11-235"><a href="#cb11-235"></a>                                               <span class="dt">proportion_of_total =</span> n<span class="op">/</span>maxtime,</span>
<span id="cb11-236"><a href="#cb11-236"></a>                                               <span class="dt">attractors_n =</span> </span>
<span id="cb11-237"><a href="#cb11-237"></a>                                                 <span class="kw">factor</span>(<span class="kw">paste0</span>(attractors,</span>
<span id="cb11-238"><a href="#cb11-238"></a>                                                               <span class="st">&quot; (n = &quot;</span>, n, <span class="st">&quot;; &quot;</span>, </span>
<span id="cb11-239"><a href="#cb11-239"></a>                                                               percentage_of_total, <span class="st">&quot;)&quot;</span>)))</span>
<span id="cb11-240"><a href="#cb11-240"></a>                             }</span>
<span id="cb11-241"><a href="#cb11-241"></a>                  ))</span></code></pre></div>
<div id="spiral-graph-with-colored-nodes-1" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">Spiral graph with colored nodes</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">node_colors =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb12-3"><a href="#cb12-3"></a>                                         <span class="dt">.f =</span> <span class="op">~</span>{tidyr<span class="op">::</span><span class="kw">pivot_wider</span>(.x, <span class="dt">names_from =</span> name) <span class="op">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="st">                                             </span>dplyr<span class="op">::</span><span class="kw">pull</span>(attractors)}))</span>
<span id="cb12-5"><a href="#cb12-5"></a></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets_nodes_plots)) {</span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="kw">levels</span>(emadata_nested_wrangled_both_recnets_nodes_plots<span class="op">$</span>node_colors[[i]]) &lt;-<span class="st"> </span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="st">  </span><span class="kw">c</span>(viridisLite<span class="op">::</span><span class="kw">plasma</span>(<span class="dv">4</span>, </span>
<span id="cb12-9"><a href="#cb12-9"></a>                      <span class="dt">end =</span> <span class="fl">0.8</span>, </span>
<span id="cb12-10"><a href="#cb12-10"></a>                      <span class="dt">direction =</span> <span class="dv">-1</span>), <span class="st">&quot;gray48&quot;</span>, <span class="st">&quot;white&quot;</span>)</span>
<span id="cb12-11"><a href="#cb12-11"></a>  }</span>
<span id="cb12-12"><a href="#cb12-12"></a></span>
<span id="cb12-13"><a href="#cb12-13"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">spiralgraph_epochs =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> graph_from_adjacency,</span>
<span id="cb12-15"><a href="#cb12-15"></a>                                          <span class="dt">..2 =</span> node_colors,</span>
<span id="cb12-16"><a href="#cb12-16"></a>                                          <span class="dt">..3 =</span> User),</span>
<span id="cb12-17"><a href="#cb12-17"></a>                                     <span class="dt">.f =</span>  <span class="op">~</span>casnet<span class="op">::</span><span class="kw">make_spiral_graph</span>(<span class="dt">g =</span> ..<span class="dv">1</span>, </span>
<span id="cb12-18"><a href="#cb12-18"></a>                                                                      <span class="dt">arcs =</span> <span class="dv">4</span>, </span>
<span id="cb12-19"><a href="#cb12-19"></a>                                                                      <span class="co"># a = .1, </span></span>
<span id="cb12-20"><a href="#cb12-20"></a>                                                                      <span class="co"># b = 2, </span></span>
<span id="cb12-21"><a href="#cb12-21"></a>                                                                      <span class="dt">markTimeBy =</span> <span class="ot">TRUE</span>,</span>
<span id="cb12-22"><a href="#cb12-22"></a>                                                                      <span class="dt">markEpochsBy =</span> ..<span class="dv">2</span>,</span>
<span id="cb12-23"><a href="#cb12-23"></a>                                                                      <span class="dt">epochColours =</span> ..<span class="dv">2</span>,</span>
<span id="cb12-24"><a href="#cb12-24"></a>                                                                      <span class="dt">showEpochLegend =</span> <span class="ot">FALSE</span>,</span>
<span id="cb12-25"><a href="#cb12-25"></a>                                                                      <span class="dt">scaleEdgeSize =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">10</span>,</span>
<span id="cb12-26"><a href="#cb12-26"></a>                                                                      <span class="dt">scaleVertexSize =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">5</span>),</span>
<span id="cb12-27"><a href="#cb12-27"></a>                                                                      <span class="dt">showSizeLegend =</span> <span class="ot">FALSE</span>,</span>
<span id="cb12-28"><a href="#cb12-28"></a>                                                                      <span class="dt">sizeLabel =</span> <span class="st">&quot;Node strength&quot;</span>,</span>
<span id="cb12-29"><a href="#cb12-29"></a>                                                                      <span class="dt">type =</span> <span class="st">&quot;Euler&quot;</span>,</span>
<span id="cb12-30"><a href="#cb12-30"></a>                                                                      <span class="co"># alphaE = 0.1</span></span>
<span id="cb12-31"><a href="#cb12-31"></a>                                                                      <span class="co"># title = ..3</span></span>
<span id="cb12-32"><a href="#cb12-32"></a>                                     )))</span></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/unnamed-chunk-3-1.png" width="2100" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co"># emadata_nested_wrangled_both_recnets_nodes_plots$spiralgraph_epochs[[1]] +</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co">#   theme(plot.margin=grid::unit(c(0,0,0,0), &quot;mm&quot;))</span></span>
<span id="cb13-4"><a href="#cb13-4"></a></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co"># ggsave(filename = &quot;./figures/recnetwork.png&quot;,</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co">#        width = 7, </span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co">#        height = 7)</span></span>
<span id="cb13-8"><a href="#cb13-8"></a></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="co"># emadata_nested_wrangled_both_recnets_nodes_plots$all_nodes_with_strengths[[1]]</span></span></code></pre></div>
</div>
<div id="attractor-plot-1" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">Attractor plot</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">observations =</span> purrr<span class="op">::</span><span class="kw">map_dbl</span>(<span class="dt">.x =</span> sample1_standardised,</span>
<span id="cb14-3"><a href="#cb14-3"></a>                                              <span class="dt">.f =</span> <span class="op">~</span><span class="kw">nrow</span>(.)))</span>
<span id="cb14-4"><a href="#cb14-4"></a></span>
<span id="cb14-5"><a href="#cb14-5"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">observations_daily =</span> purrr<span class="op">::</span><span class="kw">map_dbl</span>(<span class="dt">.x =</span> data_daily,</span>
<span id="cb14-7"><a href="#cb14-7"></a>                                              <span class="dt">.f =</span> <span class="op">~</span><span class="kw">nrow</span>(.)))</span>
<span id="cb14-8"><a href="#cb14-8"></a></span>
<span id="cb14-9"><a href="#cb14-9"></a></span>
<span id="cb14-10"><a href="#cb14-10"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(</span>
<span id="cb14-12"><a href="#cb14-12"></a>    <span class="dt">attractor_plots =</span> </span>
<span id="cb14-13"><a href="#cb14-13"></a>      purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> all_nodes_with_strengths,</span>
<span id="cb14-14"><a href="#cb14-14"></a>                       <span class="dt">..2 =</span> observations,</span>
<span id="cb14-15"><a href="#cb14-15"></a>                       <span class="dt">..3 =</span> observations_daily,</span>
<span id="cb14-16"><a href="#cb14-16"></a>                       <span class="dt">..4 =</span> User),</span>
<span id="cb14-17"><a href="#cb14-17"></a>                  <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb14-18"><a href="#cb14-18"></a>                    dplyr<span class="op">::</span><span class="kw">mutate</span>(..<span class="dv">1</span>,</span>
<span id="cb14-19"><a href="#cb14-19"></a>                                  <span class="dt">strength_rescaled =</span> </span>
<span id="cb14-20"><a href="#cb14-20"></a>                                    scales<span class="op">::</span><span class="kw">rescale</span>(strength, <span class="dt">to =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">1.1</span>)),</span>
<span id="cb14-21"><a href="#cb14-21"></a>                                  <span class="dt">alpha_strength =</span> <span class="kw">ifelse</span>(strength_rescaled <span class="op">==</span><span class="st"> </span><span class="fl">0.3</span>, </span>
<span id="cb14-22"><a href="#cb14-22"></a>                                                          <span class="fl">0.5</span>, </span>
<span id="cb14-23"><a href="#cb14-23"></a>                                                          strength_rescaled)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb14-24"><a href="#cb14-24"></a><span class="st">                      </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</span>
<span id="cb14-25"><a href="#cb14-25"></a>                             <span class="kw">aes</span>(<span class="dt">x =</span> forcats<span class="op">::</span><span class="kw">fct_rev</span>(name), </span>
<span id="cb14-26"><a href="#cb14-26"></a>                                 <span class="dt">y =</span> value, </span>
<span id="cb14-27"><a href="#cb14-27"></a>                                 <span class="dt">size =</span> strength_rescaled,</span>
<span id="cb14-28"><a href="#cb14-28"></a>                                 <span class="dt">alpha =</span> alpha_strength,</span>
<span id="cb14-29"><a href="#cb14-29"></a>                                 <span class="dt">color =</span> attractors_n)) <span class="op">+</span></span>
<span id="cb14-30"><a href="#cb14-30"></a><span class="st">                      </span><span class="kw">scale_size_identity</span>() <span class="op">+</span></span>
<span id="cb14-31"><a href="#cb14-31"></a><span class="st">                      </span><span class="kw">scale_alpha_identity</span>() <span class="op">+</span></span>
<span id="cb14-32"><a href="#cb14-32"></a><span class="st">                      </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">alpha =</span> alpha_strength)) <span class="op">+</span></span>
<span id="cb14-33"><a href="#cb14-33"></a><span class="st">                      </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> time,</span>
<span id="cb14-34"><a href="#cb14-34"></a>                                    <span class="dt">alpha =</span> alpha_strength)) <span class="op">+</span></span>
<span id="cb14-35"><a href="#cb14-35"></a><span class="st">                      </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(viridisLite<span class="op">::</span><span class="kw">plasma</span>(<span class="dv">4</span>, </span>
<span id="cb14-36"><a href="#cb14-36"></a>                                                                        <span class="dt">end =</span> <span class="fl">0.8</span>, </span>
<span id="cb14-37"><a href="#cb14-37"></a>                                                                        <span class="dt">direction =</span> <span class="dv">-1</span>), </span>
<span id="cb14-38"><a href="#cb14-38"></a>                                                    <span class="st">&quot;gray40&quot;</span>, <span class="st">&quot;gray50&quot;</span>)) <span class="op">+</span></span>
<span id="cb14-39"><a href="#cb14-39"></a><span class="st">                      </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">label_percent</span>(<span class="dt">accuracy =</span> <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb14-40"><a href="#cb14-40"></a><span class="st">                      </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb14-41"><a href="#cb14-41"></a><span class="st">                      </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb14-42"><a href="#cb14-42"></a><span class="st">                      </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Percentage of maximum reported value of variable, across full time series&quot;</span>,</span>
<span id="cb14-43"><a href="#cb14-43"></a>                           <span class="dt">x =</span> <span class="ot">NULL</span>,</span>
<span id="cb14-44"><a href="#cb14-44"></a>                           <span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&quot;Participant </span><span class="ch">\&quot;</span><span class="st">&quot;</span>, ..<span class="dv">4</span>, <span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st"> - based on &quot;</span>, ..<span class="dv">2</span>, <span class="st">&quot; data points (&quot;</span>, ..<span class="dv">3</span>, <span class="st">&quot; days)&quot;</span>)) <span class="op">+</span></span>
<span id="cb14-45"><a href="#cb14-45"></a><span class="st">                      </span><span class="kw">facet_wrap</span>(<span class="op">~</span>attractors_n) <span class="op">+</span></span>
<span id="cb14-46"><a href="#cb14-46"></a><span class="st">                      </span><span class="kw">coord_flip</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb14-47"><a href="#cb14-47"></a>                  }</span>
<span id="cb14-48"><a href="#cb14-48"></a>      ))</span>
<span id="cb14-49"><a href="#cb14-49"></a></span>
<span id="cb14-50"><a href="#cb14-50"></a>emadata_nested_wrangled_both_recnets_nodes_plots<span class="op">$</span>attractor_plots[[<span class="dv">1</span>]]</span></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/attractor-plots_sample1-1.png" width="2100" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># emadata_nested_wrangled_both_recnets_nodes_plots$all_nodes_with_strengths[[1]]</span></span></code></pre></div>
</div>
</div>
<div id="single-randomly-sampled-daily-observation-1" class="section level2 unlisted unnumbered">
<h2 class="unlisted unnumbered">2. Single randomly sampled daily observation</h2>
<p>Here’s the 6-dimensional motivation system’s recurrence plot, weighted by similarity.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co">#######################</span></span>
<span id="cb16-4"><a href="#cb16-4"></a></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co"># si = similarity under the radius</span></span>
<span id="cb16-6"><a href="#cb16-6"></a>emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">RN =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> sample2_standardised,</span>
<span id="cb16-8"><a href="#cb16-8"></a>                                <span class="dt">.f =</span>  <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rn</span>(.x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="co">#autonomy, competence, relatedness,</span></span>
<span id="cb16-9"><a href="#cb16-9"></a>                                                                       pleasure, interest, importance,</span>
<span id="cb16-10"><a href="#cb16-10"></a>                                                                       situation_requires, </span>
<span id="cb16-11"><a href="#cb16-11"></a>                                                                       anxiety_guilt_avoidance, </span>
<span id="cb16-12"><a href="#cb16-12"></a>                                                                       another_wants), </span>
<span id="cb16-13"><a href="#cb16-13"></a>                                                  <span class="dt">doEmbed =</span> <span class="ot">FALSE</span>, </span>
<span id="cb16-14"><a href="#cb16-14"></a>                                                  <span class="dt">weighted =</span> <span class="ot">TRUE</span>, </span>
<span id="cb16-15"><a href="#cb16-15"></a>                                                  <span class="dt">weightedBy =</span> <span class="st">&quot;si&quot;</span>, </span>
<span id="cb16-16"><a href="#cb16-16"></a>                                                  <span class="dt">emRad =</span> <span class="ot">NA</span>)))</span>
<span id="cb16-17"><a href="#cb16-17"></a><span class="co">## </span></span>
<span id="cb16-18"><a href="#cb16-18"></a><span class="co">## Auto-recurrence: Setting diagonal to (1 + max. distance) for analyses</span></span>
<span id="cb16-19"><a href="#cb16-19"></a><span class="co">## </span></span>
<span id="cb16-20"><a href="#cb16-20"></a><span class="co">## Searching for a radius that will yield 0.05 for RR</span></span>
<span id="cb16-21"><a href="#cb16-21"></a></span>
<span id="cb16-22"><a href="#cb16-22"></a>emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-23"><a href="#cb16-23"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">graph_from_adjacency =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> RN,</span>
<span id="cb16-24"><a href="#cb16-24"></a>                                                  <span class="dt">.f =</span> <span class="op">~</span>igraph<span class="op">::</span><span class="kw">graph_from_adjacency_matrix</span>(.x, </span>
<span id="cb16-25"><a href="#cb16-25"></a>                                                                                            <span class="dt">weighted =</span> <span class="ot">TRUE</span>, </span>
<span id="cb16-26"><a href="#cb16-26"></a>                                                                                            <span class="dt">mode =</span> <span class="st">&quot;upper&quot;</span>, </span>
<span id="cb16-27"><a href="#cb16-27"></a>                                                                                            <span class="dt">diag =</span> <span class="ot">FALSE</span>)))</span>
<span id="cb16-28"><a href="#cb16-28"></a></span>
<span id="cb16-29"><a href="#cb16-29"></a><span class="co"># Edges with their distances</span></span>
<span id="cb16-30"><a href="#cb16-30"></a>emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-31"><a href="#cb16-31"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">edges_with_distances =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> graph_from_adjacency,</span>
<span id="cb16-32"><a href="#cb16-32"></a>                                                  <span class="dt">.f =</span> <span class="op">~</span>igraph<span class="op">::</span><span class="kw">E</span>(.x)<span class="op">$</span>weight),</span>
<span id="cb16-33"><a href="#cb16-33"></a>                <span class="dt">graph_from_adjacency_orig =</span> graph_from_adjacency)</span>
<span id="cb16-34"><a href="#cb16-34"></a></span>
<span id="cb16-35"><a href="#cb16-35"></a><span class="co"># Larger values are closer to the state; inverse of weight makes it more intuitive</span></span>
<span id="cb16-36"><a href="#cb16-36"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets)) {</span>
<span id="cb16-37"><a href="#cb16-37"></a>igraph<span class="op">::</span><span class="kw">E</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>weight &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>emadata_nested_wrangled_both_recnets<span class="op">$</span>edges_with_distances[[i]])</span>
<span id="cb16-38"><a href="#cb16-38"></a>}</span>
<span id="cb16-39"><a href="#cb16-39"></a><span class="co"># A later note to self: Now weight is a measure of distance; how far apart two time points are</span></span>
<span id="cb16-40"><a href="#cb16-40"></a><span class="co"># (under the radius, i.e. they&#39;re reasonably similar to begin with)</span></span>
<span id="cb16-41"><a href="#cb16-41"></a></span>
<span id="cb16-42"><a href="#cb16-42"></a><span class="co">####### To check:</span></span>
<span id="cb16-43"><a href="#cb16-43"></a><span class="co"># igraph::E(emadata_nested_wrangled_both_recnets$graph_from_adjacency[[1]])$weight</span></span>
<span id="cb16-44"><a href="#cb16-44"></a><span class="co"># igraph::E(emadata_nested_wrangled_both_recnets$graph_from_adjacency_orig[[1]])$weight</span></span>
<span id="cb16-45"><a href="#cb16-45"></a></span>
<span id="cb16-46"><a href="#cb16-46"></a>emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-47"><a href="#cb16-47"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">RN_plot =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> RN,</span>
<span id="cb16-48"><a href="#cb16-48"></a>                                <span class="dt">.f =</span>  <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rn_plot</span>(.x,</span>
<span id="cb16-49"><a href="#cb16-49"></a>                                                       <span class="dt">plotDimensions =</span> <span class="ot">TRUE</span>,</span>
<span id="cb16-50"><a href="#cb16-50"></a>                                                       <span class="dt">xlab =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>,</span>
<span id="cb16-51"><a href="#cb16-51"></a>                                                       <span class="dt">ylab =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>)))</span></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/unnamed-chunk-4-1.png" width="2100" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="co"># Make node size equal to strength. Strength is the sum of a node&#39;s edge weights.</span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets)) {</span>
<span id="cb17-4"><a href="#cb17-4"></a>igraph<span class="op">::</span><span class="kw">V</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>size &lt;-<span class="st"> </span>(igraph<span class="op">::</span><span class="kw">strength</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]]))</span>
<span id="cb17-5"><a href="#cb17-5"></a>}</span>
<span id="cb17-6"><a href="#cb17-6"></a></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="co"># Rescaling weight as &quot;width&quot;; varies between 5 and 10</span></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets)) {</span>
<span id="cb17-9"><a href="#cb17-9"></a>igraph<span class="op">::</span><span class="kw">E</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>width &lt;-<span class="st"> </span></span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="st">  </span>casnet<span class="op">::</span><span class="kw">elascer</span>(igraph<span class="op">::</span><span class="kw">E</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>weight, <span class="dt">lo =</span> <span class="dv">5</span>, <span class="dt">hi =</span> <span class="dv">10</span>)</span>
<span id="cb17-11"><a href="#cb17-11"></a>}</span></code></pre></div>
<p>The lengthy code chunk below extracts and marks attractors in the data.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># Get number of maximally connected node</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">max_connected_day =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> graph_from_adjacency,</span>
<span id="cb18-4"><a href="#cb18-4"></a>                                     <span class="dt">.f =</span>  <span class="op">~</span><span class="kw">which.max</span>(igraph<span class="op">::</span><span class="kw">degree</span>(.x))</span>
<span id="cb18-5"><a href="#cb18-5"></a>                                     ))</span>
<span id="cb18-6"><a href="#cb18-6"></a></span>
<span id="cb18-7"><a href="#cb18-7"></a></span>
<span id="cb18-8"><a href="#cb18-8"></a></span>
<span id="cb18-9"><a href="#cb18-9"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">list_of_edges =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> graph_from_adjacency,</span>
<span id="cb18-11"><a href="#cb18-11"></a>                                     <span class="dt">.f =</span>  <span class="op">~</span>igraph<span class="op">::</span><span class="kw">get.data.frame</span>(.x)</span>
<span id="cb18-12"><a href="#cb18-12"></a>                                     ))</span>
<span id="cb18-13"><a href="#cb18-13"></a></span>
<span id="cb18-14"><a href="#cb18-14"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-15"><a href="#cb18-15"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> </span>
<span id="cb18-16"><a href="#cb18-16"></a>                  purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> sample2_standardised,</span>
<span id="cb18-17"><a href="#cb18-17"></a>                              <span class="dt">.y =</span> graph_from_adjacency,</span>
<span id="cb18-18"><a href="#cb18-18"></a>                              <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb18-19"><a href="#cb18-19"></a>                                <span class="kw">data.frame</span>(.x <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-20"><a href="#cb18-20"></a><span class="st">                                             </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="co">#autonomy, competence, relatedness,</span></span>
<span id="cb18-21"><a href="#cb18-21"></a>                                                                       pleasure, interest, importance,</span>
<span id="cb18-22"><a href="#cb18-22"></a>                                                                       situation_requires, anxiety_guilt_avoidance, another_wants), </span>
<span id="cb18-23"><a href="#cb18-23"></a>                                           <span class="dt">strength =</span> igraph<span class="op">::</span><span class="kw">strength</span>(.y)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-24"><a href="#cb18-24"></a><span class="st">                                  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">time =</span> dplyr<span class="op">::</span><span class="kw">row_number</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-25"><a href="#cb18-25"></a><span class="st">                                  </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(<span class="op">-</span>strength, <span class="op">-</span>time))</span>
<span id="cb18-26"><a href="#cb18-26"></a>                              }</span>
<span id="cb18-27"><a href="#cb18-27"></a>  ))</span>
<span id="cb18-28"><a href="#cb18-28"></a></span>
<span id="cb18-29"><a href="#cb18-29"></a><span class="co"># Extract nodes (i.e. times) which connect to the strongest (i.e. most connected) node</span></span>
<span id="cb18-30"><a href="#cb18-30"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-31"><a href="#cb18-31"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</span>
<span id="cb18-32"><a href="#cb18-32"></a>                                                      <span class="dt">.y =</span> max_connected_day,</span>
<span id="cb18-33"><a href="#cb18-33"></a>                                                      <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb18-34"><a href="#cb18-34"></a>                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-35"><a href="#cb18-35"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-36"><a href="#cb18-36"></a><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</span>
<span id="cb18-37"><a href="#cb18-37"></a>                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-38"><a href="#cb18-38"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </span>
<span id="cb18-39"><a href="#cb18-39"></a>                                                                          <span class="co">#.keep_all = TRUE</span></span>
<span id="cb18-40"><a href="#cb18-40"></a>                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-41"><a href="#cb18-41"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</span>
<span id="cb18-42"><a href="#cb18-42"></a>                                                      }</span>
<span id="cb18-43"><a href="#cb18-43"></a>                                                      )</span>
<span id="cb18-44"><a href="#cb18-44"></a>  )</span>
<span id="cb18-45"><a href="#cb18-45"></a></span>
<span id="cb18-46"><a href="#cb18-46"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-47"><a href="#cb18-47"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb18-48"><a href="#cb18-48"></a>                                                       <span class="dt">.y =</span> connecting_to_strongest,</span>
<span id="cb18-49"><a href="#cb18-49"></a>                                                       <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb18-50"><a href="#cb18-50"></a>                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb18-51"><a href="#cb18-51"></a>                                                                       <span class="dt">connecting_to_strongest =</span> </span>
<span id="cb18-52"><a href="#cb18-52"></a>                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb18-53"><a href="#cb18-53"></a>                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb18-54"><a href="#cb18-54"></a>                                                       }</span>
<span id="cb18-55"><a href="#cb18-55"></a>  ))</span>
<span id="cb18-56"><a href="#cb18-56"></a></span>
<span id="cb18-57"><a href="#cb18-57"></a><span class="co"># Get number of 2nd maximally connected node, which doesn&#39;t connect to the 1st</span></span>
<span id="cb18-58"><a href="#cb18-58"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-59"><a href="#cb18-59"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">secondary_attractor_day =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> graph_from_adjacency,</span>
<span id="cb18-60"><a href="#cb18-60"></a>                                                      <span class="dt">.y =</span> connecting_to_strongest,</span>
<span id="cb18-61"><a href="#cb18-61"></a>                                                      <span class="dt">.f =</span>  <span class="op">~</span>{</span>
<span id="cb18-62"><a href="#cb18-62"></a>                                                        <span class="kw">data.frame</span>(<span class="dt">degree =</span> igraph<span class="op">::</span><span class="kw">degree</span>(.x), </span>
<span id="cb18-63"><a href="#cb18-63"></a>                                                                   <span class="dt">time =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(igraph<span class="op">::</span><span class="kw">degree</span>(.x))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-64"><a href="#cb18-64"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-65"><a href="#cb18-65"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(degree)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-66"><a href="#cb18-66"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-67"><a href="#cb18-67"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(time)</span>
<span id="cb18-68"><a href="#cb18-68"></a>                                                      }                                                    </span>
<span id="cb18-69"><a href="#cb18-69"></a>  ))</span>
<span id="cb18-70"><a href="#cb18-70"></a></span>
<span id="cb18-71"><a href="#cb18-71"></a><span class="co"># Extract nodes (i.e. times) which connect to the 2nd strongest node, which doesn&#39;t connect to the 1st</span></span>
<span id="cb18-72"><a href="#cb18-72"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-73"><a href="#cb18-73"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_2nd_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</span>
<span id="cb18-74"><a href="#cb18-74"></a>                                                      <span class="dt">.y =</span> secondary_attractor_day,</span>
<span id="cb18-75"><a href="#cb18-75"></a>                                                      <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb18-76"><a href="#cb18-76"></a>                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-77"><a href="#cb18-77"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-78"><a href="#cb18-78"></a><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</span>
<span id="cb18-79"><a href="#cb18-79"></a>                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-80"><a href="#cb18-80"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </span>
<span id="cb18-81"><a href="#cb18-81"></a>                                                                          <span class="co">#.keep_all = TRUE</span></span>
<span id="cb18-82"><a href="#cb18-82"></a>                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-83"><a href="#cb18-83"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</span>
<span id="cb18-84"><a href="#cb18-84"></a>                                                      }</span>
<span id="cb18-85"><a href="#cb18-85"></a>                                                      )</span>
<span id="cb18-86"><a href="#cb18-86"></a>  )</span>
<span id="cb18-87"><a href="#cb18-87"></a></span>
<span id="cb18-88"><a href="#cb18-88"></a><span class="co"># Save as a variable in the dataset</span></span>
<span id="cb18-89"><a href="#cb18-89"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-90"><a href="#cb18-90"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb18-91"><a href="#cb18-91"></a>                                                       <span class="dt">.y =</span> connecting_to_2nd_strongest,</span>
<span id="cb18-92"><a href="#cb18-92"></a>                                                       <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb18-93"><a href="#cb18-93"></a>                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb18-94"><a href="#cb18-94"></a>                                                                       <span class="dt">connecting_to_2nd_strongest =</span> </span>
<span id="cb18-95"><a href="#cb18-95"></a>                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb18-96"><a href="#cb18-96"></a>                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb18-97"><a href="#cb18-97"></a>                                                       }</span>
<span id="cb18-98"><a href="#cb18-98"></a>  ))</span>
<span id="cb18-99"><a href="#cb18-99"></a></span>
<span id="cb18-100"><a href="#cb18-100"></a><span class="co"># Get number of 3rd maximally connected node, which doesn&#39;t connect to the 1st or second</span></span>
<span id="cb18-101"><a href="#cb18-101"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-102"><a href="#cb18-102"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">tertiary_attractor_day =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> graph_from_adjacency,</span>
<span id="cb18-103"><a href="#cb18-103"></a>                                                      <span class="dt">..2 =</span> connecting_to_strongest,</span>
<span id="cb18-104"><a href="#cb18-104"></a>                                                      <span class="dt">..3 =</span> connecting_to_2nd_strongest),</span>
<span id="cb18-105"><a href="#cb18-105"></a>                                                      <span class="dt">.f =</span>  <span class="op">~</span>{</span>
<span id="cb18-106"><a href="#cb18-106"></a>                                                        <span class="kw">data.frame</span>(<span class="dt">degree =</span> igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>), </span>
<span id="cb18-107"><a href="#cb18-107"></a>                                                                   <span class="dt">time =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-108"><a href="#cb18-108"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">2</span>, </span>
<span id="cb18-109"><a href="#cb18-109"></a>                                                                        <span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-110"><a href="#cb18-110"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(degree)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-111"><a href="#cb18-111"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-112"><a href="#cb18-112"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(time)</span>
<span id="cb18-113"><a href="#cb18-113"></a>                                                      }                                                    </span>
<span id="cb18-114"><a href="#cb18-114"></a>  ))</span>
<span id="cb18-115"><a href="#cb18-115"></a></span>
<span id="cb18-116"><a href="#cb18-116"></a><span class="co"># Extract nodes (i.e. times) which connect to the 3rd strongest node</span></span>
<span id="cb18-117"><a href="#cb18-117"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-118"><a href="#cb18-118"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_3rd_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</span>
<span id="cb18-119"><a href="#cb18-119"></a>                                                      <span class="dt">.y =</span> tertiary_attractor_day,</span>
<span id="cb18-120"><a href="#cb18-120"></a>                                                      <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb18-121"><a href="#cb18-121"></a>                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-122"><a href="#cb18-122"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-123"><a href="#cb18-123"></a><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</span>
<span id="cb18-124"><a href="#cb18-124"></a>                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-125"><a href="#cb18-125"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </span>
<span id="cb18-126"><a href="#cb18-126"></a>                                                                          <span class="co">#.keep_all = TRUE</span></span>
<span id="cb18-127"><a href="#cb18-127"></a>                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-128"><a href="#cb18-128"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</span>
<span id="cb18-129"><a href="#cb18-129"></a>                                                      }</span>
<span id="cb18-130"><a href="#cb18-130"></a>                                                      )</span>
<span id="cb18-131"><a href="#cb18-131"></a>  )</span>
<span id="cb18-132"><a href="#cb18-132"></a></span>
<span id="cb18-133"><a href="#cb18-133"></a><span class="co"># Save as a variable</span></span>
<span id="cb18-134"><a href="#cb18-134"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-135"><a href="#cb18-135"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb18-136"><a href="#cb18-136"></a>                                                       <span class="dt">.y =</span> connecting_to_3rd_strongest,</span>
<span id="cb18-137"><a href="#cb18-137"></a>                                                       <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb18-138"><a href="#cb18-138"></a>                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb18-139"><a href="#cb18-139"></a>                                                                       <span class="dt">connecting_to_3rd_strongest =</span> </span>
<span id="cb18-140"><a href="#cb18-140"></a>                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb18-141"><a href="#cb18-141"></a>                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb18-142"><a href="#cb18-142"></a>                                                       }</span>
<span id="cb18-143"><a href="#cb18-143"></a>  ))</span>
<span id="cb18-144"><a href="#cb18-144"></a></span>
<span id="cb18-145"><a href="#cb18-145"></a></span>
<span id="cb18-146"><a href="#cb18-146"></a></span>
<span id="cb18-147"><a href="#cb18-147"></a><span class="co"># Get number of 4th maximally connected node, which doesn&#39;t connect to the 1st or second</span></span>
<span id="cb18-148"><a href="#cb18-148"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-149"><a href="#cb18-149"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">fourth_attractor_day =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> graph_from_adjacency,</span>
<span id="cb18-150"><a href="#cb18-150"></a>                                                      <span class="dt">..2 =</span> connecting_to_strongest,</span>
<span id="cb18-151"><a href="#cb18-151"></a>                                                      <span class="dt">..3 =</span> connecting_to_2nd_strongest,</span>
<span id="cb18-152"><a href="#cb18-152"></a>                                                      <span class="dt">..4 =</span> connecting_to_3rd_strongest),</span>
<span id="cb18-153"><a href="#cb18-153"></a>                                                      <span class="dt">.f =</span>  <span class="op">~</span>{</span>
<span id="cb18-154"><a href="#cb18-154"></a>                                                        <span class="kw">data.frame</span>(<span class="dt">degree =</span> igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>), </span>
<span id="cb18-155"><a href="#cb18-155"></a>                                                                   <span class="dt">time =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-156"><a href="#cb18-156"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">2</span>, </span>
<span id="cb18-157"><a href="#cb18-157"></a>                                                                        <span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">3</span>, </span>
<span id="cb18-158"><a href="#cb18-158"></a>                                                                        <span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-159"><a href="#cb18-159"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(degree)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-160"><a href="#cb18-160"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-161"><a href="#cb18-161"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(time)</span>
<span id="cb18-162"><a href="#cb18-162"></a>                                                      }                                                    </span>
<span id="cb18-163"><a href="#cb18-163"></a>  ))</span>
<span id="cb18-164"><a href="#cb18-164"></a></span>
<span id="cb18-165"><a href="#cb18-165"></a><span class="co"># Extract nodes (i.e. times) which connect to the 3rd strongest node</span></span>
<span id="cb18-166"><a href="#cb18-166"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-167"><a href="#cb18-167"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_4th_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</span>
<span id="cb18-168"><a href="#cb18-168"></a>                                                      <span class="dt">.y =</span> fourth_attractor_day,</span>
<span id="cb18-169"><a href="#cb18-169"></a>                                                      <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb18-170"><a href="#cb18-170"></a>                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-171"><a href="#cb18-171"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-172"><a href="#cb18-172"></a><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</span>
<span id="cb18-173"><a href="#cb18-173"></a>                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-174"><a href="#cb18-174"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </span>
<span id="cb18-175"><a href="#cb18-175"></a>                                                                          <span class="co">#.keep_all = TRUE</span></span>
<span id="cb18-176"><a href="#cb18-176"></a>                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-177"><a href="#cb18-177"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</span>
<span id="cb18-178"><a href="#cb18-178"></a>                                                      }</span>
<span id="cb18-179"><a href="#cb18-179"></a>                                                      )</span>
<span id="cb18-180"><a href="#cb18-180"></a>  )</span>
<span id="cb18-181"><a href="#cb18-181"></a></span>
<span id="cb18-182"><a href="#cb18-182"></a><span class="co"># Save as a variable</span></span>
<span id="cb18-183"><a href="#cb18-183"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-184"><a href="#cb18-184"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb18-185"><a href="#cb18-185"></a>                                                       <span class="dt">.y =</span> connecting_to_4th_strongest,</span>
<span id="cb18-186"><a href="#cb18-186"></a>                                                       <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb18-187"><a href="#cb18-187"></a>                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb18-188"><a href="#cb18-188"></a>                                                                       <span class="dt">connecting_to_4th_strongest =</span> </span>
<span id="cb18-189"><a href="#cb18-189"></a>                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb18-190"><a href="#cb18-190"></a>                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb18-191"><a href="#cb18-191"></a>                                                       }</span>
<span id="cb18-192"><a href="#cb18-192"></a>  ))</span>
<span id="cb18-193"><a href="#cb18-193"></a></span>
<span id="cb18-194"><a href="#cb18-194"></a><span class="co">################### Make plots</span></span>
<span id="cb18-195"><a href="#cb18-195"></a></span>
<span id="cb18-196"><a href="#cb18-196"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-197"><a href="#cb18-197"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> </span>
<span id="cb18-198"><a href="#cb18-198"></a>                  purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb18-199"><a href="#cb18-199"></a>                             <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb18-200"><a href="#cb18-200"></a>                               dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb18-201"><a href="#cb18-201"></a>                                             <span class="dt">attractors =</span> dplyr<span class="op">::</span><span class="kw">case_when</span>(</span>
<span id="cb18-202"><a href="#cb18-202"></a>                                               strength <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> &quot;Unique&quot;</span>,</span>
<span id="cb18-203"><a href="#cb18-203"></a>                                               connecting_to_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;1st&quot;</span>,</span>
<span id="cb18-204"><a href="#cb18-204"></a>                                               connecting_to_2nd_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;2nd&quot;</span>,</span>
<span id="cb18-205"><a href="#cb18-205"></a>                                               connecting_to_3rd_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;3rd&quot;</span>,</span>
<span id="cb18-206"><a href="#cb18-206"></a>                                               connecting_to_4th_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;4th&quot;</span>,</span>
<span id="cb18-207"><a href="#cb18-207"></a>                                               <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Uncategorised&quot;</span>),</span>
<span id="cb18-208"><a href="#cb18-208"></a>                                             <span class="dt">attractors =</span> <span class="kw">factor</span>(attractors,</span>
<span id="cb18-209"><a href="#cb18-209"></a>                                                                 <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;1st&quot;</span>,</span>
<span id="cb18-210"><a href="#cb18-210"></a>                                                                            <span class="st">&quot;2nd&quot;</span>,</span>
<span id="cb18-211"><a href="#cb18-211"></a>                                                                            <span class="st">&quot;3rd&quot;</span>,</span>
<span id="cb18-212"><a href="#cb18-212"></a>                                                                            <span class="st">&quot;4th&quot;</span>,</span>
<span id="cb18-213"><a href="#cb18-213"></a>                                                                            <span class="st">&quot;Uncategorised&quot;</span>,</span>
<span id="cb18-214"><a href="#cb18-214"></a>                                                                            <span class="st">&quot;Unique&quot;</span>)),</span>
<span id="cb18-215"><a href="#cb18-215"></a>                                             <span class="dt">name =</span> <span class="kw">factor</span>(name,</span>
<span id="cb18-216"><a href="#cb18-216"></a>                                                           <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;pleasure&quot;</span>,</span>
<span id="cb18-217"><a href="#cb18-217"></a>                                                                      <span class="st">&quot;interest&quot;</span>,</span>
<span id="cb18-218"><a href="#cb18-218"></a>                                                                      <span class="st">&quot;importance&quot;</span>,</span>
<span id="cb18-219"><a href="#cb18-219"></a>                                                                      <span class="st">&quot;situation_requires&quot;</span>,</span>
<span id="cb18-220"><a href="#cb18-220"></a>                                                                      <span class="st">&quot;anxiety_guilt_avoidance&quot;</span>,</span>
<span id="cb18-221"><a href="#cb18-221"></a>                                                                      <span class="st">&quot;another_wants&quot;</span>),</span>
<span id="cb18-222"><a href="#cb18-222"></a>                                                           <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Pleasure&quot;</span>,</span>
<span id="cb18-223"><a href="#cb18-223"></a>                                                                      <span class="st">&quot;Interest&quot;</span>,</span>
<span id="cb18-224"><a href="#cb18-224"></a>                                                                      <span class="st">&quot;Importance&quot;</span>,</span>
<span id="cb18-225"><a href="#cb18-225"></a>                                                                      <span class="st">&quot;Situation requires&quot;</span>,</span>
<span id="cb18-226"><a href="#cb18-226"></a>                                                                      <span class="st">&quot;Anxiety guilt avoidance&quot;</span>,</span>
<span id="cb18-227"><a href="#cb18-227"></a>                                                                      <span class="st">&quot;Another wants&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-228"><a href="#cb18-228"></a><span class="st">                                               </span>forcats<span class="op">::</span><span class="kw">fct_drop</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-229"><a href="#cb18-229"></a><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(attractors, name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-230"><a href="#cb18-230"></a><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-231"><a href="#cb18-231"></a><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb18-232"><a href="#cb18-232"></a><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">maxtime =</span> <span class="kw">max</span>(time),</span>
<span id="cb18-233"><a href="#cb18-233"></a>                                               <span class="dt">percentage_of_total =</span></span>
<span id="cb18-234"><a href="#cb18-234"></a>                                                 (n <span class="op">/</span><span class="st"> </span>maxtime) <span class="op">%&gt;%</span><span class="st"> </span>scales<span class="op">::</span><span class="kw">percent</span>(<span class="dt">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb18-235"><a href="#cb18-235"></a>                                               <span class="dt">proportion_of_total =</span> n<span class="op">/</span>maxtime,</span>
<span id="cb18-236"><a href="#cb18-236"></a>                                               <span class="dt">attractors_n =</span> </span>
<span id="cb18-237"><a href="#cb18-237"></a>                                                 <span class="kw">factor</span>(<span class="kw">paste0</span>(attractors,</span>
<span id="cb18-238"><a href="#cb18-238"></a>                                                               <span class="st">&quot; (n = &quot;</span>, n, <span class="st">&quot;; &quot;</span>, </span>
<span id="cb18-239"><a href="#cb18-239"></a>                                                               percentage_of_total, <span class="st">&quot;)&quot;</span>)))</span>
<span id="cb18-240"><a href="#cb18-240"></a>                             }</span>
<span id="cb18-241"><a href="#cb18-241"></a>                  ))</span></code></pre></div>
<div id="spiral-graph-with-colored-nodes-2" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">Spiral graph with colored nodes</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">node_colors =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb19-3"><a href="#cb19-3"></a>                                         <span class="dt">.f =</span> <span class="op">~</span>{tidyr<span class="op">::</span><span class="kw">pivot_wider</span>(.x, <span class="dt">names_from =</span> name) <span class="op">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="st">                                             </span>dplyr<span class="op">::</span><span class="kw">pull</span>(attractors)}))</span>
<span id="cb19-5"><a href="#cb19-5"></a></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets_nodes_plots)) {</span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="kw">levels</span>(emadata_nested_wrangled_both_recnets_nodes_plots<span class="op">$</span>node_colors[[i]]) &lt;-<span class="st"> </span></span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="st">  </span><span class="kw">c</span>(viridisLite<span class="op">::</span><span class="kw">plasma</span>(<span class="dv">4</span>, </span>
<span id="cb19-9"><a href="#cb19-9"></a>                      <span class="dt">end =</span> <span class="fl">0.8</span>, </span>
<span id="cb19-10"><a href="#cb19-10"></a>                      <span class="dt">direction =</span> <span class="dv">-1</span>), <span class="st">&quot;gray48&quot;</span>, <span class="st">&quot;white&quot;</span>)</span>
<span id="cb19-11"><a href="#cb19-11"></a>  }</span>
<span id="cb19-12"><a href="#cb19-12"></a></span>
<span id="cb19-13"><a href="#cb19-13"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb19-14"><a href="#cb19-14"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">spiralgraph_epochs =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> graph_from_adjacency,</span>
<span id="cb19-15"><a href="#cb19-15"></a>                                          <span class="dt">..2 =</span> node_colors,</span>
<span id="cb19-16"><a href="#cb19-16"></a>                                          <span class="dt">..3 =</span> User),</span>
<span id="cb19-17"><a href="#cb19-17"></a>                                     <span class="dt">.f =</span>  <span class="op">~</span>casnet<span class="op">::</span><span class="kw">make_spiral_graph</span>(<span class="dt">g =</span> ..<span class="dv">1</span>, </span>
<span id="cb19-18"><a href="#cb19-18"></a>                                                                      <span class="dt">arcs =</span> <span class="dv">4</span>, </span>
<span id="cb19-19"><a href="#cb19-19"></a>                                                                      <span class="co"># a = .1, </span></span>
<span id="cb19-20"><a href="#cb19-20"></a>                                                                      <span class="co"># b = 2, </span></span>
<span id="cb19-21"><a href="#cb19-21"></a>                                                                      <span class="dt">markTimeBy =</span> <span class="ot">TRUE</span>,</span>
<span id="cb19-22"><a href="#cb19-22"></a>                                                                      <span class="dt">markEpochsBy =</span> ..<span class="dv">2</span>,</span>
<span id="cb19-23"><a href="#cb19-23"></a>                                                                      <span class="dt">epochColours =</span> ..<span class="dv">2</span>,</span>
<span id="cb19-24"><a href="#cb19-24"></a>                                                                      <span class="dt">showEpochLegend =</span> <span class="ot">FALSE</span>,</span>
<span id="cb19-25"><a href="#cb19-25"></a>                                                                      <span class="dt">scaleEdgeSize =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">10</span>,</span>
<span id="cb19-26"><a href="#cb19-26"></a>                                                                      <span class="dt">scaleVertexSize =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">5</span>),</span>
<span id="cb19-27"><a href="#cb19-27"></a>                                                                      <span class="dt">showSizeLegend =</span> <span class="ot">FALSE</span>,</span>
<span id="cb19-28"><a href="#cb19-28"></a>                                                                      <span class="dt">sizeLabel =</span> <span class="st">&quot;Node strength&quot;</span>,</span>
<span id="cb19-29"><a href="#cb19-29"></a>                                                                      <span class="dt">type =</span> <span class="st">&quot;Euler&quot;</span>,</span>
<span id="cb19-30"><a href="#cb19-30"></a>                                                                      <span class="co"># alphaE = 0.1</span></span>
<span id="cb19-31"><a href="#cb19-31"></a>                                                                      <span class="co"># title = ..3</span></span>
<span id="cb19-32"><a href="#cb19-32"></a>                                     )))</span></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/unnamed-chunk-6-1.png" width="2100" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="co"># emadata_nested_wrangled_both_recnets_nodes_plots$spiralgraph_epochs[[1]] +</span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="co">#   theme(plot.margin=grid::unit(c(0,0,0,0), &quot;mm&quot;))</span></span>
<span id="cb20-4"><a href="#cb20-4"></a></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="co"># ggsave(filename = &quot;./figures/recnetwork.png&quot;,</span></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="co">#        width = 7, </span></span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="co">#        height = 7)</span></span>
<span id="cb20-8"><a href="#cb20-8"></a></span>
<span id="cb20-9"><a href="#cb20-9"></a><span class="co"># emadata_nested_wrangled_both_recnets_nodes_plots$all_nodes_with_strengths[[1]]</span></span></code></pre></div>
</div>
<div id="attractor-plot-2" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">Attractor plot</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">observations =</span> purrr<span class="op">::</span><span class="kw">map_dbl</span>(<span class="dt">.x =</span> sample2_standardised,</span>
<span id="cb21-3"><a href="#cb21-3"></a>                                              <span class="dt">.f =</span> <span class="op">~</span><span class="kw">nrow</span>(.)))</span>
<span id="cb21-4"><a href="#cb21-4"></a></span>
<span id="cb21-5"><a href="#cb21-5"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">observations_daily =</span> purrr<span class="op">::</span><span class="kw">map_dbl</span>(<span class="dt">.x =</span> data_daily,</span>
<span id="cb21-7"><a href="#cb21-7"></a>                                              <span class="dt">.f =</span> <span class="op">~</span><span class="kw">nrow</span>(.)))</span>
<span id="cb21-8"><a href="#cb21-8"></a></span>
<span id="cb21-9"><a href="#cb21-9"></a></span>
<span id="cb21-10"><a href="#cb21-10"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb21-11"><a href="#cb21-11"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(</span>
<span id="cb21-12"><a href="#cb21-12"></a>    <span class="dt">attractor_plots =</span> </span>
<span id="cb21-13"><a href="#cb21-13"></a>      purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> all_nodes_with_strengths,</span>
<span id="cb21-14"><a href="#cb21-14"></a>                       <span class="dt">..2 =</span> observations,</span>
<span id="cb21-15"><a href="#cb21-15"></a>                       <span class="dt">..3 =</span> observations_daily,</span>
<span id="cb21-16"><a href="#cb21-16"></a>                       <span class="dt">..4 =</span> User),</span>
<span id="cb21-17"><a href="#cb21-17"></a>                  <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb21-18"><a href="#cb21-18"></a>                    dplyr<span class="op">::</span><span class="kw">mutate</span>(..<span class="dv">1</span>,</span>
<span id="cb21-19"><a href="#cb21-19"></a>                                  <span class="dt">strength_rescaled =</span> </span>
<span id="cb21-20"><a href="#cb21-20"></a>                                    scales<span class="op">::</span><span class="kw">rescale</span>(strength, <span class="dt">to =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">1.1</span>)),</span>
<span id="cb21-21"><a href="#cb21-21"></a>                                  <span class="dt">alpha_strength =</span> <span class="kw">ifelse</span>(strength_rescaled <span class="op">==</span><span class="st"> </span><span class="fl">0.3</span>, </span>
<span id="cb21-22"><a href="#cb21-22"></a>                                                          <span class="fl">0.5</span>, </span>
<span id="cb21-23"><a href="#cb21-23"></a>                                                          strength_rescaled)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb21-24"><a href="#cb21-24"></a><span class="st">                      </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</span>
<span id="cb21-25"><a href="#cb21-25"></a>                             <span class="kw">aes</span>(<span class="dt">x =</span> forcats<span class="op">::</span><span class="kw">fct_rev</span>(name), </span>
<span id="cb21-26"><a href="#cb21-26"></a>                                 <span class="dt">y =</span> value, </span>
<span id="cb21-27"><a href="#cb21-27"></a>                                 <span class="dt">size =</span> strength_rescaled,</span>
<span id="cb21-28"><a href="#cb21-28"></a>                                 <span class="dt">alpha =</span> alpha_strength,</span>
<span id="cb21-29"><a href="#cb21-29"></a>                                 <span class="dt">color =</span> attractors_n)) <span class="op">+</span></span>
<span id="cb21-30"><a href="#cb21-30"></a><span class="st">                      </span><span class="kw">scale_size_identity</span>() <span class="op">+</span></span>
<span id="cb21-31"><a href="#cb21-31"></a><span class="st">                      </span><span class="kw">scale_alpha_identity</span>() <span class="op">+</span></span>
<span id="cb21-32"><a href="#cb21-32"></a><span class="st">                      </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">alpha =</span> alpha_strength)) <span class="op">+</span></span>
<span id="cb21-33"><a href="#cb21-33"></a><span class="st">                      </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> time,</span>
<span id="cb21-34"><a href="#cb21-34"></a>                                    <span class="dt">alpha =</span> alpha_strength)) <span class="op">+</span></span>
<span id="cb21-35"><a href="#cb21-35"></a><span class="st">                      </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(viridisLite<span class="op">::</span><span class="kw">plasma</span>(<span class="dv">4</span>, </span>
<span id="cb21-36"><a href="#cb21-36"></a>                                                                        <span class="dt">end =</span> <span class="fl">0.8</span>, </span>
<span id="cb21-37"><a href="#cb21-37"></a>                                                                        <span class="dt">direction =</span> <span class="dv">-1</span>), </span>
<span id="cb21-38"><a href="#cb21-38"></a>                                                    <span class="st">&quot;gray40&quot;</span>, <span class="st">&quot;gray50&quot;</span>)) <span class="op">+</span></span>
<span id="cb21-39"><a href="#cb21-39"></a><span class="st">                      </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">label_percent</span>(<span class="dt">accuracy =</span> <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb21-40"><a href="#cb21-40"></a><span class="st">                      </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb21-41"><a href="#cb21-41"></a><span class="st">                      </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb21-42"><a href="#cb21-42"></a><span class="st">                      </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Percentage of maximum reported value of variable, across full time series&quot;</span>,</span>
<span id="cb21-43"><a href="#cb21-43"></a>                           <span class="dt">x =</span> <span class="ot">NULL</span>,</span>
<span id="cb21-44"><a href="#cb21-44"></a>                           <span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&quot;Participant </span><span class="ch">\&quot;</span><span class="st">&quot;</span>, ..<span class="dv">4</span>, <span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st"> - based on &quot;</span>, ..<span class="dv">2</span>, <span class="st">&quot; data points (&quot;</span>, ..<span class="dv">3</span>, <span class="st">&quot; days)&quot;</span>)) <span class="op">+</span></span>
<span id="cb21-45"><a href="#cb21-45"></a><span class="st">                      </span><span class="kw">facet_wrap</span>(<span class="op">~</span>attractors_n) <span class="op">+</span></span>
<span id="cb21-46"><a href="#cb21-46"></a><span class="st">                      </span><span class="kw">coord_flip</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb21-47"><a href="#cb21-47"></a>                  }</span>
<span id="cb21-48"><a href="#cb21-48"></a>      ))</span>
<span id="cb21-49"><a href="#cb21-49"></a></span>
<span id="cb21-50"><a href="#cb21-50"></a>emadata_nested_wrangled_both_recnets_nodes_plots<span class="op">$</span>attractor_plots[[<span class="dv">1</span>]]</span></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/attractor-plots_sample2-1.png" width="2100" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># emadata_nested_wrangled_both_recnets_nodes_plots$all_nodes_with_strengths[[1]]</span></span></code></pre></div>
</div>
</div>
<div id="single-randomly-sampled-daily-observation-2" class="section level2 unlisted unnumbered">
<h2 class="unlisted unnumbered">3. Single randomly sampled daily observation</h2>
<p>Here’s the 6-dimensional motivation system’s recurrence plot, weighted by similarity.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb23-2"><a href="#cb23-2"></a></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="co">#######################</span></span>
<span id="cb23-4"><a href="#cb23-4"></a></span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="co"># si = similarity under the radius</span></span>
<span id="cb23-6"><a href="#cb23-6"></a>emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">RN =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> sample3_standardised,</span>
<span id="cb23-8"><a href="#cb23-8"></a>                                <span class="dt">.f =</span>  <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rn</span>(.x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="co">#autonomy, competence, relatedness,</span></span>
<span id="cb23-9"><a href="#cb23-9"></a>                                                                       pleasure, interest, importance,</span>
<span id="cb23-10"><a href="#cb23-10"></a>                                                                       situation_requires, </span>
<span id="cb23-11"><a href="#cb23-11"></a>                                                                       anxiety_guilt_avoidance, </span>
<span id="cb23-12"><a href="#cb23-12"></a>                                                                       another_wants), </span>
<span id="cb23-13"><a href="#cb23-13"></a>                                                  <span class="dt">doEmbed =</span> <span class="ot">FALSE</span>, </span>
<span id="cb23-14"><a href="#cb23-14"></a>                                                  <span class="dt">weighted =</span> <span class="ot">TRUE</span>, </span>
<span id="cb23-15"><a href="#cb23-15"></a>                                                  <span class="dt">weightedBy =</span> <span class="st">&quot;si&quot;</span>, </span>
<span id="cb23-16"><a href="#cb23-16"></a>                                                  <span class="dt">emRad =</span> <span class="ot">NA</span>)))</span>
<span id="cb23-17"><a href="#cb23-17"></a><span class="co">## </span></span>
<span id="cb23-18"><a href="#cb23-18"></a><span class="co">## Auto-recurrence: Setting diagonal to (1 + max. distance) for analyses</span></span>
<span id="cb23-19"><a href="#cb23-19"></a><span class="co">## </span></span>
<span id="cb23-20"><a href="#cb23-20"></a><span class="co">## Searching for a radius that will yield 0.05 for RR</span></span>
<span id="cb23-21"><a href="#cb23-21"></a></span>
<span id="cb23-22"><a href="#cb23-22"></a>emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb23-23"><a href="#cb23-23"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">graph_from_adjacency =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> RN,</span>
<span id="cb23-24"><a href="#cb23-24"></a>                                                  <span class="dt">.f =</span> <span class="op">~</span>igraph<span class="op">::</span><span class="kw">graph_from_adjacency_matrix</span>(.x, </span>
<span id="cb23-25"><a href="#cb23-25"></a>                                                                                            <span class="dt">weighted =</span> <span class="ot">TRUE</span>, </span>
<span id="cb23-26"><a href="#cb23-26"></a>                                                                                            <span class="dt">mode =</span> <span class="st">&quot;upper&quot;</span>, </span>
<span id="cb23-27"><a href="#cb23-27"></a>                                                                                            <span class="dt">diag =</span> <span class="ot">FALSE</span>)))</span>
<span id="cb23-28"><a href="#cb23-28"></a></span>
<span id="cb23-29"><a href="#cb23-29"></a><span class="co"># Edges with their distances</span></span>
<span id="cb23-30"><a href="#cb23-30"></a>emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb23-31"><a href="#cb23-31"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">edges_with_distances =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> graph_from_adjacency,</span>
<span id="cb23-32"><a href="#cb23-32"></a>                                                  <span class="dt">.f =</span> <span class="op">~</span>igraph<span class="op">::</span><span class="kw">E</span>(.x)<span class="op">$</span>weight),</span>
<span id="cb23-33"><a href="#cb23-33"></a>                <span class="dt">graph_from_adjacency_orig =</span> graph_from_adjacency)</span>
<span id="cb23-34"><a href="#cb23-34"></a></span>
<span id="cb23-35"><a href="#cb23-35"></a><span class="co"># Larger values are closer to the state; inverse of weight makes it more intuitive</span></span>
<span id="cb23-36"><a href="#cb23-36"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets)) {</span>
<span id="cb23-37"><a href="#cb23-37"></a>igraph<span class="op">::</span><span class="kw">E</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>weight &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>emadata_nested_wrangled_both_recnets<span class="op">$</span>edges_with_distances[[i]])</span>
<span id="cb23-38"><a href="#cb23-38"></a>}</span>
<span id="cb23-39"><a href="#cb23-39"></a><span class="co"># A later note to self: Now weight is a measure of distance; how far apart two time points are</span></span>
<span id="cb23-40"><a href="#cb23-40"></a><span class="co"># (under the radius, i.e. they&#39;re reasonably similar to begin with)</span></span>
<span id="cb23-41"><a href="#cb23-41"></a></span>
<span id="cb23-42"><a href="#cb23-42"></a><span class="co">####### To check:</span></span>
<span id="cb23-43"><a href="#cb23-43"></a><span class="co"># igraph::E(emadata_nested_wrangled_both_recnets$graph_from_adjacency[[1]])$weight</span></span>
<span id="cb23-44"><a href="#cb23-44"></a><span class="co"># igraph::E(emadata_nested_wrangled_both_recnets$graph_from_adjacency_orig[[1]])$weight</span></span>
<span id="cb23-45"><a href="#cb23-45"></a></span>
<span id="cb23-46"><a href="#cb23-46"></a>emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb23-47"><a href="#cb23-47"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">RN_plot =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> RN,</span>
<span id="cb23-48"><a href="#cb23-48"></a>                                <span class="dt">.f =</span>  <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rn_plot</span>(.x,</span>
<span id="cb23-49"><a href="#cb23-49"></a>                                                       <span class="dt">plotDimensions =</span> <span class="ot">TRUE</span>,</span>
<span id="cb23-50"><a href="#cb23-50"></a>                                                       <span class="dt">xlab =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>,</span>
<span id="cb23-51"><a href="#cb23-51"></a>                                                       <span class="dt">ylab =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>)))</span></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/unnamed-chunk-7-1.png" width="2100" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a></span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="co"># Make node size equal to strength. Strength is the sum of a node&#39;s edge weights.</span></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets)) {</span>
<span id="cb24-4"><a href="#cb24-4"></a>igraph<span class="op">::</span><span class="kw">V</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>size &lt;-<span class="st"> </span>(igraph<span class="op">::</span><span class="kw">strength</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]]))</span>
<span id="cb24-5"><a href="#cb24-5"></a>}</span>
<span id="cb24-6"><a href="#cb24-6"></a></span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="co"># Rescaling weight as &quot;width&quot;; varies between 5 and 10</span></span>
<span id="cb24-8"><a href="#cb24-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets)) {</span>
<span id="cb24-9"><a href="#cb24-9"></a>igraph<span class="op">::</span><span class="kw">E</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>width &lt;-<span class="st"> </span></span>
<span id="cb24-10"><a href="#cb24-10"></a><span class="st">  </span>casnet<span class="op">::</span><span class="kw">elascer</span>(igraph<span class="op">::</span><span class="kw">E</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>weight, <span class="dt">lo =</span> <span class="dv">5</span>, <span class="dt">hi =</span> <span class="dv">10</span>)</span>
<span id="cb24-11"><a href="#cb24-11"></a>}</span></code></pre></div>
<p>The lengthy code chunk below extracts and marks attractors in the data.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># Get number of maximally connected node</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">max_connected_day =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> graph_from_adjacency,</span>
<span id="cb25-4"><a href="#cb25-4"></a>                                     <span class="dt">.f =</span>  <span class="op">~</span><span class="kw">which.max</span>(igraph<span class="op">::</span><span class="kw">degree</span>(.x))</span>
<span id="cb25-5"><a href="#cb25-5"></a>                                     ))</span>
<span id="cb25-6"><a href="#cb25-6"></a></span>
<span id="cb25-7"><a href="#cb25-7"></a></span>
<span id="cb25-8"><a href="#cb25-8"></a></span>
<span id="cb25-9"><a href="#cb25-9"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-10"><a href="#cb25-10"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">list_of_edges =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> graph_from_adjacency,</span>
<span id="cb25-11"><a href="#cb25-11"></a>                                     <span class="dt">.f =</span>  <span class="op">~</span>igraph<span class="op">::</span><span class="kw">get.data.frame</span>(.x)</span>
<span id="cb25-12"><a href="#cb25-12"></a>                                     ))</span>
<span id="cb25-13"><a href="#cb25-13"></a></span>
<span id="cb25-14"><a href="#cb25-14"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-15"><a href="#cb25-15"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> </span>
<span id="cb25-16"><a href="#cb25-16"></a>                  purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> sample3_standardised,</span>
<span id="cb25-17"><a href="#cb25-17"></a>                              <span class="dt">.y =</span> graph_from_adjacency,</span>
<span id="cb25-18"><a href="#cb25-18"></a>                              <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb25-19"><a href="#cb25-19"></a>                                <span class="kw">data.frame</span>(.x <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-20"><a href="#cb25-20"></a><span class="st">                                             </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="co">#autonomy, competence, relatedness,</span></span>
<span id="cb25-21"><a href="#cb25-21"></a>                                                                       pleasure, interest, importance,</span>
<span id="cb25-22"><a href="#cb25-22"></a>                                                                       situation_requires, anxiety_guilt_avoidance, another_wants), </span>
<span id="cb25-23"><a href="#cb25-23"></a>                                           <span class="dt">strength =</span> igraph<span class="op">::</span><span class="kw">strength</span>(.y)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-24"><a href="#cb25-24"></a><span class="st">                                  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">time =</span> dplyr<span class="op">::</span><span class="kw">row_number</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-25"><a href="#cb25-25"></a><span class="st">                                  </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(<span class="op">-</span>strength, <span class="op">-</span>time))</span>
<span id="cb25-26"><a href="#cb25-26"></a>                              }</span>
<span id="cb25-27"><a href="#cb25-27"></a>  ))</span>
<span id="cb25-28"><a href="#cb25-28"></a></span>
<span id="cb25-29"><a href="#cb25-29"></a><span class="co"># Extract nodes (i.e. times) which connect to the strongest (i.e. most connected) node</span></span>
<span id="cb25-30"><a href="#cb25-30"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-31"><a href="#cb25-31"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</span>
<span id="cb25-32"><a href="#cb25-32"></a>                                                      <span class="dt">.y =</span> max_connected_day,</span>
<span id="cb25-33"><a href="#cb25-33"></a>                                                      <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb25-34"><a href="#cb25-34"></a>                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-35"><a href="#cb25-35"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-36"><a href="#cb25-36"></a><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</span>
<span id="cb25-37"><a href="#cb25-37"></a>                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-38"><a href="#cb25-38"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </span>
<span id="cb25-39"><a href="#cb25-39"></a>                                                                          <span class="co">#.keep_all = TRUE</span></span>
<span id="cb25-40"><a href="#cb25-40"></a>                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-41"><a href="#cb25-41"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</span>
<span id="cb25-42"><a href="#cb25-42"></a>                                                      }</span>
<span id="cb25-43"><a href="#cb25-43"></a>                                                      )</span>
<span id="cb25-44"><a href="#cb25-44"></a>  )</span>
<span id="cb25-45"><a href="#cb25-45"></a></span>
<span id="cb25-46"><a href="#cb25-46"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-47"><a href="#cb25-47"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb25-48"><a href="#cb25-48"></a>                                                       <span class="dt">.y =</span> connecting_to_strongest,</span>
<span id="cb25-49"><a href="#cb25-49"></a>                                                       <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb25-50"><a href="#cb25-50"></a>                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb25-51"><a href="#cb25-51"></a>                                                                       <span class="dt">connecting_to_strongest =</span> </span>
<span id="cb25-52"><a href="#cb25-52"></a>                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb25-53"><a href="#cb25-53"></a>                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb25-54"><a href="#cb25-54"></a>                                                       }</span>
<span id="cb25-55"><a href="#cb25-55"></a>  ))</span>
<span id="cb25-56"><a href="#cb25-56"></a></span>
<span id="cb25-57"><a href="#cb25-57"></a><span class="co"># Get number of 2nd maximally connected node, which doesn&#39;t connect to the 1st</span></span>
<span id="cb25-58"><a href="#cb25-58"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-59"><a href="#cb25-59"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">secondary_attractor_day =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> graph_from_adjacency,</span>
<span id="cb25-60"><a href="#cb25-60"></a>                                                      <span class="dt">.y =</span> connecting_to_strongest,</span>
<span id="cb25-61"><a href="#cb25-61"></a>                                                      <span class="dt">.f =</span>  <span class="op">~</span>{</span>
<span id="cb25-62"><a href="#cb25-62"></a>                                                        <span class="kw">data.frame</span>(<span class="dt">degree =</span> igraph<span class="op">::</span><span class="kw">degree</span>(.x), </span>
<span id="cb25-63"><a href="#cb25-63"></a>                                                                   <span class="dt">time =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(igraph<span class="op">::</span><span class="kw">degree</span>(.x))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-64"><a href="#cb25-64"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-65"><a href="#cb25-65"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(degree)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-66"><a href="#cb25-66"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-67"><a href="#cb25-67"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(time)</span>
<span id="cb25-68"><a href="#cb25-68"></a>                                                      }                                                    </span>
<span id="cb25-69"><a href="#cb25-69"></a>  ))</span>
<span id="cb25-70"><a href="#cb25-70"></a></span>
<span id="cb25-71"><a href="#cb25-71"></a><span class="co"># Extract nodes (i.e. times) which connect to the 2nd strongest node, which doesn&#39;t connect to the 1st</span></span>
<span id="cb25-72"><a href="#cb25-72"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-73"><a href="#cb25-73"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_2nd_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</span>
<span id="cb25-74"><a href="#cb25-74"></a>                                                      <span class="dt">.y =</span> secondary_attractor_day,</span>
<span id="cb25-75"><a href="#cb25-75"></a>                                                      <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb25-76"><a href="#cb25-76"></a>                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-77"><a href="#cb25-77"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-78"><a href="#cb25-78"></a><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</span>
<span id="cb25-79"><a href="#cb25-79"></a>                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-80"><a href="#cb25-80"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </span>
<span id="cb25-81"><a href="#cb25-81"></a>                                                                          <span class="co">#.keep_all = TRUE</span></span>
<span id="cb25-82"><a href="#cb25-82"></a>                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-83"><a href="#cb25-83"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</span>
<span id="cb25-84"><a href="#cb25-84"></a>                                                      }</span>
<span id="cb25-85"><a href="#cb25-85"></a>                                                      )</span>
<span id="cb25-86"><a href="#cb25-86"></a>  )</span>
<span id="cb25-87"><a href="#cb25-87"></a></span>
<span id="cb25-88"><a href="#cb25-88"></a><span class="co"># Save as a variable in the dataset</span></span>
<span id="cb25-89"><a href="#cb25-89"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-90"><a href="#cb25-90"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb25-91"><a href="#cb25-91"></a>                                                       <span class="dt">.y =</span> connecting_to_2nd_strongest,</span>
<span id="cb25-92"><a href="#cb25-92"></a>                                                       <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb25-93"><a href="#cb25-93"></a>                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb25-94"><a href="#cb25-94"></a>                                                                       <span class="dt">connecting_to_2nd_strongest =</span> </span>
<span id="cb25-95"><a href="#cb25-95"></a>                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb25-96"><a href="#cb25-96"></a>                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb25-97"><a href="#cb25-97"></a>                                                       }</span>
<span id="cb25-98"><a href="#cb25-98"></a>  ))</span>
<span id="cb25-99"><a href="#cb25-99"></a></span>
<span id="cb25-100"><a href="#cb25-100"></a><span class="co"># Get number of 3rd maximally connected node, which doesn&#39;t connect to the 1st or second</span></span>
<span id="cb25-101"><a href="#cb25-101"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-102"><a href="#cb25-102"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">tertiary_attractor_day =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> graph_from_adjacency,</span>
<span id="cb25-103"><a href="#cb25-103"></a>                                                      <span class="dt">..2 =</span> connecting_to_strongest,</span>
<span id="cb25-104"><a href="#cb25-104"></a>                                                      <span class="dt">..3 =</span> connecting_to_2nd_strongest),</span>
<span id="cb25-105"><a href="#cb25-105"></a>                                                      <span class="dt">.f =</span>  <span class="op">~</span>{</span>
<span id="cb25-106"><a href="#cb25-106"></a>                                                        <span class="kw">data.frame</span>(<span class="dt">degree =</span> igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>), </span>
<span id="cb25-107"><a href="#cb25-107"></a>                                                                   <span class="dt">time =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-108"><a href="#cb25-108"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">2</span>, </span>
<span id="cb25-109"><a href="#cb25-109"></a>                                                                        <span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-110"><a href="#cb25-110"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(degree)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-111"><a href="#cb25-111"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-112"><a href="#cb25-112"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(time)</span>
<span id="cb25-113"><a href="#cb25-113"></a>                                                      }                                                    </span>
<span id="cb25-114"><a href="#cb25-114"></a>  ))</span>
<span id="cb25-115"><a href="#cb25-115"></a></span>
<span id="cb25-116"><a href="#cb25-116"></a><span class="co"># Extract nodes (i.e. times) which connect to the 3rd strongest node</span></span>
<span id="cb25-117"><a href="#cb25-117"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-118"><a href="#cb25-118"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_3rd_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</span>
<span id="cb25-119"><a href="#cb25-119"></a>                                                      <span class="dt">.y =</span> tertiary_attractor_day,</span>
<span id="cb25-120"><a href="#cb25-120"></a>                                                      <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb25-121"><a href="#cb25-121"></a>                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-122"><a href="#cb25-122"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-123"><a href="#cb25-123"></a><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</span>
<span id="cb25-124"><a href="#cb25-124"></a>                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-125"><a href="#cb25-125"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </span>
<span id="cb25-126"><a href="#cb25-126"></a>                                                                          <span class="co">#.keep_all = TRUE</span></span>
<span id="cb25-127"><a href="#cb25-127"></a>                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-128"><a href="#cb25-128"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</span>
<span id="cb25-129"><a href="#cb25-129"></a>                                                      }</span>
<span id="cb25-130"><a href="#cb25-130"></a>                                                      )</span>
<span id="cb25-131"><a href="#cb25-131"></a>  )</span>
<span id="cb25-132"><a href="#cb25-132"></a></span>
<span id="cb25-133"><a href="#cb25-133"></a><span class="co"># Save as a variable</span></span>
<span id="cb25-134"><a href="#cb25-134"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-135"><a href="#cb25-135"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb25-136"><a href="#cb25-136"></a>                                                       <span class="dt">.y =</span> connecting_to_3rd_strongest,</span>
<span id="cb25-137"><a href="#cb25-137"></a>                                                       <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb25-138"><a href="#cb25-138"></a>                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb25-139"><a href="#cb25-139"></a>                                                                       <span class="dt">connecting_to_3rd_strongest =</span> </span>
<span id="cb25-140"><a href="#cb25-140"></a>                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb25-141"><a href="#cb25-141"></a>                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb25-142"><a href="#cb25-142"></a>                                                       }</span>
<span id="cb25-143"><a href="#cb25-143"></a>  ))</span>
<span id="cb25-144"><a href="#cb25-144"></a></span>
<span id="cb25-145"><a href="#cb25-145"></a></span>
<span id="cb25-146"><a href="#cb25-146"></a></span>
<span id="cb25-147"><a href="#cb25-147"></a><span class="co"># Get number of 4th maximally connected node, which doesn&#39;t connect to the 1st or second</span></span>
<span id="cb25-148"><a href="#cb25-148"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-149"><a href="#cb25-149"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">fourth_attractor_day =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> graph_from_adjacency,</span>
<span id="cb25-150"><a href="#cb25-150"></a>                                                      <span class="dt">..2 =</span> connecting_to_strongest,</span>
<span id="cb25-151"><a href="#cb25-151"></a>                                                      <span class="dt">..3 =</span> connecting_to_2nd_strongest,</span>
<span id="cb25-152"><a href="#cb25-152"></a>                                                      <span class="dt">..4 =</span> connecting_to_3rd_strongest),</span>
<span id="cb25-153"><a href="#cb25-153"></a>                                                      <span class="dt">.f =</span>  <span class="op">~</span>{</span>
<span id="cb25-154"><a href="#cb25-154"></a>                                                        <span class="kw">data.frame</span>(<span class="dt">degree =</span> igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>), </span>
<span id="cb25-155"><a href="#cb25-155"></a>                                                                   <span class="dt">time =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-156"><a href="#cb25-156"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">2</span>, </span>
<span id="cb25-157"><a href="#cb25-157"></a>                                                                        <span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">3</span>, </span>
<span id="cb25-158"><a href="#cb25-158"></a>                                                                        <span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-159"><a href="#cb25-159"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(degree)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-160"><a href="#cb25-160"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-161"><a href="#cb25-161"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(time)</span>
<span id="cb25-162"><a href="#cb25-162"></a>                                                      }                                                    </span>
<span id="cb25-163"><a href="#cb25-163"></a>  ))</span>
<span id="cb25-164"><a href="#cb25-164"></a></span>
<span id="cb25-165"><a href="#cb25-165"></a><span class="co"># Extract nodes (i.e. times) which connect to the 3rd strongest node</span></span>
<span id="cb25-166"><a href="#cb25-166"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-167"><a href="#cb25-167"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_4th_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</span>
<span id="cb25-168"><a href="#cb25-168"></a>                                                      <span class="dt">.y =</span> fourth_attractor_day,</span>
<span id="cb25-169"><a href="#cb25-169"></a>                                                      <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb25-170"><a href="#cb25-170"></a>                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-171"><a href="#cb25-171"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-172"><a href="#cb25-172"></a><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</span>
<span id="cb25-173"><a href="#cb25-173"></a>                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-174"><a href="#cb25-174"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </span>
<span id="cb25-175"><a href="#cb25-175"></a>                                                                          <span class="co">#.keep_all = TRUE</span></span>
<span id="cb25-176"><a href="#cb25-176"></a>                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-177"><a href="#cb25-177"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</span>
<span id="cb25-178"><a href="#cb25-178"></a>                                                      }</span>
<span id="cb25-179"><a href="#cb25-179"></a>                                                      )</span>
<span id="cb25-180"><a href="#cb25-180"></a>  )</span>
<span id="cb25-181"><a href="#cb25-181"></a></span>
<span id="cb25-182"><a href="#cb25-182"></a><span class="co"># Save as a variable</span></span>
<span id="cb25-183"><a href="#cb25-183"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-184"><a href="#cb25-184"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb25-185"><a href="#cb25-185"></a>                                                       <span class="dt">.y =</span> connecting_to_4th_strongest,</span>
<span id="cb25-186"><a href="#cb25-186"></a>                                                       <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb25-187"><a href="#cb25-187"></a>                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb25-188"><a href="#cb25-188"></a>                                                                       <span class="dt">connecting_to_4th_strongest =</span> </span>
<span id="cb25-189"><a href="#cb25-189"></a>                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb25-190"><a href="#cb25-190"></a>                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb25-191"><a href="#cb25-191"></a>                                                       }</span>
<span id="cb25-192"><a href="#cb25-192"></a>  ))</span>
<span id="cb25-193"><a href="#cb25-193"></a></span>
<span id="cb25-194"><a href="#cb25-194"></a><span class="co">################### Make plots</span></span>
<span id="cb25-195"><a href="#cb25-195"></a></span>
<span id="cb25-196"><a href="#cb25-196"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-197"><a href="#cb25-197"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> </span>
<span id="cb25-198"><a href="#cb25-198"></a>                  purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb25-199"><a href="#cb25-199"></a>                             <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb25-200"><a href="#cb25-200"></a>                               dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb25-201"><a href="#cb25-201"></a>                                             <span class="dt">attractors =</span> dplyr<span class="op">::</span><span class="kw">case_when</span>(</span>
<span id="cb25-202"><a href="#cb25-202"></a>                                               strength <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> &quot;Unique&quot;</span>,</span>
<span id="cb25-203"><a href="#cb25-203"></a>                                               connecting_to_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;1st&quot;</span>,</span>
<span id="cb25-204"><a href="#cb25-204"></a>                                               connecting_to_2nd_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;2nd&quot;</span>,</span>
<span id="cb25-205"><a href="#cb25-205"></a>                                               connecting_to_3rd_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;3rd&quot;</span>,</span>
<span id="cb25-206"><a href="#cb25-206"></a>                                               connecting_to_4th_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;4th&quot;</span>,</span>
<span id="cb25-207"><a href="#cb25-207"></a>                                               <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Uncategorised&quot;</span>),</span>
<span id="cb25-208"><a href="#cb25-208"></a>                                             <span class="dt">attractors =</span> <span class="kw">factor</span>(attractors,</span>
<span id="cb25-209"><a href="#cb25-209"></a>                                                                 <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;1st&quot;</span>,</span>
<span id="cb25-210"><a href="#cb25-210"></a>                                                                            <span class="st">&quot;2nd&quot;</span>,</span>
<span id="cb25-211"><a href="#cb25-211"></a>                                                                            <span class="st">&quot;3rd&quot;</span>,</span>
<span id="cb25-212"><a href="#cb25-212"></a>                                                                            <span class="st">&quot;4th&quot;</span>,</span>
<span id="cb25-213"><a href="#cb25-213"></a>                                                                            <span class="st">&quot;Uncategorised&quot;</span>,</span>
<span id="cb25-214"><a href="#cb25-214"></a>                                                                            <span class="st">&quot;Unique&quot;</span>)),</span>
<span id="cb25-215"><a href="#cb25-215"></a>                                             <span class="dt">name =</span> <span class="kw">factor</span>(name,</span>
<span id="cb25-216"><a href="#cb25-216"></a>                                                           <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;pleasure&quot;</span>,</span>
<span id="cb25-217"><a href="#cb25-217"></a>                                                                      <span class="st">&quot;interest&quot;</span>,</span>
<span id="cb25-218"><a href="#cb25-218"></a>                                                                      <span class="st">&quot;importance&quot;</span>,</span>
<span id="cb25-219"><a href="#cb25-219"></a>                                                                      <span class="st">&quot;situation_requires&quot;</span>,</span>
<span id="cb25-220"><a href="#cb25-220"></a>                                                                      <span class="st">&quot;anxiety_guilt_avoidance&quot;</span>,</span>
<span id="cb25-221"><a href="#cb25-221"></a>                                                                      <span class="st">&quot;another_wants&quot;</span>),</span>
<span id="cb25-222"><a href="#cb25-222"></a>                                                           <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Pleasure&quot;</span>,</span>
<span id="cb25-223"><a href="#cb25-223"></a>                                                                      <span class="st">&quot;Interest&quot;</span>,</span>
<span id="cb25-224"><a href="#cb25-224"></a>                                                                      <span class="st">&quot;Importance&quot;</span>,</span>
<span id="cb25-225"><a href="#cb25-225"></a>                                                                      <span class="st">&quot;Situation requires&quot;</span>,</span>
<span id="cb25-226"><a href="#cb25-226"></a>                                                                      <span class="st">&quot;Anxiety guilt avoidance&quot;</span>,</span>
<span id="cb25-227"><a href="#cb25-227"></a>                                                                      <span class="st">&quot;Another wants&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-228"><a href="#cb25-228"></a><span class="st">                                               </span>forcats<span class="op">::</span><span class="kw">fct_drop</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-229"><a href="#cb25-229"></a><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(attractors, name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-230"><a href="#cb25-230"></a><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-231"><a href="#cb25-231"></a><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb25-232"><a href="#cb25-232"></a><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">maxtime =</span> <span class="kw">max</span>(time),</span>
<span id="cb25-233"><a href="#cb25-233"></a>                                               <span class="dt">percentage_of_total =</span></span>
<span id="cb25-234"><a href="#cb25-234"></a>                                                 (n <span class="op">/</span><span class="st"> </span>maxtime) <span class="op">%&gt;%</span><span class="st"> </span>scales<span class="op">::</span><span class="kw">percent</span>(<span class="dt">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb25-235"><a href="#cb25-235"></a>                                               <span class="dt">proportion_of_total =</span> n<span class="op">/</span>maxtime,</span>
<span id="cb25-236"><a href="#cb25-236"></a>                                               <span class="dt">attractors_n =</span> </span>
<span id="cb25-237"><a href="#cb25-237"></a>                                                 <span class="kw">factor</span>(<span class="kw">paste0</span>(attractors,</span>
<span id="cb25-238"><a href="#cb25-238"></a>                                                               <span class="st">&quot; (n = &quot;</span>, n, <span class="st">&quot;; &quot;</span>, </span>
<span id="cb25-239"><a href="#cb25-239"></a>                                                               percentage_of_total, <span class="st">&quot;)&quot;</span>)))</span>
<span id="cb25-240"><a href="#cb25-240"></a>                             }</span>
<span id="cb25-241"><a href="#cb25-241"></a>                  ))</span></code></pre></div>
<div id="spiral-graph-with-colored-nodes-3" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">Spiral graph with colored nodes</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">node_colors =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb26-3"><a href="#cb26-3"></a>                                         <span class="dt">.f =</span> <span class="op">~</span>{tidyr<span class="op">::</span><span class="kw">pivot_wider</span>(.x, <span class="dt">names_from =</span> name) <span class="op">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="st">                                             </span>dplyr<span class="op">::</span><span class="kw">pull</span>(attractors)}))</span>
<span id="cb26-5"><a href="#cb26-5"></a></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets_nodes_plots)) {</span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="kw">levels</span>(emadata_nested_wrangled_both_recnets_nodes_plots<span class="op">$</span>node_colors[[i]]) &lt;-<span class="st"> </span></span>
<span id="cb26-8"><a href="#cb26-8"></a><span class="st">  </span><span class="kw">c</span>(viridisLite<span class="op">::</span><span class="kw">plasma</span>(<span class="dv">4</span>, </span>
<span id="cb26-9"><a href="#cb26-9"></a>                      <span class="dt">end =</span> <span class="fl">0.8</span>, </span>
<span id="cb26-10"><a href="#cb26-10"></a>                      <span class="dt">direction =</span> <span class="dv">-1</span>), <span class="st">&quot;gray48&quot;</span>, <span class="st">&quot;white&quot;</span>)</span>
<span id="cb26-11"><a href="#cb26-11"></a>  }</span>
<span id="cb26-12"><a href="#cb26-12"></a></span>
<span id="cb26-13"><a href="#cb26-13"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-14"><a href="#cb26-14"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">spiralgraph_epochs =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> graph_from_adjacency,</span>
<span id="cb26-15"><a href="#cb26-15"></a>                                          <span class="dt">..2 =</span> node_colors,</span>
<span id="cb26-16"><a href="#cb26-16"></a>                                          <span class="dt">..3 =</span> User),</span>
<span id="cb26-17"><a href="#cb26-17"></a>                                     <span class="dt">.f =</span>  <span class="op">~</span>casnet<span class="op">::</span><span class="kw">make_spiral_graph</span>(<span class="dt">g =</span> ..<span class="dv">1</span>, </span>
<span id="cb26-18"><a href="#cb26-18"></a>                                                                      <span class="dt">arcs =</span> <span class="dv">4</span>, </span>
<span id="cb26-19"><a href="#cb26-19"></a>                                                                      <span class="co"># a = .1, </span></span>
<span id="cb26-20"><a href="#cb26-20"></a>                                                                      <span class="co"># b = 2, </span></span>
<span id="cb26-21"><a href="#cb26-21"></a>                                                                      <span class="dt">markTimeBy =</span> <span class="ot">TRUE</span>,</span>
<span id="cb26-22"><a href="#cb26-22"></a>                                                                      <span class="dt">markEpochsBy =</span> ..<span class="dv">2</span>,</span>
<span id="cb26-23"><a href="#cb26-23"></a>                                                                      <span class="dt">epochColours =</span> ..<span class="dv">2</span>,</span>
<span id="cb26-24"><a href="#cb26-24"></a>                                                                      <span class="dt">showEpochLegend =</span> <span class="ot">FALSE</span>,</span>
<span id="cb26-25"><a href="#cb26-25"></a>                                                                      <span class="dt">scaleEdgeSize =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">10</span>,</span>
<span id="cb26-26"><a href="#cb26-26"></a>                                                                      <span class="dt">scaleVertexSize =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">5</span>),</span>
<span id="cb26-27"><a href="#cb26-27"></a>                                                                      <span class="dt">showSizeLegend =</span> <span class="ot">FALSE</span>,</span>
<span id="cb26-28"><a href="#cb26-28"></a>                                                                      <span class="dt">sizeLabel =</span> <span class="st">&quot;Node strength&quot;</span>,</span>
<span id="cb26-29"><a href="#cb26-29"></a>                                                                      <span class="dt">type =</span> <span class="st">&quot;Euler&quot;</span>,</span>
<span id="cb26-30"><a href="#cb26-30"></a>                                                                      <span class="co"># alphaE = 0.1</span></span>
<span id="cb26-31"><a href="#cb26-31"></a>                                                                      <span class="co"># title = ..3</span></span>
<span id="cb26-32"><a href="#cb26-32"></a>                                     )))</span></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/unnamed-chunk-9-1.png" width="2100" /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="co"># emadata_nested_wrangled_both_recnets_nodes_plots$spiralgraph_epochs[[1]] +</span></span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="co">#   theme(plot.margin=grid::unit(c(0,0,0,0), &quot;mm&quot;))</span></span>
<span id="cb27-4"><a href="#cb27-4"></a></span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="co"># ggsave(filename = &quot;./figures/recnetwork.png&quot;,</span></span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="co">#        width = 7, </span></span>
<span id="cb27-7"><a href="#cb27-7"></a><span class="co">#        height = 7)</span></span>
<span id="cb27-8"><a href="#cb27-8"></a></span>
<span id="cb27-9"><a href="#cb27-9"></a><span class="co"># emadata_nested_wrangled_both_recnets_nodes_plots$all_nodes_with_strengths[[1]]</span></span></code></pre></div>
</div>
<div id="attractor-plot-3" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">Attractor plot</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">observations =</span> purrr<span class="op">::</span><span class="kw">map_dbl</span>(<span class="dt">.x =</span> sample3_standardised,</span>
<span id="cb28-3"><a href="#cb28-3"></a>                                              <span class="dt">.f =</span> <span class="op">~</span><span class="kw">nrow</span>(.)))</span>
<span id="cb28-4"><a href="#cb28-4"></a></span>
<span id="cb28-5"><a href="#cb28-5"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span></span>
<span id="cb28-6"><a href="#cb28-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">observations_daily =</span> purrr<span class="op">::</span><span class="kw">map_dbl</span>(<span class="dt">.x =</span> data_daily,</span>
<span id="cb28-7"><a href="#cb28-7"></a>                                              <span class="dt">.f =</span> <span class="op">~</span><span class="kw">nrow</span>(.)))</span>
<span id="cb28-8"><a href="#cb28-8"></a></span>
<span id="cb28-9"><a href="#cb28-9"></a></span>
<span id="cb28-10"><a href="#cb28-10"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb28-11"><a href="#cb28-11"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(</span>
<span id="cb28-12"><a href="#cb28-12"></a>    <span class="dt">attractor_plots =</span> </span>
<span id="cb28-13"><a href="#cb28-13"></a>      purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> all_nodes_with_strengths,</span>
<span id="cb28-14"><a href="#cb28-14"></a>                       <span class="dt">..2 =</span> observations,</span>
<span id="cb28-15"><a href="#cb28-15"></a>                       <span class="dt">..3 =</span> observations_daily,</span>
<span id="cb28-16"><a href="#cb28-16"></a>                       <span class="dt">..4 =</span> User),</span>
<span id="cb28-17"><a href="#cb28-17"></a>                  <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb28-18"><a href="#cb28-18"></a>                    dplyr<span class="op">::</span><span class="kw">mutate</span>(..<span class="dv">1</span>,</span>
<span id="cb28-19"><a href="#cb28-19"></a>                                  <span class="dt">strength_rescaled =</span> </span>
<span id="cb28-20"><a href="#cb28-20"></a>                                    scales<span class="op">::</span><span class="kw">rescale</span>(strength, <span class="dt">to =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">1.1</span>)),</span>
<span id="cb28-21"><a href="#cb28-21"></a>                                  <span class="dt">alpha_strength =</span> <span class="kw">ifelse</span>(strength_rescaled <span class="op">==</span><span class="st"> </span><span class="fl">0.3</span>, </span>
<span id="cb28-22"><a href="#cb28-22"></a>                                                          <span class="fl">0.5</span>, </span>
<span id="cb28-23"><a href="#cb28-23"></a>                                                          strength_rescaled)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb28-24"><a href="#cb28-24"></a><span class="st">                      </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</span>
<span id="cb28-25"><a href="#cb28-25"></a>                             <span class="kw">aes</span>(<span class="dt">x =</span> forcats<span class="op">::</span><span class="kw">fct_rev</span>(name), </span>
<span id="cb28-26"><a href="#cb28-26"></a>                                 <span class="dt">y =</span> value, </span>
<span id="cb28-27"><a href="#cb28-27"></a>                                 <span class="dt">size =</span> strength_rescaled,</span>
<span id="cb28-28"><a href="#cb28-28"></a>                                 <span class="dt">alpha =</span> alpha_strength,</span>
<span id="cb28-29"><a href="#cb28-29"></a>                                 <span class="dt">color =</span> attractors_n)) <span class="op">+</span></span>
<span id="cb28-30"><a href="#cb28-30"></a><span class="st">                      </span><span class="kw">scale_size_identity</span>() <span class="op">+</span></span>
<span id="cb28-31"><a href="#cb28-31"></a><span class="st">                      </span><span class="kw">scale_alpha_identity</span>() <span class="op">+</span></span>
<span id="cb28-32"><a href="#cb28-32"></a><span class="st">                      </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">alpha =</span> alpha_strength)) <span class="op">+</span></span>
<span id="cb28-33"><a href="#cb28-33"></a><span class="st">                      </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> time,</span>
<span id="cb28-34"><a href="#cb28-34"></a>                                    <span class="dt">alpha =</span> alpha_strength)) <span class="op">+</span></span>
<span id="cb28-35"><a href="#cb28-35"></a><span class="st">                      </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(viridisLite<span class="op">::</span><span class="kw">plasma</span>(<span class="dv">4</span>, </span>
<span id="cb28-36"><a href="#cb28-36"></a>                                                                        <span class="dt">end =</span> <span class="fl">0.8</span>, </span>
<span id="cb28-37"><a href="#cb28-37"></a>                                                                        <span class="dt">direction =</span> <span class="dv">-1</span>), </span>
<span id="cb28-38"><a href="#cb28-38"></a>                                                    <span class="st">&quot;gray40&quot;</span>, <span class="st">&quot;gray50&quot;</span>)) <span class="op">+</span></span>
<span id="cb28-39"><a href="#cb28-39"></a><span class="st">                      </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">label_percent</span>(<span class="dt">accuracy =</span> <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb28-40"><a href="#cb28-40"></a><span class="st">                      </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb28-41"><a href="#cb28-41"></a><span class="st">                      </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb28-42"><a href="#cb28-42"></a><span class="st">                      </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Percentage of maximum reported value of variable, across full time series&quot;</span>,</span>
<span id="cb28-43"><a href="#cb28-43"></a>                           <span class="dt">x =</span> <span class="ot">NULL</span>,</span>
<span id="cb28-44"><a href="#cb28-44"></a>                           <span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&quot;Participant </span><span class="ch">\&quot;</span><span class="st">&quot;</span>, ..<span class="dv">4</span>, <span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st"> - based on &quot;</span>, ..<span class="dv">2</span>, <span class="st">&quot; data points (&quot;</span>, ..<span class="dv">3</span>, <span class="st">&quot; days)&quot;</span>)) <span class="op">+</span></span>
<span id="cb28-45"><a href="#cb28-45"></a><span class="st">                      </span><span class="kw">facet_wrap</span>(<span class="op">~</span>attractors_n) <span class="op">+</span></span>
<span id="cb28-46"><a href="#cb28-46"></a><span class="st">                      </span><span class="kw">coord_flip</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb28-47"><a href="#cb28-47"></a>                  }</span>
<span id="cb28-48"><a href="#cb28-48"></a>      ))</span>
<span id="cb28-49"><a href="#cb28-49"></a></span>
<span id="cb28-50"><a href="#cb28-50"></a>emadata_nested_wrangled_both_recnets_nodes_plots<span class="op">$</span>attractor_plots[[<span class="dv">1</span>]]</span></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/attractor-plots_sample3-1.png" width="2100" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co"># emadata_nested_wrangled_both_recnets_nodes_plots$all_nodes_with_strengths[[1]]</span></span></code></pre></div>
</div>
</div>
<div id="all-data" class="section level2 unlisted unnumbered">
<h2 class="unlisted unnumbered">All data</h2>
<p>Here’s the 6-dimensional motivation system’s recurrence plot, weighted by similarity.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a></span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="co">#######################</span></span>
<span id="cb30-4"><a href="#cb30-4"></a></span>
<span id="cb30-5"><a href="#cb30-5"></a><span class="co"># si = similarity under the radius</span></span>
<span id="cb30-6"><a href="#cb30-6"></a>emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb30-7"><a href="#cb30-7"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">RN =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> data_standardised,</span>
<span id="cb30-8"><a href="#cb30-8"></a>                                <span class="dt">.f =</span>  <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rn</span>(.x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="co">#autonomy, competence, relatedness,</span></span>
<span id="cb30-9"><a href="#cb30-9"></a>                                                                       pleasure, interest, importance,</span>
<span id="cb30-10"><a href="#cb30-10"></a>                                                                       situation_requires, </span>
<span id="cb30-11"><a href="#cb30-11"></a>                                                                       anxiety_guilt_avoidance, </span>
<span id="cb30-12"><a href="#cb30-12"></a>                                                                       another_wants), </span>
<span id="cb30-13"><a href="#cb30-13"></a>                                                  <span class="dt">doEmbed =</span> <span class="ot">FALSE</span>, </span>
<span id="cb30-14"><a href="#cb30-14"></a>                                                  <span class="dt">weighted =</span> <span class="ot">TRUE</span>, </span>
<span id="cb30-15"><a href="#cb30-15"></a>                                                  <span class="dt">weightedBy =</span> <span class="st">&quot;si&quot;</span>, </span>
<span id="cb30-16"><a href="#cb30-16"></a>                                                  <span class="dt">emRad =</span> <span class="ot">NA</span>)))</span>
<span id="cb30-17"><a href="#cb30-17"></a><span class="co">## </span></span>
<span id="cb30-18"><a href="#cb30-18"></a><span class="co">## Auto-recurrence: Setting diagonal to (1 + max. distance) for analyses</span></span>
<span id="cb30-19"><a href="#cb30-19"></a><span class="co">## </span></span>
<span id="cb30-20"><a href="#cb30-20"></a><span class="co">## Searching for a radius that will yield 0.05 for RR</span></span>
<span id="cb30-21"><a href="#cb30-21"></a></span>
<span id="cb30-22"><a href="#cb30-22"></a>emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb30-23"><a href="#cb30-23"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">graph_from_adjacency =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> RN,</span>
<span id="cb30-24"><a href="#cb30-24"></a>                                                  <span class="dt">.f =</span> <span class="op">~</span>igraph<span class="op">::</span><span class="kw">graph_from_adjacency_matrix</span>(.x, </span>
<span id="cb30-25"><a href="#cb30-25"></a>                                                                                            <span class="dt">weighted =</span> <span class="ot">TRUE</span>, </span>
<span id="cb30-26"><a href="#cb30-26"></a>                                                                                            <span class="dt">mode =</span> <span class="st">&quot;upper&quot;</span>, </span>
<span id="cb30-27"><a href="#cb30-27"></a>                                                                                            <span class="dt">diag =</span> <span class="ot">FALSE</span>)))</span>
<span id="cb30-28"><a href="#cb30-28"></a></span>
<span id="cb30-29"><a href="#cb30-29"></a><span class="co"># Edges with their distances</span></span>
<span id="cb30-30"><a href="#cb30-30"></a>emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb30-31"><a href="#cb30-31"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">edges_with_distances =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> graph_from_adjacency,</span>
<span id="cb30-32"><a href="#cb30-32"></a>                                                  <span class="dt">.f =</span> <span class="op">~</span>igraph<span class="op">::</span><span class="kw">E</span>(.x)<span class="op">$</span>weight),</span>
<span id="cb30-33"><a href="#cb30-33"></a>                <span class="dt">graph_from_adjacency_orig =</span> graph_from_adjacency)</span>
<span id="cb30-34"><a href="#cb30-34"></a></span>
<span id="cb30-35"><a href="#cb30-35"></a><span class="co"># Larger values are closer to the state; inverse of weight makes it more intuitive</span></span>
<span id="cb30-36"><a href="#cb30-36"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets)) {</span>
<span id="cb30-37"><a href="#cb30-37"></a>igraph<span class="op">::</span><span class="kw">E</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>weight &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>emadata_nested_wrangled_both_recnets<span class="op">$</span>edges_with_distances[[i]])</span>
<span id="cb30-38"><a href="#cb30-38"></a>}</span>
<span id="cb30-39"><a href="#cb30-39"></a><span class="co"># A later note to self: Now weight is a measure of distance; how far apart two time points are</span></span>
<span id="cb30-40"><a href="#cb30-40"></a><span class="co"># (under the radius, i.e. they&#39;re reasonably similar to begin with)</span></span>
<span id="cb30-41"><a href="#cb30-41"></a></span>
<span id="cb30-42"><a href="#cb30-42"></a><span class="co">####### To check:</span></span>
<span id="cb30-43"><a href="#cb30-43"></a><span class="co"># igraph::E(emadata_nested_wrangled_both_recnets$graph_from_adjacency[[1]])$weight</span></span>
<span id="cb30-44"><a href="#cb30-44"></a><span class="co"># igraph::E(emadata_nested_wrangled_both_recnets$graph_from_adjacency_orig[[1]])$weight</span></span>
<span id="cb30-45"><a href="#cb30-45"></a></span>
<span id="cb30-46"><a href="#cb30-46"></a>emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb30-47"><a href="#cb30-47"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">RN_plot =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> RN,</span>
<span id="cb30-48"><a href="#cb30-48"></a>                                <span class="dt">.f =</span>  <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rn_plot</span>(.x,</span>
<span id="cb30-49"><a href="#cb30-49"></a>                                                       <span class="dt">plotDimensions =</span> <span class="ot">TRUE</span>,</span>
<span id="cb30-50"><a href="#cb30-50"></a>                                                       <span class="dt">xlab =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>,</span>
<span id="cb30-51"><a href="#cb30-51"></a>                                                       <span class="dt">ylab =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>)))</span></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/unnamed-chunk-10-1.png" width="2100" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="co"># Make node size equal to strength. Strength is the sum of a node&#39;s edge weights.</span></span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets)) {</span>
<span id="cb31-4"><a href="#cb31-4"></a>igraph<span class="op">::</span><span class="kw">V</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>size &lt;-<span class="st"> </span>(igraph<span class="op">::</span><span class="kw">strength</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]]))</span>
<span id="cb31-5"><a href="#cb31-5"></a>}</span>
<span id="cb31-6"><a href="#cb31-6"></a></span>
<span id="cb31-7"><a href="#cb31-7"></a><span class="co"># Rescaling weight as &quot;width&quot;; varies between 5 and 10</span></span>
<span id="cb31-8"><a href="#cb31-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets)) {</span>
<span id="cb31-9"><a href="#cb31-9"></a>igraph<span class="op">::</span><span class="kw">E</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>width &lt;-<span class="st"> </span></span>
<span id="cb31-10"><a href="#cb31-10"></a><span class="st">  </span>casnet<span class="op">::</span><span class="kw">elascer</span>(igraph<span class="op">::</span><span class="kw">E</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>weight, <span class="dt">lo =</span> <span class="dv">5</span>, <span class="dt">hi =</span> <span class="dv">10</span>)</span>
<span id="cb31-11"><a href="#cb31-11"></a>}</span></code></pre></div>
<p>The lengthy code chunk below extracts and marks attractors in the data.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="co"># Get number of maximally connected node</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">max_connected_day =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> graph_from_adjacency,</span>
<span id="cb32-4"><a href="#cb32-4"></a>                                     <span class="dt">.f =</span>  <span class="op">~</span><span class="kw">which.max</span>(igraph<span class="op">::</span><span class="kw">degree</span>(.x))</span>
<span id="cb32-5"><a href="#cb32-5"></a>                                     ))</span>
<span id="cb32-6"><a href="#cb32-6"></a></span>
<span id="cb32-7"><a href="#cb32-7"></a></span>
<span id="cb32-8"><a href="#cb32-8"></a></span>
<span id="cb32-9"><a href="#cb32-9"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-10"><a href="#cb32-10"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">list_of_edges =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> graph_from_adjacency,</span>
<span id="cb32-11"><a href="#cb32-11"></a>                                     <span class="dt">.f =</span>  <span class="op">~</span>igraph<span class="op">::</span><span class="kw">get.data.frame</span>(.x)</span>
<span id="cb32-12"><a href="#cb32-12"></a>                                     ))</span>
<span id="cb32-13"><a href="#cb32-13"></a></span>
<span id="cb32-14"><a href="#cb32-14"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-15"><a href="#cb32-15"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> </span>
<span id="cb32-16"><a href="#cb32-16"></a>                  purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> data_standardised,</span>
<span id="cb32-17"><a href="#cb32-17"></a>                              <span class="dt">.y =</span> graph_from_adjacency,</span>
<span id="cb32-18"><a href="#cb32-18"></a>                              <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb32-19"><a href="#cb32-19"></a>                                <span class="kw">data.frame</span>(.x <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-20"><a href="#cb32-20"></a><span class="st">                                             </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="co">#autonomy, competence, relatedness,</span></span>
<span id="cb32-21"><a href="#cb32-21"></a>                                                                       pleasure, interest, importance,</span>
<span id="cb32-22"><a href="#cb32-22"></a>                                                                       situation_requires, anxiety_guilt_avoidance, another_wants), </span>
<span id="cb32-23"><a href="#cb32-23"></a>                                           <span class="dt">strength =</span> igraph<span class="op">::</span><span class="kw">strength</span>(.y)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-24"><a href="#cb32-24"></a><span class="st">                                  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">time =</span> dplyr<span class="op">::</span><span class="kw">row_number</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-25"><a href="#cb32-25"></a><span class="st">                                  </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(<span class="op">-</span>strength, <span class="op">-</span>time))</span>
<span id="cb32-26"><a href="#cb32-26"></a>                              }</span>
<span id="cb32-27"><a href="#cb32-27"></a>  ))</span>
<span id="cb32-28"><a href="#cb32-28"></a></span>
<span id="cb32-29"><a href="#cb32-29"></a><span class="co"># Extract nodes (i.e. times) which connect to the strongest (i.e. most connected) node</span></span>
<span id="cb32-30"><a href="#cb32-30"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-31"><a href="#cb32-31"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</span>
<span id="cb32-32"><a href="#cb32-32"></a>                                                      <span class="dt">.y =</span> max_connected_day,</span>
<span id="cb32-33"><a href="#cb32-33"></a>                                                      <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb32-34"><a href="#cb32-34"></a>                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-35"><a href="#cb32-35"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-36"><a href="#cb32-36"></a><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</span>
<span id="cb32-37"><a href="#cb32-37"></a>                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-38"><a href="#cb32-38"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </span>
<span id="cb32-39"><a href="#cb32-39"></a>                                                                          <span class="co">#.keep_all = TRUE</span></span>
<span id="cb32-40"><a href="#cb32-40"></a>                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-41"><a href="#cb32-41"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</span>
<span id="cb32-42"><a href="#cb32-42"></a>                                                      }</span>
<span id="cb32-43"><a href="#cb32-43"></a>                                                      )</span>
<span id="cb32-44"><a href="#cb32-44"></a>  )</span>
<span id="cb32-45"><a href="#cb32-45"></a></span>
<span id="cb32-46"><a href="#cb32-46"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-47"><a href="#cb32-47"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb32-48"><a href="#cb32-48"></a>                                                       <span class="dt">.y =</span> connecting_to_strongest,</span>
<span id="cb32-49"><a href="#cb32-49"></a>                                                       <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb32-50"><a href="#cb32-50"></a>                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb32-51"><a href="#cb32-51"></a>                                                                       <span class="dt">connecting_to_strongest =</span> </span>
<span id="cb32-52"><a href="#cb32-52"></a>                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb32-53"><a href="#cb32-53"></a>                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb32-54"><a href="#cb32-54"></a>                                                       }</span>
<span id="cb32-55"><a href="#cb32-55"></a>  ))</span>
<span id="cb32-56"><a href="#cb32-56"></a></span>
<span id="cb32-57"><a href="#cb32-57"></a><span class="co"># Get number of 2nd maximally connected node, which doesn&#39;t connect to the 1st</span></span>
<span id="cb32-58"><a href="#cb32-58"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-59"><a href="#cb32-59"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">secondary_attractor_day =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> graph_from_adjacency,</span>
<span id="cb32-60"><a href="#cb32-60"></a>                                                      <span class="dt">.y =</span> connecting_to_strongest,</span>
<span id="cb32-61"><a href="#cb32-61"></a>                                                      <span class="dt">.f =</span>  <span class="op">~</span>{</span>
<span id="cb32-62"><a href="#cb32-62"></a>                                                        <span class="kw">data.frame</span>(<span class="dt">degree =</span> igraph<span class="op">::</span><span class="kw">degree</span>(.x), </span>
<span id="cb32-63"><a href="#cb32-63"></a>                                                                   <span class="dt">time =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(igraph<span class="op">::</span><span class="kw">degree</span>(.x))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-64"><a href="#cb32-64"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-65"><a href="#cb32-65"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(degree)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-66"><a href="#cb32-66"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-67"><a href="#cb32-67"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(time)</span>
<span id="cb32-68"><a href="#cb32-68"></a>                                                      }                                                    </span>
<span id="cb32-69"><a href="#cb32-69"></a>  ))</span>
<span id="cb32-70"><a href="#cb32-70"></a></span>
<span id="cb32-71"><a href="#cb32-71"></a><span class="co"># Extract nodes (i.e. times) which connect to the 2nd strongest node, which doesn&#39;t connect to the 1st</span></span>
<span id="cb32-72"><a href="#cb32-72"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-73"><a href="#cb32-73"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_2nd_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</span>
<span id="cb32-74"><a href="#cb32-74"></a>                                                      <span class="dt">.y =</span> secondary_attractor_day,</span>
<span id="cb32-75"><a href="#cb32-75"></a>                                                      <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb32-76"><a href="#cb32-76"></a>                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-77"><a href="#cb32-77"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-78"><a href="#cb32-78"></a><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</span>
<span id="cb32-79"><a href="#cb32-79"></a>                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-80"><a href="#cb32-80"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </span>
<span id="cb32-81"><a href="#cb32-81"></a>                                                                          <span class="co">#.keep_all = TRUE</span></span>
<span id="cb32-82"><a href="#cb32-82"></a>                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-83"><a href="#cb32-83"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</span>
<span id="cb32-84"><a href="#cb32-84"></a>                                                      }</span>
<span id="cb32-85"><a href="#cb32-85"></a>                                                      )</span>
<span id="cb32-86"><a href="#cb32-86"></a>  )</span>
<span id="cb32-87"><a href="#cb32-87"></a></span>
<span id="cb32-88"><a href="#cb32-88"></a><span class="co"># Save as a variable in the dataset</span></span>
<span id="cb32-89"><a href="#cb32-89"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-90"><a href="#cb32-90"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb32-91"><a href="#cb32-91"></a>                                                       <span class="dt">.y =</span> connecting_to_2nd_strongest,</span>
<span id="cb32-92"><a href="#cb32-92"></a>                                                       <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb32-93"><a href="#cb32-93"></a>                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb32-94"><a href="#cb32-94"></a>                                                                       <span class="dt">connecting_to_2nd_strongest =</span> </span>
<span id="cb32-95"><a href="#cb32-95"></a>                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb32-96"><a href="#cb32-96"></a>                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb32-97"><a href="#cb32-97"></a>                                                       }</span>
<span id="cb32-98"><a href="#cb32-98"></a>  ))</span>
<span id="cb32-99"><a href="#cb32-99"></a></span>
<span id="cb32-100"><a href="#cb32-100"></a><span class="co"># Get number of 3rd maximally connected node, which doesn&#39;t connect to the 1st or second</span></span>
<span id="cb32-101"><a href="#cb32-101"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-102"><a href="#cb32-102"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">tertiary_attractor_day =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> graph_from_adjacency,</span>
<span id="cb32-103"><a href="#cb32-103"></a>                                                      <span class="dt">..2 =</span> connecting_to_strongest,</span>
<span id="cb32-104"><a href="#cb32-104"></a>                                                      <span class="dt">..3 =</span> connecting_to_2nd_strongest),</span>
<span id="cb32-105"><a href="#cb32-105"></a>                                                      <span class="dt">.f =</span>  <span class="op">~</span>{</span>
<span id="cb32-106"><a href="#cb32-106"></a>                                                        <span class="kw">data.frame</span>(<span class="dt">degree =</span> igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>), </span>
<span id="cb32-107"><a href="#cb32-107"></a>                                                                   <span class="dt">time =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-108"><a href="#cb32-108"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">2</span>, </span>
<span id="cb32-109"><a href="#cb32-109"></a>                                                                        <span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-110"><a href="#cb32-110"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(degree)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-111"><a href="#cb32-111"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-112"><a href="#cb32-112"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(time)</span>
<span id="cb32-113"><a href="#cb32-113"></a>                                                      }                                                    </span>
<span id="cb32-114"><a href="#cb32-114"></a>  ))</span>
<span id="cb32-115"><a href="#cb32-115"></a></span>
<span id="cb32-116"><a href="#cb32-116"></a><span class="co"># Extract nodes (i.e. times) which connect to the 3rd strongest node</span></span>
<span id="cb32-117"><a href="#cb32-117"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-118"><a href="#cb32-118"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_3rd_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</span>
<span id="cb32-119"><a href="#cb32-119"></a>                                                      <span class="dt">.y =</span> tertiary_attractor_day,</span>
<span id="cb32-120"><a href="#cb32-120"></a>                                                      <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb32-121"><a href="#cb32-121"></a>                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-122"><a href="#cb32-122"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-123"><a href="#cb32-123"></a><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</span>
<span id="cb32-124"><a href="#cb32-124"></a>                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-125"><a href="#cb32-125"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </span>
<span id="cb32-126"><a href="#cb32-126"></a>                                                                          <span class="co">#.keep_all = TRUE</span></span>
<span id="cb32-127"><a href="#cb32-127"></a>                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-128"><a href="#cb32-128"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</span>
<span id="cb32-129"><a href="#cb32-129"></a>                                                      }</span>
<span id="cb32-130"><a href="#cb32-130"></a>                                                      )</span>
<span id="cb32-131"><a href="#cb32-131"></a>  )</span>
<span id="cb32-132"><a href="#cb32-132"></a></span>
<span id="cb32-133"><a href="#cb32-133"></a><span class="co"># Save as a variable</span></span>
<span id="cb32-134"><a href="#cb32-134"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-135"><a href="#cb32-135"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb32-136"><a href="#cb32-136"></a>                                                       <span class="dt">.y =</span> connecting_to_3rd_strongest,</span>
<span id="cb32-137"><a href="#cb32-137"></a>                                                       <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb32-138"><a href="#cb32-138"></a>                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb32-139"><a href="#cb32-139"></a>                                                                       <span class="dt">connecting_to_3rd_strongest =</span> </span>
<span id="cb32-140"><a href="#cb32-140"></a>                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb32-141"><a href="#cb32-141"></a>                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb32-142"><a href="#cb32-142"></a>                                                       }</span>
<span id="cb32-143"><a href="#cb32-143"></a>  ))</span>
<span id="cb32-144"><a href="#cb32-144"></a></span>
<span id="cb32-145"><a href="#cb32-145"></a></span>
<span id="cb32-146"><a href="#cb32-146"></a></span>
<span id="cb32-147"><a href="#cb32-147"></a><span class="co"># Get number of 4th maximally connected node, which doesn&#39;t connect to the 1st or second</span></span>
<span id="cb32-148"><a href="#cb32-148"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-149"><a href="#cb32-149"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">fourth_attractor_day =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> graph_from_adjacency,</span>
<span id="cb32-150"><a href="#cb32-150"></a>                                                      <span class="dt">..2 =</span> connecting_to_strongest,</span>
<span id="cb32-151"><a href="#cb32-151"></a>                                                      <span class="dt">..3 =</span> connecting_to_2nd_strongest,</span>
<span id="cb32-152"><a href="#cb32-152"></a>                                                      <span class="dt">..4 =</span> connecting_to_3rd_strongest),</span>
<span id="cb32-153"><a href="#cb32-153"></a>                                                      <span class="dt">.f =</span>  <span class="op">~</span>{</span>
<span id="cb32-154"><a href="#cb32-154"></a>                                                        <span class="kw">data.frame</span>(<span class="dt">degree =</span> igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>), </span>
<span id="cb32-155"><a href="#cb32-155"></a>                                                                   <span class="dt">time =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-156"><a href="#cb32-156"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">2</span>, </span>
<span id="cb32-157"><a href="#cb32-157"></a>                                                                        <span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">3</span>, </span>
<span id="cb32-158"><a href="#cb32-158"></a>                                                                        <span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-159"><a href="#cb32-159"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(degree)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-160"><a href="#cb32-160"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-161"><a href="#cb32-161"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(time)</span>
<span id="cb32-162"><a href="#cb32-162"></a>                                                      }                                                    </span>
<span id="cb32-163"><a href="#cb32-163"></a>  ))</span>
<span id="cb32-164"><a href="#cb32-164"></a></span>
<span id="cb32-165"><a href="#cb32-165"></a><span class="co"># Extract nodes (i.e. times) which connect to the 3rd strongest node</span></span>
<span id="cb32-166"><a href="#cb32-166"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-167"><a href="#cb32-167"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_4th_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</span>
<span id="cb32-168"><a href="#cb32-168"></a>                                                      <span class="dt">.y =</span> fourth_attractor_day,</span>
<span id="cb32-169"><a href="#cb32-169"></a>                                                      <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb32-170"><a href="#cb32-170"></a>                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-171"><a href="#cb32-171"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-172"><a href="#cb32-172"></a><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</span>
<span id="cb32-173"><a href="#cb32-173"></a>                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-174"><a href="#cb32-174"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </span>
<span id="cb32-175"><a href="#cb32-175"></a>                                                                          <span class="co">#.keep_all = TRUE</span></span>
<span id="cb32-176"><a href="#cb32-176"></a>                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-177"><a href="#cb32-177"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</span>
<span id="cb32-178"><a href="#cb32-178"></a>                                                      }</span>
<span id="cb32-179"><a href="#cb32-179"></a>                                                      )</span>
<span id="cb32-180"><a href="#cb32-180"></a>  )</span>
<span id="cb32-181"><a href="#cb32-181"></a></span>
<span id="cb32-182"><a href="#cb32-182"></a><span class="co"># Save as a variable</span></span>
<span id="cb32-183"><a href="#cb32-183"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-184"><a href="#cb32-184"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb32-185"><a href="#cb32-185"></a>                                                       <span class="dt">.y =</span> connecting_to_4th_strongest,</span>
<span id="cb32-186"><a href="#cb32-186"></a>                                                       <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb32-187"><a href="#cb32-187"></a>                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb32-188"><a href="#cb32-188"></a>                                                                       <span class="dt">connecting_to_4th_strongest =</span> </span>
<span id="cb32-189"><a href="#cb32-189"></a>                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb32-190"><a href="#cb32-190"></a>                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb32-191"><a href="#cb32-191"></a>                                                       }</span>
<span id="cb32-192"><a href="#cb32-192"></a>  ))</span>
<span id="cb32-193"><a href="#cb32-193"></a></span>
<span id="cb32-194"><a href="#cb32-194"></a><span class="co">################### Make plots</span></span>
<span id="cb32-195"><a href="#cb32-195"></a></span>
<span id="cb32-196"><a href="#cb32-196"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-197"><a href="#cb32-197"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> </span>
<span id="cb32-198"><a href="#cb32-198"></a>                  purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb32-199"><a href="#cb32-199"></a>                             <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb32-200"><a href="#cb32-200"></a>                               dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb32-201"><a href="#cb32-201"></a>                                             <span class="dt">attractors =</span> dplyr<span class="op">::</span><span class="kw">case_when</span>(</span>
<span id="cb32-202"><a href="#cb32-202"></a>                                               strength <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> &quot;Unique&quot;</span>,</span>
<span id="cb32-203"><a href="#cb32-203"></a>                                               connecting_to_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;1st&quot;</span>,</span>
<span id="cb32-204"><a href="#cb32-204"></a>                                               connecting_to_2nd_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;2nd&quot;</span>,</span>
<span id="cb32-205"><a href="#cb32-205"></a>                                               connecting_to_3rd_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;3rd&quot;</span>,</span>
<span id="cb32-206"><a href="#cb32-206"></a>                                               connecting_to_4th_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;4th&quot;</span>,</span>
<span id="cb32-207"><a href="#cb32-207"></a>                                               <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Uncategorised&quot;</span>),</span>
<span id="cb32-208"><a href="#cb32-208"></a>                                             <span class="dt">attractors =</span> <span class="kw">factor</span>(attractors,</span>
<span id="cb32-209"><a href="#cb32-209"></a>                                                                 <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;1st&quot;</span>,</span>
<span id="cb32-210"><a href="#cb32-210"></a>                                                                            <span class="st">&quot;2nd&quot;</span>,</span>
<span id="cb32-211"><a href="#cb32-211"></a>                                                                            <span class="st">&quot;3rd&quot;</span>,</span>
<span id="cb32-212"><a href="#cb32-212"></a>                                                                            <span class="st">&quot;4th&quot;</span>,</span>
<span id="cb32-213"><a href="#cb32-213"></a>                                                                            <span class="st">&quot;Uncategorised&quot;</span>,</span>
<span id="cb32-214"><a href="#cb32-214"></a>                                                                            <span class="st">&quot;Unique&quot;</span>)),</span>
<span id="cb32-215"><a href="#cb32-215"></a>                                             <span class="dt">name =</span> <span class="kw">factor</span>(name,</span>
<span id="cb32-216"><a href="#cb32-216"></a>                                                           <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;pleasure&quot;</span>,</span>
<span id="cb32-217"><a href="#cb32-217"></a>                                                                      <span class="st">&quot;interest&quot;</span>,</span>
<span id="cb32-218"><a href="#cb32-218"></a>                                                                      <span class="st">&quot;importance&quot;</span>,</span>
<span id="cb32-219"><a href="#cb32-219"></a>                                                                      <span class="st">&quot;situation_requires&quot;</span>,</span>
<span id="cb32-220"><a href="#cb32-220"></a>                                                                      <span class="st">&quot;anxiety_guilt_avoidance&quot;</span>,</span>
<span id="cb32-221"><a href="#cb32-221"></a>                                                                      <span class="st">&quot;another_wants&quot;</span>),</span>
<span id="cb32-222"><a href="#cb32-222"></a>                                                           <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Pleasure&quot;</span>,</span>
<span id="cb32-223"><a href="#cb32-223"></a>                                                                      <span class="st">&quot;Interest&quot;</span>,</span>
<span id="cb32-224"><a href="#cb32-224"></a>                                                                      <span class="st">&quot;Importance&quot;</span>,</span>
<span id="cb32-225"><a href="#cb32-225"></a>                                                                      <span class="st">&quot;Situation requires&quot;</span>,</span>
<span id="cb32-226"><a href="#cb32-226"></a>                                                                      <span class="st">&quot;Anxiety guilt avoidance&quot;</span>,</span>
<span id="cb32-227"><a href="#cb32-227"></a>                                                                      <span class="st">&quot;Another wants&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-228"><a href="#cb32-228"></a><span class="st">                                               </span>forcats<span class="op">::</span><span class="kw">fct_drop</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-229"><a href="#cb32-229"></a><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(attractors, name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-230"><a href="#cb32-230"></a><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-231"><a href="#cb32-231"></a><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb32-232"><a href="#cb32-232"></a><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">maxtime =</span> <span class="kw">max</span>(time),</span>
<span id="cb32-233"><a href="#cb32-233"></a>                                               <span class="dt">percentage_of_total =</span></span>
<span id="cb32-234"><a href="#cb32-234"></a>                                                 (n <span class="op">/</span><span class="st"> </span>maxtime) <span class="op">%&gt;%</span><span class="st"> </span>scales<span class="op">::</span><span class="kw">percent</span>(<span class="dt">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb32-235"><a href="#cb32-235"></a>                                               <span class="dt">proportion_of_total =</span> n<span class="op">/</span>maxtime,</span>
<span id="cb32-236"><a href="#cb32-236"></a>                                               <span class="dt">attractors_n =</span> </span>
<span id="cb32-237"><a href="#cb32-237"></a>                                                 <span class="kw">factor</span>(<span class="kw">paste0</span>(attractors,</span>
<span id="cb32-238"><a href="#cb32-238"></a>                                                               <span class="st">&quot; (n = &quot;</span>, n, <span class="st">&quot;; &quot;</span>, </span>
<span id="cb32-239"><a href="#cb32-239"></a>                                                               percentage_of_total, <span class="st">&quot;)&quot;</span>)))</span>
<span id="cb32-240"><a href="#cb32-240"></a>                             }</span>
<span id="cb32-241"><a href="#cb32-241"></a>                  ))</span></code></pre></div>
<div id="spiral-graph-with-colored-nodes-4" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">Spiral graph with colored nodes</h3>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">node_colors =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb33-3"><a href="#cb33-3"></a>                                         <span class="dt">.f =</span> <span class="op">~</span>{tidyr<span class="op">::</span><span class="kw">pivot_wider</span>(.x, <span class="dt">names_from =</span> name) <span class="op">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4"></a><span class="st">                                             </span>dplyr<span class="op">::</span><span class="kw">pull</span>(attractors)}))</span>
<span id="cb33-5"><a href="#cb33-5"></a></span>
<span id="cb33-6"><a href="#cb33-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets_nodes_plots)) {</span>
<span id="cb33-7"><a href="#cb33-7"></a><span class="kw">levels</span>(emadata_nested_wrangled_both_recnets_nodes_plots<span class="op">$</span>node_colors[[i]]) &lt;-<span class="st"> </span></span>
<span id="cb33-8"><a href="#cb33-8"></a><span class="st">  </span><span class="kw">c</span>(viridisLite<span class="op">::</span><span class="kw">plasma</span>(<span class="dv">4</span>, </span>
<span id="cb33-9"><a href="#cb33-9"></a>                      <span class="dt">end =</span> <span class="fl">0.8</span>, </span>
<span id="cb33-10"><a href="#cb33-10"></a>                      <span class="dt">direction =</span> <span class="dv">-1</span>), <span class="st">&quot;gray48&quot;</span>, <span class="st">&quot;white&quot;</span>)</span>
<span id="cb33-11"><a href="#cb33-11"></a>  }</span>
<span id="cb33-12"><a href="#cb33-12"></a></span>
<span id="cb33-13"><a href="#cb33-13"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-14"><a href="#cb33-14"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">spiralgraph_epochs =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> graph_from_adjacency,</span>
<span id="cb33-15"><a href="#cb33-15"></a>                                          <span class="dt">..2 =</span> node_colors,</span>
<span id="cb33-16"><a href="#cb33-16"></a>                                          <span class="dt">..3 =</span> User),</span>
<span id="cb33-17"><a href="#cb33-17"></a>                                     <span class="dt">.f =</span>  <span class="op">~</span>casnet<span class="op">::</span><span class="kw">make_spiral_graph</span>(<span class="dt">g =</span> ..<span class="dv">1</span>, </span>
<span id="cb33-18"><a href="#cb33-18"></a>                                                                      <span class="dt">arcs =</span> <span class="dv">4</span>, </span>
<span id="cb33-19"><a href="#cb33-19"></a>                                                                      <span class="co"># a = .1, </span></span>
<span id="cb33-20"><a href="#cb33-20"></a>                                                                      <span class="co"># b = 2, </span></span>
<span id="cb33-21"><a href="#cb33-21"></a>                                                                      <span class="dt">markTimeBy =</span> <span class="ot">TRUE</span>,</span>
<span id="cb33-22"><a href="#cb33-22"></a>                                                                      <span class="dt">markEpochsBy =</span> ..<span class="dv">2</span>,</span>
<span id="cb33-23"><a href="#cb33-23"></a>                                                                      <span class="dt">epochColours =</span> ..<span class="dv">2</span>,</span>
<span id="cb33-24"><a href="#cb33-24"></a>                                                                      <span class="dt">showEpochLegend =</span> <span class="ot">FALSE</span>,</span>
<span id="cb33-25"><a href="#cb33-25"></a>                                                                      <span class="dt">scaleEdgeSize =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">10</span>,</span>
<span id="cb33-26"><a href="#cb33-26"></a>                                                                      <span class="dt">scaleVertexSize =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">5</span>),</span>
<span id="cb33-27"><a href="#cb33-27"></a>                                                                      <span class="dt">showSizeLegend =</span> <span class="ot">FALSE</span>,</span>
<span id="cb33-28"><a href="#cb33-28"></a>                                                                      <span class="dt">sizeLabel =</span> <span class="st">&quot;Node strength&quot;</span>,</span>
<span id="cb33-29"><a href="#cb33-29"></a>                                                                      <span class="dt">type =</span> <span class="st">&quot;Euler&quot;</span>,</span>
<span id="cb33-30"><a href="#cb33-30"></a>                                                                      <span class="co"># alphaE = 0.1</span></span>
<span id="cb33-31"><a href="#cb33-31"></a>                                                                      <span class="co"># title = ..3</span></span>
<span id="cb33-32"><a href="#cb33-32"></a>                                     )))</span></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/unnamed-chunk-12-1.png" width="2100" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a></span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="co"># emadata_nested_wrangled_both_recnets_nodes_plots$spiralgraph_epochs[[1]] +</span></span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="co">#   theme(plot.margin=grid::unit(c(0,0,0,0), &quot;mm&quot;))</span></span>
<span id="cb34-4"><a href="#cb34-4"></a></span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="co"># ggsave(filename = &quot;./figures/recnetwork.png&quot;,</span></span>
<span id="cb34-6"><a href="#cb34-6"></a><span class="co">#        width = 7, </span></span>
<span id="cb34-7"><a href="#cb34-7"></a><span class="co">#        height = 7)</span></span>
<span id="cb34-8"><a href="#cb34-8"></a></span>
<span id="cb34-9"><a href="#cb34-9"></a><span class="co"># emadata_nested_wrangled_both_recnets_nodes_plots$all_nodes_with_strengths[[1]]</span></span></code></pre></div>
</div>
<div id="attractor-plot-4" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">Attractor plot</h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">observations =</span> purrr<span class="op">::</span><span class="kw">map_dbl</span>(<span class="dt">.x =</span> data_standardised,</span>
<span id="cb35-3"><a href="#cb35-3"></a>                                              <span class="dt">.f =</span> <span class="op">~</span><span class="kw">nrow</span>(.)))</span>
<span id="cb35-4"><a href="#cb35-4"></a></span>
<span id="cb35-5"><a href="#cb35-5"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span></span>
<span id="cb35-6"><a href="#cb35-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">observations_daily =</span> purrr<span class="op">::</span><span class="kw">map_dbl</span>(<span class="dt">.x =</span> data_daily,</span>
<span id="cb35-7"><a href="#cb35-7"></a>                                              <span class="dt">.f =</span> <span class="op">~</span><span class="kw">nrow</span>(.)))</span>
<span id="cb35-8"><a href="#cb35-8"></a></span>
<span id="cb35-9"><a href="#cb35-9"></a></span>
<span id="cb35-10"><a href="#cb35-10"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-11"><a href="#cb35-11"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(</span>
<span id="cb35-12"><a href="#cb35-12"></a>    <span class="dt">attractor_plots =</span> </span>
<span id="cb35-13"><a href="#cb35-13"></a>      purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> all_nodes_with_strengths,</span>
<span id="cb35-14"><a href="#cb35-14"></a>                       <span class="dt">..2 =</span> observations,</span>
<span id="cb35-15"><a href="#cb35-15"></a>                       <span class="dt">..3 =</span> observations_daily,</span>
<span id="cb35-16"><a href="#cb35-16"></a>                       <span class="dt">..4 =</span> User),</span>
<span id="cb35-17"><a href="#cb35-17"></a>                  <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb35-18"><a href="#cb35-18"></a>                    dplyr<span class="op">::</span><span class="kw">mutate</span>(..<span class="dv">1</span>,</span>
<span id="cb35-19"><a href="#cb35-19"></a>                                  <span class="dt">strength_rescaled =</span> </span>
<span id="cb35-20"><a href="#cb35-20"></a>                                    scales<span class="op">::</span><span class="kw">rescale</span>(strength, <span class="dt">to =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">1.1</span>)),</span>
<span id="cb35-21"><a href="#cb35-21"></a>                                  <span class="dt">alpha_strength =</span> <span class="kw">ifelse</span>(strength_rescaled <span class="op">==</span><span class="st"> </span><span class="fl">0.3</span>, </span>
<span id="cb35-22"><a href="#cb35-22"></a>                                                          <span class="fl">0.5</span>, </span>
<span id="cb35-23"><a href="#cb35-23"></a>                                                          strength_rescaled)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-24"><a href="#cb35-24"></a><span class="st">                      </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</span>
<span id="cb35-25"><a href="#cb35-25"></a>                             <span class="kw">aes</span>(<span class="dt">x =</span> forcats<span class="op">::</span><span class="kw">fct_rev</span>(name), </span>
<span id="cb35-26"><a href="#cb35-26"></a>                                 <span class="dt">y =</span> value, </span>
<span id="cb35-27"><a href="#cb35-27"></a>                                 <span class="dt">size =</span> strength_rescaled,</span>
<span id="cb35-28"><a href="#cb35-28"></a>                                 <span class="dt">alpha =</span> alpha_strength,</span>
<span id="cb35-29"><a href="#cb35-29"></a>                                 <span class="dt">color =</span> attractors_n)) <span class="op">+</span></span>
<span id="cb35-30"><a href="#cb35-30"></a><span class="st">                      </span><span class="kw">scale_size_identity</span>() <span class="op">+</span></span>
<span id="cb35-31"><a href="#cb35-31"></a><span class="st">                      </span><span class="kw">scale_alpha_identity</span>() <span class="op">+</span></span>
<span id="cb35-32"><a href="#cb35-32"></a><span class="st">                      </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">alpha =</span> alpha_strength)) <span class="op">+</span></span>
<span id="cb35-33"><a href="#cb35-33"></a><span class="st">                      </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> time,</span>
<span id="cb35-34"><a href="#cb35-34"></a>                                    <span class="dt">alpha =</span> alpha_strength)) <span class="op">+</span></span>
<span id="cb35-35"><a href="#cb35-35"></a><span class="st">                      </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(viridisLite<span class="op">::</span><span class="kw">plasma</span>(<span class="dv">4</span>, </span>
<span id="cb35-36"><a href="#cb35-36"></a>                                                                        <span class="dt">end =</span> <span class="fl">0.8</span>, </span>
<span id="cb35-37"><a href="#cb35-37"></a>                                                                        <span class="dt">direction =</span> <span class="dv">-1</span>), </span>
<span id="cb35-38"><a href="#cb35-38"></a>                                                    <span class="st">&quot;gray40&quot;</span>, <span class="st">&quot;gray50&quot;</span>)) <span class="op">+</span></span>
<span id="cb35-39"><a href="#cb35-39"></a><span class="st">                      </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">label_percent</span>(<span class="dt">accuracy =</span> <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb35-40"><a href="#cb35-40"></a><span class="st">                      </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb35-41"><a href="#cb35-41"></a><span class="st">                      </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb35-42"><a href="#cb35-42"></a><span class="st">                      </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Percentage of maximum reported value of variable, across full time series&quot;</span>,</span>
<span id="cb35-43"><a href="#cb35-43"></a>                           <span class="dt">x =</span> <span class="ot">NULL</span>,</span>
<span id="cb35-44"><a href="#cb35-44"></a>                           <span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&quot;Participant </span><span class="ch">\&quot;</span><span class="st">&quot;</span>, ..<span class="dv">4</span>, <span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st"> - based on &quot;</span>, ..<span class="dv">2</span>, <span class="st">&quot; data points (&quot;</span>, ..<span class="dv">3</span>, <span class="st">&quot; days)&quot;</span>)) <span class="op">+</span></span>
<span id="cb35-45"><a href="#cb35-45"></a><span class="st">                      </span><span class="kw">facet_wrap</span>(<span class="op">~</span>attractors_n) <span class="op">+</span></span>
<span id="cb35-46"><a href="#cb35-46"></a><span class="st">                      </span><span class="kw">coord_flip</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb35-47"><a href="#cb35-47"></a>                  }</span>
<span id="cb35-48"><a href="#cb35-48"></a>      ))</span>
<span id="cb35-49"><a href="#cb35-49"></a></span>
<span id="cb35-50"><a href="#cb35-50"></a>emadata_nested_wrangled_both_recnets_nodes_plots<span class="op">$</span>attractor_plots[[<span class="dv">1</span>]]</span></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/attractor-plots_alldata-1.png" width="2100" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co"># emadata_nested_wrangled_both_recnets_nodes_plots$all_nodes_with_strengths[[1]]</span></span></code></pre></div>
</div>
</div>
<div id="task-normed-data" class="section level2 unlisted unnumbered">
<h2 class="unlisted unnumbered">Task-normed data</h2>
<p>Here’s the 6-dimensional motivation system’s recurrence plot, weighted by similarity.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb37-2"><a href="#cb37-2"></a></span>
<span id="cb37-3"><a href="#cb37-3"></a><span class="co">#######################</span></span>
<span id="cb37-4"><a href="#cb37-4"></a></span>
<span id="cb37-5"><a href="#cb37-5"></a><span class="co"># si = similarity under the radius</span></span>
<span id="cb37-6"><a href="#cb37-6"></a>emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb37-7"><a href="#cb37-7"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">RN =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> taskNormed_standardised,</span>
<span id="cb37-8"><a href="#cb37-8"></a>                                <span class="dt">.f =</span>  <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rn</span>(.x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="co">#autonomy, competence, relatedness,</span></span>
<span id="cb37-9"><a href="#cb37-9"></a>                                                                       pleasure, interest, importance,</span>
<span id="cb37-10"><a href="#cb37-10"></a>                                                                       situation_requires, </span>
<span id="cb37-11"><a href="#cb37-11"></a>                                                                       anxiety_guilt_avoidance, </span>
<span id="cb37-12"><a href="#cb37-12"></a>                                                                       another_wants), </span>
<span id="cb37-13"><a href="#cb37-13"></a>                                                  <span class="dt">doEmbed =</span> <span class="ot">FALSE</span>, </span>
<span id="cb37-14"><a href="#cb37-14"></a>                                                  <span class="dt">weighted =</span> <span class="ot">TRUE</span>, </span>
<span id="cb37-15"><a href="#cb37-15"></a>                                                  <span class="dt">weightedBy =</span> <span class="st">&quot;si&quot;</span>, </span>
<span id="cb37-16"><a href="#cb37-16"></a>                                                  <span class="dt">emRad =</span> <span class="ot">NA</span>)))</span>
<span id="cb37-17"><a href="#cb37-17"></a><span class="co">## </span></span>
<span id="cb37-18"><a href="#cb37-18"></a><span class="co">## Auto-recurrence: Setting diagonal to (1 + max. distance) for analyses</span></span>
<span id="cb37-19"><a href="#cb37-19"></a><span class="co">## </span></span>
<span id="cb37-20"><a href="#cb37-20"></a><span class="co">## Searching for a radius that will yield 0.05 for RR</span></span>
<span id="cb37-21"><a href="#cb37-21"></a></span>
<span id="cb37-22"><a href="#cb37-22"></a>emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb37-23"><a href="#cb37-23"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">graph_from_adjacency =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> RN,</span>
<span id="cb37-24"><a href="#cb37-24"></a>                                                  <span class="dt">.f =</span> <span class="op">~</span>igraph<span class="op">::</span><span class="kw">graph_from_adjacency_matrix</span>(.x, </span>
<span id="cb37-25"><a href="#cb37-25"></a>                                                                                            <span class="dt">weighted =</span> <span class="ot">TRUE</span>, </span>
<span id="cb37-26"><a href="#cb37-26"></a>                                                                                            <span class="dt">mode =</span> <span class="st">&quot;upper&quot;</span>, </span>
<span id="cb37-27"><a href="#cb37-27"></a>                                                                                            <span class="dt">diag =</span> <span class="ot">FALSE</span>)))</span>
<span id="cb37-28"><a href="#cb37-28"></a></span>
<span id="cb37-29"><a href="#cb37-29"></a><span class="co"># Edges with their distances</span></span>
<span id="cb37-30"><a href="#cb37-30"></a>emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb37-31"><a href="#cb37-31"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">edges_with_distances =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> graph_from_adjacency,</span>
<span id="cb37-32"><a href="#cb37-32"></a>                                                  <span class="dt">.f =</span> <span class="op">~</span>igraph<span class="op">::</span><span class="kw">E</span>(.x)<span class="op">$</span>weight),</span>
<span id="cb37-33"><a href="#cb37-33"></a>                <span class="dt">graph_from_adjacency_orig =</span> graph_from_adjacency)</span>
<span id="cb37-34"><a href="#cb37-34"></a></span>
<span id="cb37-35"><a href="#cb37-35"></a><span class="co"># Larger values are closer to the state; inverse of weight makes it more intuitive</span></span>
<span id="cb37-36"><a href="#cb37-36"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets)) {</span>
<span id="cb37-37"><a href="#cb37-37"></a>igraph<span class="op">::</span><span class="kw">E</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>weight &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>emadata_nested_wrangled_both_recnets<span class="op">$</span>edges_with_distances[[i]])</span>
<span id="cb37-38"><a href="#cb37-38"></a>}</span>
<span id="cb37-39"><a href="#cb37-39"></a><span class="co"># A later note to self: Now weight is a measure of distance; how far apart two time points are</span></span>
<span id="cb37-40"><a href="#cb37-40"></a><span class="co"># (under the radius, i.e. they&#39;re reasonably similar to begin with)</span></span>
<span id="cb37-41"><a href="#cb37-41"></a></span>
<span id="cb37-42"><a href="#cb37-42"></a><span class="co">####### To check:</span></span>
<span id="cb37-43"><a href="#cb37-43"></a><span class="co"># igraph::E(emadata_nested_wrangled_both_recnets$graph_from_adjacency[[1]])$weight</span></span>
<span id="cb37-44"><a href="#cb37-44"></a><span class="co"># igraph::E(emadata_nested_wrangled_both_recnets$graph_from_adjacency_orig[[1]])$weight</span></span>
<span id="cb37-45"><a href="#cb37-45"></a></span>
<span id="cb37-46"><a href="#cb37-46"></a>emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb37-47"><a href="#cb37-47"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">RN_plot =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> RN,</span>
<span id="cb37-48"><a href="#cb37-48"></a>                                <span class="dt">.f =</span>  <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rn_plot</span>(.x,</span>
<span id="cb37-49"><a href="#cb37-49"></a>                                                       <span class="dt">plotDimensions =</span> <span class="ot">TRUE</span>,</span>
<span id="cb37-50"><a href="#cb37-50"></a>                                                       <span class="dt">xlab =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>,</span>
<span id="cb37-51"><a href="#cb37-51"></a>                                                       <span class="dt">ylab =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>)))</span></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/unnamed-chunk-13-1.png" width="2100" /></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a></span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="co"># Make node size equal to strength. Strength is the sum of a node&#39;s edge weights.</span></span>
<span id="cb38-3"><a href="#cb38-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets)) {</span>
<span id="cb38-4"><a href="#cb38-4"></a>igraph<span class="op">::</span><span class="kw">V</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>size &lt;-<span class="st"> </span>(igraph<span class="op">::</span><span class="kw">strength</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]]))</span>
<span id="cb38-5"><a href="#cb38-5"></a>}</span>
<span id="cb38-6"><a href="#cb38-6"></a></span>
<span id="cb38-7"><a href="#cb38-7"></a><span class="co"># Rescaling weight as &quot;width&quot;; varies between 5 and 10</span></span>
<span id="cb38-8"><a href="#cb38-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets)) {</span>
<span id="cb38-9"><a href="#cb38-9"></a>igraph<span class="op">::</span><span class="kw">E</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>width &lt;-<span class="st"> </span></span>
<span id="cb38-10"><a href="#cb38-10"></a><span class="st">  </span>casnet<span class="op">::</span><span class="kw">elascer</span>(igraph<span class="op">::</span><span class="kw">E</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>weight, <span class="dt">lo =</span> <span class="dv">5</span>, <span class="dt">hi =</span> <span class="dv">10</span>)</span>
<span id="cb38-11"><a href="#cb38-11"></a>}</span></code></pre></div>
<p>The lengthy code chunk below extracts and marks attractors in the data.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># Get number of maximally connected node</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">max_connected_day =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> graph_from_adjacency,</span>
<span id="cb39-4"><a href="#cb39-4"></a>                                     <span class="dt">.f =</span>  <span class="op">~</span><span class="kw">which.max</span>(igraph<span class="op">::</span><span class="kw">degree</span>(.x))</span>
<span id="cb39-5"><a href="#cb39-5"></a>                                     ))</span>
<span id="cb39-6"><a href="#cb39-6"></a></span>
<span id="cb39-7"><a href="#cb39-7"></a></span>
<span id="cb39-8"><a href="#cb39-8"></a></span>
<span id="cb39-9"><a href="#cb39-9"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-10"><a href="#cb39-10"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">list_of_edges =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> graph_from_adjacency,</span>
<span id="cb39-11"><a href="#cb39-11"></a>                                     <span class="dt">.f =</span>  <span class="op">~</span>igraph<span class="op">::</span><span class="kw">get.data.frame</span>(.x)</span>
<span id="cb39-12"><a href="#cb39-12"></a>                                     ))</span>
<span id="cb39-13"><a href="#cb39-13"></a></span>
<span id="cb39-14"><a href="#cb39-14"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-15"><a href="#cb39-15"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> </span>
<span id="cb39-16"><a href="#cb39-16"></a>                  purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> taskNormed_standardised,</span>
<span id="cb39-17"><a href="#cb39-17"></a>                              <span class="dt">.y =</span> graph_from_adjacency,</span>
<span id="cb39-18"><a href="#cb39-18"></a>                              <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb39-19"><a href="#cb39-19"></a>                                <span class="kw">data.frame</span>(.x <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-20"><a href="#cb39-20"></a><span class="st">                                             </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="co">#autonomy, competence, relatedness,</span></span>
<span id="cb39-21"><a href="#cb39-21"></a>                                                                       pleasure, interest, importance,</span>
<span id="cb39-22"><a href="#cb39-22"></a>                                                                       situation_requires, anxiety_guilt_avoidance, another_wants), </span>
<span id="cb39-23"><a href="#cb39-23"></a>                                           <span class="dt">strength =</span> igraph<span class="op">::</span><span class="kw">strength</span>(.y)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-24"><a href="#cb39-24"></a><span class="st">                                  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">time =</span> dplyr<span class="op">::</span><span class="kw">row_number</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-25"><a href="#cb39-25"></a><span class="st">                                  </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(<span class="op">-</span>strength, <span class="op">-</span>time))</span>
<span id="cb39-26"><a href="#cb39-26"></a>                              }</span>
<span id="cb39-27"><a href="#cb39-27"></a>  ))</span>
<span id="cb39-28"><a href="#cb39-28"></a></span>
<span id="cb39-29"><a href="#cb39-29"></a><span class="co"># Extract nodes (i.e. times) which connect to the strongest (i.e. most connected) node</span></span>
<span id="cb39-30"><a href="#cb39-30"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-31"><a href="#cb39-31"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</span>
<span id="cb39-32"><a href="#cb39-32"></a>                                                      <span class="dt">.y =</span> max_connected_day,</span>
<span id="cb39-33"><a href="#cb39-33"></a>                                                      <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb39-34"><a href="#cb39-34"></a>                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-35"><a href="#cb39-35"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-36"><a href="#cb39-36"></a><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</span>
<span id="cb39-37"><a href="#cb39-37"></a>                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-38"><a href="#cb39-38"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </span>
<span id="cb39-39"><a href="#cb39-39"></a>                                                                          <span class="co">#.keep_all = TRUE</span></span>
<span id="cb39-40"><a href="#cb39-40"></a>                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-41"><a href="#cb39-41"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</span>
<span id="cb39-42"><a href="#cb39-42"></a>                                                      }</span>
<span id="cb39-43"><a href="#cb39-43"></a>                                                      )</span>
<span id="cb39-44"><a href="#cb39-44"></a>  )</span>
<span id="cb39-45"><a href="#cb39-45"></a></span>
<span id="cb39-46"><a href="#cb39-46"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-47"><a href="#cb39-47"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb39-48"><a href="#cb39-48"></a>                                                       <span class="dt">.y =</span> connecting_to_strongest,</span>
<span id="cb39-49"><a href="#cb39-49"></a>                                                       <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb39-50"><a href="#cb39-50"></a>                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb39-51"><a href="#cb39-51"></a>                                                                       <span class="dt">connecting_to_strongest =</span> </span>
<span id="cb39-52"><a href="#cb39-52"></a>                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb39-53"><a href="#cb39-53"></a>                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb39-54"><a href="#cb39-54"></a>                                                       }</span>
<span id="cb39-55"><a href="#cb39-55"></a>  ))</span>
<span id="cb39-56"><a href="#cb39-56"></a></span>
<span id="cb39-57"><a href="#cb39-57"></a><span class="co"># Get number of 2nd maximally connected node, which doesn&#39;t connect to the 1st</span></span>
<span id="cb39-58"><a href="#cb39-58"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-59"><a href="#cb39-59"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">secondary_attractor_day =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> graph_from_adjacency,</span>
<span id="cb39-60"><a href="#cb39-60"></a>                                                      <span class="dt">.y =</span> connecting_to_strongest,</span>
<span id="cb39-61"><a href="#cb39-61"></a>                                                      <span class="dt">.f =</span>  <span class="op">~</span>{</span>
<span id="cb39-62"><a href="#cb39-62"></a>                                                        <span class="kw">data.frame</span>(<span class="dt">degree =</span> igraph<span class="op">::</span><span class="kw">degree</span>(.x), </span>
<span id="cb39-63"><a href="#cb39-63"></a>                                                                   <span class="dt">time =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(igraph<span class="op">::</span><span class="kw">degree</span>(.x))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-64"><a href="#cb39-64"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-65"><a href="#cb39-65"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(degree)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-66"><a href="#cb39-66"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-67"><a href="#cb39-67"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(time)</span>
<span id="cb39-68"><a href="#cb39-68"></a>                                                      }                                                    </span>
<span id="cb39-69"><a href="#cb39-69"></a>  ))</span>
<span id="cb39-70"><a href="#cb39-70"></a></span>
<span id="cb39-71"><a href="#cb39-71"></a><span class="co"># Extract nodes (i.e. times) which connect to the 2nd strongest node, which doesn&#39;t connect to the 1st</span></span>
<span id="cb39-72"><a href="#cb39-72"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-73"><a href="#cb39-73"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_2nd_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</span>
<span id="cb39-74"><a href="#cb39-74"></a>                                                      <span class="dt">.y =</span> secondary_attractor_day,</span>
<span id="cb39-75"><a href="#cb39-75"></a>                                                      <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb39-76"><a href="#cb39-76"></a>                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-77"><a href="#cb39-77"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-78"><a href="#cb39-78"></a><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</span>
<span id="cb39-79"><a href="#cb39-79"></a>                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-80"><a href="#cb39-80"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </span>
<span id="cb39-81"><a href="#cb39-81"></a>                                                                          <span class="co">#.keep_all = TRUE</span></span>
<span id="cb39-82"><a href="#cb39-82"></a>                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-83"><a href="#cb39-83"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</span>
<span id="cb39-84"><a href="#cb39-84"></a>                                                      }</span>
<span id="cb39-85"><a href="#cb39-85"></a>                                                      )</span>
<span id="cb39-86"><a href="#cb39-86"></a>  )</span>
<span id="cb39-87"><a href="#cb39-87"></a></span>
<span id="cb39-88"><a href="#cb39-88"></a><span class="co"># Save as a variable in the dataset</span></span>
<span id="cb39-89"><a href="#cb39-89"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-90"><a href="#cb39-90"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb39-91"><a href="#cb39-91"></a>                                                       <span class="dt">.y =</span> connecting_to_2nd_strongest,</span>
<span id="cb39-92"><a href="#cb39-92"></a>                                                       <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb39-93"><a href="#cb39-93"></a>                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb39-94"><a href="#cb39-94"></a>                                                                       <span class="dt">connecting_to_2nd_strongest =</span> </span>
<span id="cb39-95"><a href="#cb39-95"></a>                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb39-96"><a href="#cb39-96"></a>                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb39-97"><a href="#cb39-97"></a>                                                       }</span>
<span id="cb39-98"><a href="#cb39-98"></a>  ))</span>
<span id="cb39-99"><a href="#cb39-99"></a></span>
<span id="cb39-100"><a href="#cb39-100"></a><span class="co"># Get number of 3rd maximally connected node, which doesn&#39;t connect to the 1st or second</span></span>
<span id="cb39-101"><a href="#cb39-101"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-102"><a href="#cb39-102"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">tertiary_attractor_day =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> graph_from_adjacency,</span>
<span id="cb39-103"><a href="#cb39-103"></a>                                                      <span class="dt">..2 =</span> connecting_to_strongest,</span>
<span id="cb39-104"><a href="#cb39-104"></a>                                                      <span class="dt">..3 =</span> connecting_to_2nd_strongest),</span>
<span id="cb39-105"><a href="#cb39-105"></a>                                                      <span class="dt">.f =</span>  <span class="op">~</span>{</span>
<span id="cb39-106"><a href="#cb39-106"></a>                                                        <span class="kw">data.frame</span>(<span class="dt">degree =</span> igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>), </span>
<span id="cb39-107"><a href="#cb39-107"></a>                                                                   <span class="dt">time =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-108"><a href="#cb39-108"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">2</span>, </span>
<span id="cb39-109"><a href="#cb39-109"></a>                                                                        <span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-110"><a href="#cb39-110"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(degree)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-111"><a href="#cb39-111"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-112"><a href="#cb39-112"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(time)</span>
<span id="cb39-113"><a href="#cb39-113"></a>                                                      }                                                    </span>
<span id="cb39-114"><a href="#cb39-114"></a>  ))</span>
<span id="cb39-115"><a href="#cb39-115"></a></span>
<span id="cb39-116"><a href="#cb39-116"></a><span class="co"># Extract nodes (i.e. times) which connect to the 3rd strongest node</span></span>
<span id="cb39-117"><a href="#cb39-117"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-118"><a href="#cb39-118"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_3rd_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</span>
<span id="cb39-119"><a href="#cb39-119"></a>                                                      <span class="dt">.y =</span> tertiary_attractor_day,</span>
<span id="cb39-120"><a href="#cb39-120"></a>                                                      <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb39-121"><a href="#cb39-121"></a>                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-122"><a href="#cb39-122"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-123"><a href="#cb39-123"></a><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</span>
<span id="cb39-124"><a href="#cb39-124"></a>                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-125"><a href="#cb39-125"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </span>
<span id="cb39-126"><a href="#cb39-126"></a>                                                                          <span class="co">#.keep_all = TRUE</span></span>
<span id="cb39-127"><a href="#cb39-127"></a>                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-128"><a href="#cb39-128"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</span>
<span id="cb39-129"><a href="#cb39-129"></a>                                                      }</span>
<span id="cb39-130"><a href="#cb39-130"></a>                                                      )</span>
<span id="cb39-131"><a href="#cb39-131"></a>  )</span>
<span id="cb39-132"><a href="#cb39-132"></a></span>
<span id="cb39-133"><a href="#cb39-133"></a><span class="co"># Save as a variable</span></span>
<span id="cb39-134"><a href="#cb39-134"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-135"><a href="#cb39-135"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb39-136"><a href="#cb39-136"></a>                                                       <span class="dt">.y =</span> connecting_to_3rd_strongest,</span>
<span id="cb39-137"><a href="#cb39-137"></a>                                                       <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb39-138"><a href="#cb39-138"></a>                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb39-139"><a href="#cb39-139"></a>                                                                       <span class="dt">connecting_to_3rd_strongest =</span> </span>
<span id="cb39-140"><a href="#cb39-140"></a>                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb39-141"><a href="#cb39-141"></a>                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb39-142"><a href="#cb39-142"></a>                                                       }</span>
<span id="cb39-143"><a href="#cb39-143"></a>  ))</span>
<span id="cb39-144"><a href="#cb39-144"></a></span>
<span id="cb39-145"><a href="#cb39-145"></a></span>
<span id="cb39-146"><a href="#cb39-146"></a></span>
<span id="cb39-147"><a href="#cb39-147"></a><span class="co"># Get number of 4th maximally connected node, which doesn&#39;t connect to the 1st or second</span></span>
<span id="cb39-148"><a href="#cb39-148"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-149"><a href="#cb39-149"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">fourth_attractor_day =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> graph_from_adjacency,</span>
<span id="cb39-150"><a href="#cb39-150"></a>                                                      <span class="dt">..2 =</span> connecting_to_strongest,</span>
<span id="cb39-151"><a href="#cb39-151"></a>                                                      <span class="dt">..3 =</span> connecting_to_2nd_strongest,</span>
<span id="cb39-152"><a href="#cb39-152"></a>                                                      <span class="dt">..4 =</span> connecting_to_3rd_strongest),</span>
<span id="cb39-153"><a href="#cb39-153"></a>                                                      <span class="dt">.f =</span>  <span class="op">~</span>{</span>
<span id="cb39-154"><a href="#cb39-154"></a>                                                        <span class="kw">data.frame</span>(<span class="dt">degree =</span> igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>), </span>
<span id="cb39-155"><a href="#cb39-155"></a>                                                                   <span class="dt">time =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-156"><a href="#cb39-156"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">2</span>, </span>
<span id="cb39-157"><a href="#cb39-157"></a>                                                                        <span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">3</span>, </span>
<span id="cb39-158"><a href="#cb39-158"></a>                                                                        <span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-159"><a href="#cb39-159"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(degree)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-160"><a href="#cb39-160"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-161"><a href="#cb39-161"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(time)</span>
<span id="cb39-162"><a href="#cb39-162"></a>                                                      }                                                    </span>
<span id="cb39-163"><a href="#cb39-163"></a>  ))</span>
<span id="cb39-164"><a href="#cb39-164"></a></span>
<span id="cb39-165"><a href="#cb39-165"></a><span class="co"># Extract nodes (i.e. times) which connect to the 3rd strongest node</span></span>
<span id="cb39-166"><a href="#cb39-166"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-167"><a href="#cb39-167"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_4th_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</span>
<span id="cb39-168"><a href="#cb39-168"></a>                                                      <span class="dt">.y =</span> fourth_attractor_day,</span>
<span id="cb39-169"><a href="#cb39-169"></a>                                                      <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb39-170"><a href="#cb39-170"></a>                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-171"><a href="#cb39-171"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-172"><a href="#cb39-172"></a><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</span>
<span id="cb39-173"><a href="#cb39-173"></a>                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-174"><a href="#cb39-174"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </span>
<span id="cb39-175"><a href="#cb39-175"></a>                                                                          <span class="co">#.keep_all = TRUE</span></span>
<span id="cb39-176"><a href="#cb39-176"></a>                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-177"><a href="#cb39-177"></a><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</span>
<span id="cb39-178"><a href="#cb39-178"></a>                                                      }</span>
<span id="cb39-179"><a href="#cb39-179"></a>                                                      )</span>
<span id="cb39-180"><a href="#cb39-180"></a>  )</span>
<span id="cb39-181"><a href="#cb39-181"></a></span>
<span id="cb39-182"><a href="#cb39-182"></a><span class="co"># Save as a variable</span></span>
<span id="cb39-183"><a href="#cb39-183"></a>emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-184"><a href="#cb39-184"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb39-185"><a href="#cb39-185"></a>                                                       <span class="dt">.y =</span> connecting_to_4th_strongest,</span>
<span id="cb39-186"><a href="#cb39-186"></a>                                                       <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb39-187"><a href="#cb39-187"></a>                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb39-188"><a href="#cb39-188"></a>                                                                       <span class="dt">connecting_to_4th_strongest =</span> </span>
<span id="cb39-189"><a href="#cb39-189"></a>                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb39-190"><a href="#cb39-190"></a>                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</span>
<span id="cb39-191"><a href="#cb39-191"></a>                                                       }</span>
<span id="cb39-192"><a href="#cb39-192"></a>  ))</span>
<span id="cb39-193"><a href="#cb39-193"></a></span>
<span id="cb39-194"><a href="#cb39-194"></a><span class="co">################### Make plots</span></span>
<span id="cb39-195"><a href="#cb39-195"></a></span>
<span id="cb39-196"><a href="#cb39-196"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-197"><a href="#cb39-197"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> </span>
<span id="cb39-198"><a href="#cb39-198"></a>                  purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb39-199"><a href="#cb39-199"></a>                             <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb39-200"><a href="#cb39-200"></a>                               dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</span>
<span id="cb39-201"><a href="#cb39-201"></a>                                             <span class="dt">attractors =</span> dplyr<span class="op">::</span><span class="kw">case_when</span>(</span>
<span id="cb39-202"><a href="#cb39-202"></a>                                               strength <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> &quot;Unique&quot;</span>,</span>
<span id="cb39-203"><a href="#cb39-203"></a>                                               connecting_to_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;1st&quot;</span>,</span>
<span id="cb39-204"><a href="#cb39-204"></a>                                               connecting_to_2nd_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;2nd&quot;</span>,</span>
<span id="cb39-205"><a href="#cb39-205"></a>                                               connecting_to_3rd_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;3rd&quot;</span>,</span>
<span id="cb39-206"><a href="#cb39-206"></a>                                               connecting_to_4th_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;4th&quot;</span>,</span>
<span id="cb39-207"><a href="#cb39-207"></a>                                               <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Uncategorised&quot;</span>),</span>
<span id="cb39-208"><a href="#cb39-208"></a>                                             <span class="dt">attractors =</span> <span class="kw">factor</span>(attractors,</span>
<span id="cb39-209"><a href="#cb39-209"></a>                                                                 <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;1st&quot;</span>,</span>
<span id="cb39-210"><a href="#cb39-210"></a>                                                                            <span class="st">&quot;2nd&quot;</span>,</span>
<span id="cb39-211"><a href="#cb39-211"></a>                                                                            <span class="st">&quot;3rd&quot;</span>,</span>
<span id="cb39-212"><a href="#cb39-212"></a>                                                                            <span class="st">&quot;4th&quot;</span>,</span>
<span id="cb39-213"><a href="#cb39-213"></a>                                                                            <span class="st">&quot;Uncategorised&quot;</span>,</span>
<span id="cb39-214"><a href="#cb39-214"></a>                                                                            <span class="st">&quot;Unique&quot;</span>)),</span>
<span id="cb39-215"><a href="#cb39-215"></a>                                             <span class="dt">name =</span> <span class="kw">factor</span>(name,</span>
<span id="cb39-216"><a href="#cb39-216"></a>                                                           <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;pleasure&quot;</span>,</span>
<span id="cb39-217"><a href="#cb39-217"></a>                                                                      <span class="st">&quot;interest&quot;</span>,</span>
<span id="cb39-218"><a href="#cb39-218"></a>                                                                      <span class="st">&quot;importance&quot;</span>,</span>
<span id="cb39-219"><a href="#cb39-219"></a>                                                                      <span class="st">&quot;situation_requires&quot;</span>,</span>
<span id="cb39-220"><a href="#cb39-220"></a>                                                                      <span class="st">&quot;anxiety_guilt_avoidance&quot;</span>,</span>
<span id="cb39-221"><a href="#cb39-221"></a>                                                                      <span class="st">&quot;another_wants&quot;</span>),</span>
<span id="cb39-222"><a href="#cb39-222"></a>                                                           <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Pleasure&quot;</span>,</span>
<span id="cb39-223"><a href="#cb39-223"></a>                                                                      <span class="st">&quot;Interest&quot;</span>,</span>
<span id="cb39-224"><a href="#cb39-224"></a>                                                                      <span class="st">&quot;Importance&quot;</span>,</span>
<span id="cb39-225"><a href="#cb39-225"></a>                                                                      <span class="st">&quot;Situation requires&quot;</span>,</span>
<span id="cb39-226"><a href="#cb39-226"></a>                                                                      <span class="st">&quot;Anxiety guilt avoidance&quot;</span>,</span>
<span id="cb39-227"><a href="#cb39-227"></a>                                                                      <span class="st">&quot;Another wants&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-228"><a href="#cb39-228"></a><span class="st">                                               </span>forcats<span class="op">::</span><span class="kw">fct_drop</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-229"><a href="#cb39-229"></a><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(attractors, name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-230"><a href="#cb39-230"></a><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-231"><a href="#cb39-231"></a><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb39-232"><a href="#cb39-232"></a><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">maxtime =</span> <span class="kw">max</span>(time),</span>
<span id="cb39-233"><a href="#cb39-233"></a>                                               <span class="dt">percentage_of_total =</span></span>
<span id="cb39-234"><a href="#cb39-234"></a>                                                 (n <span class="op">/</span><span class="st"> </span>maxtime) <span class="op">%&gt;%</span><span class="st"> </span>scales<span class="op">::</span><span class="kw">percent</span>(<span class="dt">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb39-235"><a href="#cb39-235"></a>                                               <span class="dt">proportion_of_total =</span> n<span class="op">/</span>maxtime,</span>
<span id="cb39-236"><a href="#cb39-236"></a>                                               <span class="dt">attractors_n =</span> </span>
<span id="cb39-237"><a href="#cb39-237"></a>                                                 <span class="kw">factor</span>(<span class="kw">paste0</span>(attractors,</span>
<span id="cb39-238"><a href="#cb39-238"></a>                                                               <span class="st">&quot; (n = &quot;</span>, n, <span class="st">&quot;; &quot;</span>, </span>
<span id="cb39-239"><a href="#cb39-239"></a>                                                               percentage_of_total, <span class="st">&quot;)&quot;</span>)))</span>
<span id="cb39-240"><a href="#cb39-240"></a>                             }</span>
<span id="cb39-241"><a href="#cb39-241"></a>                  ))</span></code></pre></div>
<div id="spiral-graph-with-colored-nodes-5" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">Spiral graph with colored nodes</h3>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">node_colors =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</span>
<span id="cb40-3"><a href="#cb40-3"></a>                                         <span class="dt">.f =</span> <span class="op">~</span>{tidyr<span class="op">::</span><span class="kw">pivot_wider</span>(.x, <span class="dt">names_from =</span> name) <span class="op">%&gt;%</span></span>
<span id="cb40-4"><a href="#cb40-4"></a><span class="st">                                             </span>dplyr<span class="op">::</span><span class="kw">pull</span>(attractors)}))</span>
<span id="cb40-5"><a href="#cb40-5"></a></span>
<span id="cb40-6"><a href="#cb40-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets_nodes_plots)) {</span>
<span id="cb40-7"><a href="#cb40-7"></a><span class="kw">levels</span>(emadata_nested_wrangled_both_recnets_nodes_plots<span class="op">$</span>node_colors[[i]]) &lt;-<span class="st"> </span></span>
<span id="cb40-8"><a href="#cb40-8"></a><span class="st">  </span><span class="kw">c</span>(viridisLite<span class="op">::</span><span class="kw">plasma</span>(<span class="dv">4</span>, </span>
<span id="cb40-9"><a href="#cb40-9"></a>                      <span class="dt">end =</span> <span class="fl">0.8</span>, </span>
<span id="cb40-10"><a href="#cb40-10"></a>                      <span class="dt">direction =</span> <span class="dv">-1</span>), <span class="st">&quot;gray48&quot;</span>, <span class="st">&quot;white&quot;</span>)</span>
<span id="cb40-11"><a href="#cb40-11"></a>  }</span>
<span id="cb40-12"><a href="#cb40-12"></a></span>
<span id="cb40-13"><a href="#cb40-13"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb40-14"><a href="#cb40-14"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">spiralgraph_epochs =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> graph_from_adjacency,</span>
<span id="cb40-15"><a href="#cb40-15"></a>                                          <span class="dt">..2 =</span> node_colors,</span>
<span id="cb40-16"><a href="#cb40-16"></a>                                          <span class="dt">..3 =</span> User),</span>
<span id="cb40-17"><a href="#cb40-17"></a>                                     <span class="dt">.f =</span>  <span class="op">~</span>casnet<span class="op">::</span><span class="kw">make_spiral_graph</span>(<span class="dt">g =</span> ..<span class="dv">1</span>, </span>
<span id="cb40-18"><a href="#cb40-18"></a>                                                                      <span class="dt">arcs =</span> <span class="dv">4</span>, </span>
<span id="cb40-19"><a href="#cb40-19"></a>                                                                      <span class="co"># a = .1, </span></span>
<span id="cb40-20"><a href="#cb40-20"></a>                                                                      <span class="co"># b = 2, </span></span>
<span id="cb40-21"><a href="#cb40-21"></a>                                                                      <span class="dt">markTimeBy =</span> <span class="ot">TRUE</span>,</span>
<span id="cb40-22"><a href="#cb40-22"></a>                                                                      <span class="dt">markEpochsBy =</span> ..<span class="dv">2</span>,</span>
<span id="cb40-23"><a href="#cb40-23"></a>                                                                      <span class="dt">epochColours =</span> ..<span class="dv">2</span>,</span>
<span id="cb40-24"><a href="#cb40-24"></a>                                                                      <span class="dt">showEpochLegend =</span> <span class="ot">FALSE</span>,</span>
<span id="cb40-25"><a href="#cb40-25"></a>                                                                      <span class="dt">scaleEdgeSize =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">10</span>,</span>
<span id="cb40-26"><a href="#cb40-26"></a>                                                                      <span class="dt">scaleVertexSize =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">5</span>),</span>
<span id="cb40-27"><a href="#cb40-27"></a>                                                                      <span class="dt">showSizeLegend =</span> <span class="ot">FALSE</span>,</span>
<span id="cb40-28"><a href="#cb40-28"></a>                                                                      <span class="dt">sizeLabel =</span> <span class="st">&quot;Node strength&quot;</span>,</span>
<span id="cb40-29"><a href="#cb40-29"></a>                                                                      <span class="dt">type =</span> <span class="st">&quot;Euler&quot;</span>,</span>
<span id="cb40-30"><a href="#cb40-30"></a>                                                                      <span class="co"># alphaE = 0.1</span></span>
<span id="cb40-31"><a href="#cb40-31"></a>                                                                      <span class="co"># title = ..3</span></span>
<span id="cb40-32"><a href="#cb40-32"></a>                                     )))</span></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/unnamed-chunk-15-1.png" width="2100" /></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a></span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="co"># emadata_nested_wrangled_both_recnets_nodes_plots$spiralgraph_epochs[[1]] +</span></span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="co">#   theme(plot.margin=grid::unit(c(0,0,0,0), &quot;mm&quot;))</span></span>
<span id="cb41-4"><a href="#cb41-4"></a></span>
<span id="cb41-5"><a href="#cb41-5"></a><span class="co"># ggsave(filename = &quot;./figures/recnetwork.png&quot;,</span></span>
<span id="cb41-6"><a href="#cb41-6"></a><span class="co">#        width = 7, </span></span>
<span id="cb41-7"><a href="#cb41-7"></a><span class="co">#        height = 7)</span></span>
<span id="cb41-8"><a href="#cb41-8"></a></span>
<span id="cb41-9"><a href="#cb41-9"></a><span class="co"># emadata_nested_wrangled_both_recnets_nodes_plots$all_nodes_with_strengths[[1]]</span></span></code></pre></div>
</div>
<div id="attractor-plot-5" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">Attractor plot</h3>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">observations =</span> purrr<span class="op">::</span><span class="kw">map_dbl</span>(<span class="dt">.x =</span> taskNormed_standardised,</span>
<span id="cb42-3"><a href="#cb42-3"></a>                                              <span class="dt">.f =</span> <span class="op">~</span><span class="kw">nrow</span>(.)))</span>
<span id="cb42-4"><a href="#cb42-4"></a></span>
<span id="cb42-5"><a href="#cb42-5"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span></span>
<span id="cb42-6"><a href="#cb42-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">observations_daily =</span> purrr<span class="op">::</span><span class="kw">map_dbl</span>(<span class="dt">.x =</span> data_daily,</span>
<span id="cb42-7"><a href="#cb42-7"></a>                                              <span class="dt">.f =</span> <span class="op">~</span><span class="kw">nrow</span>(.)))</span>
<span id="cb42-8"><a href="#cb42-8"></a></span>
<span id="cb42-9"><a href="#cb42-9"></a></span>
<span id="cb42-10"><a href="#cb42-10"></a>emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb42-11"><a href="#cb42-11"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(</span>
<span id="cb42-12"><a href="#cb42-12"></a>    <span class="dt">attractor_plots =</span> </span>
<span id="cb42-13"><a href="#cb42-13"></a>      purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> all_nodes_with_strengths,</span>
<span id="cb42-14"><a href="#cb42-14"></a>                       <span class="dt">..2 =</span> observations,</span>
<span id="cb42-15"><a href="#cb42-15"></a>                       <span class="dt">..3 =</span> observations_daily,</span>
<span id="cb42-16"><a href="#cb42-16"></a>                       <span class="dt">..4 =</span> User),</span>
<span id="cb42-17"><a href="#cb42-17"></a>                  <span class="dt">.f =</span> <span class="op">~</span>{</span>
<span id="cb42-18"><a href="#cb42-18"></a>                    dplyr<span class="op">::</span><span class="kw">mutate</span>(..<span class="dv">1</span>,</span>
<span id="cb42-19"><a href="#cb42-19"></a>                                  <span class="dt">strength_rescaled =</span> </span>
<span id="cb42-20"><a href="#cb42-20"></a>                                    scales<span class="op">::</span><span class="kw">rescale</span>(strength, <span class="dt">to =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">1.1</span>)),</span>
<span id="cb42-21"><a href="#cb42-21"></a>                                  <span class="dt">alpha_strength =</span> <span class="kw">ifelse</span>(strength_rescaled <span class="op">==</span><span class="st"> </span><span class="fl">0.3</span>, </span>
<span id="cb42-22"><a href="#cb42-22"></a>                                                          <span class="fl">0.5</span>, </span>
<span id="cb42-23"><a href="#cb42-23"></a>                                                          strength_rescaled)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb42-24"><a href="#cb42-24"></a><span class="st">                      </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</span>
<span id="cb42-25"><a href="#cb42-25"></a>                             <span class="kw">aes</span>(<span class="dt">x =</span> forcats<span class="op">::</span><span class="kw">fct_rev</span>(name), </span>
<span id="cb42-26"><a href="#cb42-26"></a>                                 <span class="dt">y =</span> value, </span>
<span id="cb42-27"><a href="#cb42-27"></a>                                 <span class="dt">size =</span> strength_rescaled,</span>
<span id="cb42-28"><a href="#cb42-28"></a>                                 <span class="dt">alpha =</span> alpha_strength,</span>
<span id="cb42-29"><a href="#cb42-29"></a>                                 <span class="dt">color =</span> attractors_n)) <span class="op">+</span></span>
<span id="cb42-30"><a href="#cb42-30"></a><span class="st">                      </span><span class="kw">scale_size_identity</span>() <span class="op">+</span></span>
<span id="cb42-31"><a href="#cb42-31"></a><span class="st">                      </span><span class="kw">scale_alpha_identity</span>() <span class="op">+</span></span>
<span id="cb42-32"><a href="#cb42-32"></a><span class="st">                      </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">alpha =</span> alpha_strength)) <span class="op">+</span></span>
<span id="cb42-33"><a href="#cb42-33"></a><span class="st">                      </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> time,</span>
<span id="cb42-34"><a href="#cb42-34"></a>                                    <span class="dt">alpha =</span> alpha_strength)) <span class="op">+</span></span>
<span id="cb42-35"><a href="#cb42-35"></a><span class="st">                      </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(viridisLite<span class="op">::</span><span class="kw">plasma</span>(<span class="dv">4</span>, </span>
<span id="cb42-36"><a href="#cb42-36"></a>                                                                        <span class="dt">end =</span> <span class="fl">0.8</span>, </span>
<span id="cb42-37"><a href="#cb42-37"></a>                                                                        <span class="dt">direction =</span> <span class="dv">-1</span>), </span>
<span id="cb42-38"><a href="#cb42-38"></a>                                                    <span class="st">&quot;gray40&quot;</span>, <span class="st">&quot;gray50&quot;</span>)) <span class="op">+</span></span>
<span id="cb42-39"><a href="#cb42-39"></a><span class="st">                      </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">label_percent</span>(<span class="dt">accuracy =</span> <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb42-40"><a href="#cb42-40"></a><span class="st">                      </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb42-41"><a href="#cb42-41"></a><span class="st">                      </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb42-42"><a href="#cb42-42"></a><span class="st">                      </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Percentage of maximum reported value of variable, across full time series&quot;</span>,</span>
<span id="cb42-43"><a href="#cb42-43"></a>                           <span class="dt">x =</span> <span class="ot">NULL</span>,</span>
<span id="cb42-44"><a href="#cb42-44"></a>                           <span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&quot;Participant </span><span class="ch">\&quot;</span><span class="st">&quot;</span>, ..<span class="dv">4</span>, <span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st"> - based on &quot;</span>, ..<span class="dv">2</span>, <span class="st">&quot; data points (&quot;</span>, ..<span class="dv">3</span>, <span class="st">&quot; days)&quot;</span>)) <span class="op">+</span></span>
<span id="cb42-45"><a href="#cb42-45"></a><span class="st">                      </span><span class="kw">facet_wrap</span>(<span class="op">~</span>attractors_n) <span class="op">+</span></span>
<span id="cb42-46"><a href="#cb42-46"></a><span class="st">                      </span><span class="kw">coord_flip</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb42-47"><a href="#cb42-47"></a>                  }</span>
<span id="cb42-48"><a href="#cb42-48"></a>      ))</span>
<span id="cb42-49"><a href="#cb42-49"></a></span>
<span id="cb42-50"><a href="#cb42-50"></a>emadata_nested_wrangled_both_recnets_nodes_plots<span class="op">$</span>attractor_plots[[<span class="dv">1</span>]]</span></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/attractor-plots_taskNormed-1.png" width="2100" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="co"># emadata_nested_wrangled_both_recnets_nodes_plots$all_nodes_with_strengths[[1]]</span></span></code></pre></div>
</div>
</div>
</div>
<div id="which-tasks-do-attractors-consist-of" class="section level1">
<h1>Which tasks do attractors consist of?</h1>
<p>Each time the participant responded to the questionnaire, they also indicated, which task they were performing at the moment. These responses were coarse-grained to ensure anonymity. In collaboration with the participant, highly specific tasks that were considered similar enough, were combined under a more general descriptive label. One task, “Moti13_1”, could not be fit in any category but was highly specific, so it was anonymised.</p>
<p>Lists below indicate, which tasks each attractor consists of.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>taskdata &lt;-<span class="st"> </span>firstlast_emadata_nested_wrangled_both_recnets_nodes_plots<span class="op">$</span>all_nodes_with_strengths[[<span class="dv">1</span>]] <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> name, <span class="dt">values_from =</span> value)</span>
<span id="cb44-3"><a href="#cb44-3"></a></span>
<span id="cb44-4"><a href="#cb44-4"></a>taskdata<span class="op">$</span>own_question &lt;-</span>
<span id="cb44-5"><a href="#cb44-5"></a>emadata_nested_wrangled_both_recnets_nodes_plots<span class="op">$</span>data_extremes[[<span class="dv">4</span>]]<span class="op">$</span>own_question</span>
<span id="cb44-6"><a href="#cb44-6"></a></span>
<span id="cb44-7"><a href="#cb44-7"></a><span class="co"># n_tasks &lt;- emadata_nested_wrangled_both_recnets_nodes_plots$data_with_tasks_and_dates[[11]] %&gt;% </span></span>
<span id="cb44-8"><a href="#cb44-8"></a><span class="co">#   tidyr::pivot_longer(cols = task) %&gt;% </span></span>
<span id="cb44-9"><a href="#cb44-9"></a><span class="co">#   dplyr::count(name, value) %&gt;% </span></span>
<span id="cb44-10"><a href="#cb44-10"></a><span class="co">#   nrow()</span></span>
<span id="cb44-11"><a href="#cb44-11"></a></span>
<span id="cb44-12"><a href="#cb44-12"></a><span class="co"># Binarise task variable into 1/0</span></span>
<span id="cb44-13"><a href="#cb44-13"></a>task_n_by_date &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots<span class="op">$</span></span>
<span id="cb44-14"><a href="#cb44-14"></a><span class="st">                    </span>data_firstlast_divided_by_max_with_tasks_and_dates[[<span class="dv">1</span>]]  <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-15"><a href="#cb44-15"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">value =</span> <span class="dv">1</span>,</span>
<span id="cb44-16"><a href="#cb44-16"></a>                <span class="dt">col_temp =</span> <span class="kw">paste0</span>(<span class="st">&quot;task_&quot;</span>, task)) <span class="op">%&gt;%</span></span>
<span id="cb44-17"><a href="#cb44-17"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> col_temp, </span>
<span id="cb44-18"><a href="#cb44-18"></a>                     <span class="dt">values_from =</span> value, </span>
<span id="cb44-19"><a href="#cb44-19"></a>                     <span class="dt">values_fill =</span> <span class="kw">list</span>(<span class="dt">value =</span> <span class="dv">0</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-20"><a href="#cb44-20"></a><span class="st">  </span><span class="co">### If multiple per day and you want daily sums:</span></span>
<span id="cb44-21"><a href="#cb44-21"></a><span class="st">  </span><span class="co"># dplyr::group_by(date) %&gt;%</span></span>
<span id="cb44-22"><a href="#cb44-22"></a><span class="st">  </span><span class="co"># dplyr::summarise_at(vars(contains(&quot;task_&quot;)), funs(sum)) %&gt;%</span></span>
<span id="cb44-23"><a href="#cb44-23"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">time =</span> <span class="kw">row_number</span>())</span>
<span id="cb44-24"><a href="#cb44-24"></a>  </span>
<span id="cb44-25"><a href="#cb44-25"></a>taskdata_full &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">full_join</span>(taskdata, task_n_by_date, <span class="dt">by =</span> <span class="st">&quot;time&quot;</span>)</span>
<span id="cb44-26"><a href="#cb44-26"></a>  </span>
<span id="cb44-27"><a href="#cb44-27"></a>taskdata_tasks &lt;-<span class="st"> </span>taskdata_full <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-28"><a href="#cb44-28"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(attractors) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-29"><a href="#cb44-29"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="kw">contains</span>(<span class="st">&quot;task_&quot;</span>)), sum, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-30"><a href="#cb44-30"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="op">-</span>attractors) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-31"><a href="#cb44-31"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(attractors) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-32"><a href="#cb44-32"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">name =</span> stringr<span class="op">::</span><span class="kw">str_replace</span>(name, <span class="st">&quot;task_&quot;</span>, <span class="st">&quot;&quot;</span>),</span>
<span id="cb44-33"><a href="#cb44-33"></a>                <span class="dt">prop =</span> (value <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(value)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">3</span>),</span>
<span id="cb44-34"><a href="#cb44-34"></a>                <span class="dt">perc =</span> <span class="kw">paste0</span>(prop <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, <span class="st">&quot; %&quot;</span>),</span>
<span id="cb44-35"><a href="#cb44-35"></a>                <span class="dt">nameperc =</span> <span class="kw">paste0</span>(name, <span class="st">&quot; (&quot;</span>, perc, <span class="st">&quot;)&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-36"><a href="#cb44-36"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(prop <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>,</span>
<span id="cb44-37"><a href="#cb44-37"></a>                prop <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.01</span>) <span class="op">%&gt;%</span></span>
<span id="cb44-38"><a href="#cb44-38"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(prop)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-39"><a href="#cb44-39"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(attractors) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-40"><a href="#cb44-40"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">n =</span> <span class="kw">sum</span>(value),</span>
<span id="cb44-41"><a href="#cb44-41"></a>                <span class="dt">attractors_n =</span> <span class="kw">paste0</span>(attractors, <span class="st">&quot; (n = &quot;</span>, n, <span class="st">&quot;)&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-42"><a href="#cb44-42"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-43"><a href="#cb44-43"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(attractors_n, nameperc) <span class="op">%&gt;%</span></span>
<span id="cb44-44"><a href="#cb44-44"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(attractors_n) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-45"><a href="#cb44-45"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">nest</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-46"><a href="#cb44-46"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(attractors_n)</span>
<span id="cb44-47"><a href="#cb44-47"></a></span>
<span id="cb44-48"><a href="#cb44-48"></a></span>
<span id="cb44-49"><a href="#cb44-49"></a></span>
<span id="cb44-50"><a href="#cb44-50"></a>taskdata_tasks_named &lt;-<span class="st"> </span>taskdata_tasks <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-51"><a href="#cb44-51"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> data, </span>
<span id="cb44-52"><a href="#cb44-52"></a>                                   <span class="dt">.y =</span> attractors_n,</span>
<span id="cb44-53"><a href="#cb44-53"></a>                                   <span class="dt">.f =</span> <span class="op">~</span>purrr<span class="op">::</span><span class="kw">set_names</span>(.x, <span class="dt">nm =</span> .y)))</span>
<span id="cb44-54"><a href="#cb44-54"></a></span>
<span id="cb44-55"><a href="#cb44-55"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(taskdata_tasks_named<span class="op">$</span>data <span class="op">%&gt;%</span><span class="st"> </span>length)){</span>
<span id="cb44-56"><a href="#cb44-56"></a>taskdata_tasks_named<span class="op">$</span>data[i] <span class="op">%&gt;%</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw">kable</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">show</span>()</span>
<span id="cb44-57"><a href="#cb44-57"></a>}</span></code></pre></div>
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="left">1st (n = 17)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Internal meeting (52.9 %)</td>
</tr>
<tr class="even">
<td align="left">Team meeting (11.8 %)</td>
</tr>
<tr class="odd">
<td align="left">Planning training (5.9 %)</td>
</tr>
<tr class="even">
<td align="left">Participating event (5.9 %)</td>
</tr>
<tr class="odd">
<td align="left">Organising work (5.9 %)</td>
</tr>
<tr class="even">
<td align="left">Contracts (5.9 %)</td>
</tr>
<tr class="odd">
<td align="left">Investigatory work (5.9 %)</td>
</tr>
<tr class="even">
<td align="left">Offering a job (5.9 %)</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="left">2nd (n = 8)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Internal meeting (50 %)</td>
</tr>
<tr class="even">
<td align="left">Participating event (12.5 %)</td>
</tr>
<tr class="odd">
<td align="left">Creating presentation (12.5 %)</td>
</tr>
<tr class="even">
<td align="left">Providing training (12.5 %)</td>
</tr>
<tr class="odd">
<td align="left">Workshop (12.5 %)</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="left">3rd (n = 6)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Email (66.7 %)</td>
</tr>
<tr class="even">
<td align="left">Creating presentation (16.7 %)</td>
</tr>
<tr class="odd">
<td align="left">Team meeting (16.7 %)</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="left">4th (n = 7)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Providing training (28.6 %)</td>
</tr>
<tr class="even">
<td align="left">Writing book (28.6 %)</td>
</tr>
<tr class="odd">
<td align="left">Internal meeting (14.3 %)</td>
</tr>
<tr class="even">
<td align="left">Participating event (14.3 %)</td>
</tr>
<tr class="odd">
<td align="left">Reading report (14.3 %)</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="left">Uncategorised (n = 32)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Internal meeting (18.8 %)</td>
</tr>
<tr class="even">
<td align="left">Email (18.8 %)</td>
</tr>
<tr class="odd">
<td align="left">Planning training (9.4 %)</td>
</tr>
<tr class="even">
<td align="left">Participating event (6.2 %)</td>
</tr>
<tr class="odd">
<td align="left">Providing training (6.2 %)</td>
</tr>
<tr class="even">
<td align="left">Participating training (6.2 %)</td>
</tr>
<tr class="odd">
<td align="left">Phone call (6.2 %)</td>
</tr>
<tr class="even">
<td align="left">Writing internal communication (3.1 %)</td>
</tr>
<tr class="odd">
<td align="left">Creating presentation (3.1 %)</td>
</tr>
<tr class="even">
<td align="left">Organising work (3.1 %)</td>
</tr>
<tr class="odd">
<td align="left">Giving feedback (3.1 %)</td>
</tr>
<tr class="even">
<td align="left">Contracts (3.1 %)</td>
</tr>
<tr class="odd">
<td align="left">Reading report (3.1 %)</td>
</tr>
<tr class="even">
<td align="left">Travelling (3.1 %)</td>
</tr>
<tr class="odd">
<td align="left">Brainstorming (3.1 %)</td>
</tr>
<tr class="even">
<td align="left">Writing guidance (3.1 %)</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="left">Unique (n = 17)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Internal meeting (23.5 %)</td>
</tr>
<tr class="even">
<td align="left">Email (23.5 %)</td>
</tr>
<tr class="odd">
<td align="left">Participating training (11.8 %)</td>
</tr>
<tr class="even">
<td align="left">Translating (5.9 %)</td>
</tr>
<tr class="odd">
<td align="left">Providing training (5.9 %)</td>
</tr>
<tr class="even">
<td align="left">Organising work (5.9 %)</td>
</tr>
<tr class="odd">
<td align="left">Team meeting (5.9 %)</td>
</tr>
<tr class="even">
<td align="left">Giving feedback (5.9 %)</td>
</tr>
<tr class="odd">
<td align="left">Writing book (5.9 %)</td>
</tr>
<tr class="even">
<td align="left">Moti13_1 (5.9 %)</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a></span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="co"># taskdata_tasks_named &lt;-  purrr::set_names(taskdata_tasks$data, nm = taskdata_tasks$attractors)</span></span></code></pre></div>
<p>As can be observed, tasks do not neatly fall into a particular attractor, that is, within tasks there are several possible motivational profiles.</p>
<div id="most-frequent-tasks-and-their-attractors" class="section level2">
<h2>Most frequent tasks and their attractors</h2>
<p>Plot below shows how the most common tasks for this participant fall within the attractors.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a></span>
<span id="cb46-2"><a href="#cb46-2"></a>top_tasks &lt;-<span class="st"> </span>taskdata_full <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb46-3"><a href="#cb46-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(task) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb46-4"><a href="#cb46-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb46-5"><a href="#cb46-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(n)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb46-6"><a href="#cb46-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb46-7"><a href="#cb46-7"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">pull</span>(task)</span>
<span id="cb46-8"><a href="#cb46-8"></a></span>
<span id="cb46-9"><a href="#cb46-9"></a>taskdata_full <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb46-10"><a href="#cb46-10"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(task <span class="op">%in%</span><span class="st"> </span>top_tasks) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb46-11"><a href="#cb46-11"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Date, <span class="dt">y =</span> attractors)) <span class="op">+</span></span>
<span id="cb46-12"><a href="#cb46-12"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> task, </span>
<span id="cb46-13"><a href="#cb46-13"></a>                 <span class="dt">colour =</span> task), </span>
<span id="cb46-14"><a href="#cb46-14"></a>             <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="co">#height = 0.2,</span></span>
<span id="cb46-15"><a href="#cb46-15"></a>                                        <span class="dt">width =</span> <span class="fl">0.4</span>)) <span class="op">+</span></span>
<span id="cb46-16"><a href="#cb46-16"></a><span class="st">  </span><span class="co"># geom_line(aes(group = task)) +</span></span>
<span id="cb46-17"><a href="#cb46-17"></a><span class="st">  </span><span class="kw">scale_x_datetime</span>(<span class="dt">name =</span> <span class="ot">NULL</span>,</span>
<span id="cb46-18"><a href="#cb46-18"></a>                   <span class="dt">date_breaks =</span> <span class="st">&quot;1 month&quot;</span>, </span>
<span id="cb46-19"><a href="#cb46-19"></a>                   <span class="dt">date_labels =</span> <span class="st">&quot;%F&quot;</span>) <span class="op">+</span></span>
<span id="cb46-20"><a href="#cb46-20"></a><span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">end =</span> <span class="fl">0.9</span>) <span class="op">+</span></span>
<span id="cb46-21"><a href="#cb46-21"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb46-22"><a href="#cb46-22"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>)) <span class="op">+</span></span>
<span id="cb46-23"><a href="#cb46-23"></a><span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">name =</span> <span class="st">&quot;Attractor&quot;</span>, </span>
<span id="cb46-24"><a href="#cb46-24"></a>                   <span class="dt">limits =</span> <span class="kw">rev</span>(<span class="kw">levels</span>(taskdata_full<span class="op">$</span>attractors))) <span class="op">+</span></span>
<span id="cb46-25"><a href="#cb46-25"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major.y =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb46-26"><a href="#cb46-26"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">6</span>)) <span class="op">+</span></span>
<span id="cb46-27"><a href="#cb46-27"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Most frequent tasks for this participant&quot;</span>)</span></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/taskplot-firstlast-1.png" width="2100" /></p>
<p>We can see, that no task consistently falls in one attractor. On the other hand, e.g. <em>Email</em> is absent from 1st, 2nd and 4th attractor, and <em>Providing training</em> does not appear in the 1st or 3rd. In the case of the latter, it might be due to the low number of observations, i.e. had more data been collected, Providing training could have exhibited new motivation profiles.</p>
</div>
<div id="all-tasks-with-their-temporal-positions" class="section level2 tabset">
<h2 class="tabset">All tasks with their temporal positions</h2>
<p>Figures below show this participant’s tasks and when they take place.</p>
<div id="tasks-in-the-analysis-first-and-last-daily-observations" class="section level3">
<h3>Tasks in the analysis (first and last daily observations)</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="co"># Weekends to be darkened:</span></span>
<span id="cb47-2"><a href="#cb47-2"></a>dateRanges &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb47-3"><a href="#cb47-3"></a>  <span class="dt">start =</span> <span class="kw">seq</span>(<span class="kw">as.POSIXct</span>(<span class="st">&quot;1900-11-02 19:00:00&quot;</span>), <span class="kw">as.POSIXct</span>(<span class="st">&quot;2100-11-02 19:00:00&quot;</span>), <span class="st">&quot;1 week&quot;</span>),</span>
<span id="cb47-4"><a href="#cb47-4"></a>  <span class="dt">end =</span> <span class="kw">seq</span>(<span class="kw">as.POSIXct</span>(<span class="st">&quot;1900-11-05 05:00:00&quot;</span>), <span class="kw">as.POSIXct</span>(<span class="st">&quot;2100-11-05 05:00:00&quot;</span>), <span class="st">&quot;1 week&quot;</span>))</span>
<span id="cb47-5"><a href="#cb47-5"></a></span>
<span id="cb47-6"><a href="#cb47-6"></a>dateRanges<span class="op">$</span>startDay &lt;-<span class="st"> </span><span class="kw">weekdays</span>(dateRanges<span class="op">$</span>start)</span>
<span id="cb47-7"><a href="#cb47-7"></a>dateRanges<span class="op">$</span>endDay &lt;-<span class="st"> </span><span class="kw">weekdays</span>(dateRanges<span class="op">$</span>end)</span>
<span id="cb47-8"><a href="#cb47-8"></a></span>
<span id="cb47-9"><a href="#cb47-9"></a>taskdata_full &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots<span class="op">$</span></span>
<span id="cb47-10"><a href="#cb47-10"></a><span class="st">                  </span>data_firstlast_divided_by_max_with_tasks_and_dates[[<span class="dv">1</span>]] </span>
<span id="cb47-11"><a href="#cb47-11"></a></span>
<span id="cb47-12"><a href="#cb47-12"></a>taskdata_full <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb47-13"><a href="#cb47-13"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">task_orig =</span> task) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb47-14"><a href="#cb47-14"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(task_orig) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb47-15"><a href="#cb47-15"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">task_n =</span> <span class="kw">n</span>(),</span>
<span id="cb47-16"><a href="#cb47-16"></a>                <span class="dt">task =</span> <span class="kw">paste0</span>(task, <span class="st">&quot; (n = &quot;</span>, task_n, <span class="st">&quot;)&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb47-17"><a href="#cb47-17"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb47-18"><a href="#cb47-18"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(task, Date) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb47-19"><a href="#cb47-19"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(Date) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb47-20"><a href="#cb47-20"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(task)) <span class="op">%&gt;%</span></span>
<span id="cb47-21"><a href="#cb47-21"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="co"># task = forcats::fct_lump(.$task, n = 25, ties.method = &quot;first&quot;, other_level = &quot;Muu&quot;),</span></span>
<span id="cb47-22"><a href="#cb47-22"></a>                <span class="dt">task =</span> <span class="kw">reorder</span>(task, task, <span class="dt">FUN =</span> length)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb47-23"><a href="#cb47-23"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(<span class="kw">as.Date</span>(Date)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb47-24"><a href="#cb47-24"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">consecutive =</span> <span class="kw">ifelse</span>(<span class="kw">lag</span>(task) <span class="op">==</span><span class="st"> </span>task, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb47-25"><a href="#cb47-25"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Date, <span class="dt">y =</span> task)) <span class="op">+</span></span>
<span id="cb47-26"><a href="#cb47-26"></a><span class="st">  </span><span class="co"># The consecutiveness connector does not work for some reason:</span></span>
<span id="cb47-27"><a href="#cb47-27"></a><span class="st">  </span><span class="co"># geom_line(aes(alpha = consecutive, group = task)) +</span></span>
<span id="cb47-28"><a href="#cb47-28"></a><span class="st">  </span><span class="co"># scale_alpha_manual(values=c(0, 1), breaks=c(FALSE, TRUE), guide=&#39;none&#39;) +</span></span>
<span id="cb47-29"><a href="#cb47-29"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> task), <span class="dt">shape =</span> <span class="dv">124</span>, <span class="dt">stroke =</span> <span class="fl">0.08</span>, <span class="dt">size =</span> <span class="dv">3</span>)  <span class="op">+</span></span>
<span id="cb47-30"><a href="#cb47-30"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb47-31"><a href="#cb47-31"></a><span class="st">  </span><span class="kw">geom_rect</span>(<span class="dt">data =</span> dateRanges, </span>
<span id="cb47-32"><a href="#cb47-32"></a>          <span class="kw">aes</span>(<span class="dt">xmin =</span> (start) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">xmax =</span> (end) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">ymax =</span> <span class="ot">Inf</span>),</span>
<span id="cb47-33"><a href="#cb47-33"></a>          <span class="dt">inherit.aes =</span> <span class="ot">FALSE</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;gray90&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># see https://stackoverflow.com/questions/40331685/shading-month-intervals-when-plotting-time-series-data-with-different-start-andtheme_bw() </span></span>
<span id="cb47-34"><a href="#cb47-34"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">270</span>, <span class="dt">hjust =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="dv">5</span>),</span>
<span id="cb47-35"><a href="#cb47-35"></a>        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb47-36"><a href="#cb47-36"></a><span class="st">  </span><span class="kw">scale_x_datetime</span>(<span class="dt">date_labels =</span> <span class="st">&quot;%d/%m&quot;</span>, <span class="dt">date_breaks =</span> <span class="st">&quot;2 days&quot;</span>, <span class="dt">limits =</span> <span class="kw">range</span>(taskdata_full<span class="op">$</span>Date)) <span class="op">+</span></span>
<span id="cb47-37"><a href="#cb47-37"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>, <span class="dt">title =</span> <span class="st">&quot;Sampled tasks&quot;</span>)</span></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/unnamed-chunk-16-1.png" width="2100" /></p>
</div>
<div id="all-tasks" class="section level3">
<h3>All tasks</h3>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a></span>
<span id="cb48-2"><a href="#cb48-2"></a><span class="co"># Weekends to be darkened:</span></span>
<span id="cb48-3"><a href="#cb48-3"></a>dateRanges &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb48-4"><a href="#cb48-4"></a>  <span class="dt">start =</span> <span class="kw">seq</span>(<span class="kw">as.POSIXct</span>(<span class="st">&quot;1900-11-02 19:00:00&quot;</span>), <span class="kw">as.POSIXct</span>(<span class="st">&quot;2100-11-02 19:00:00&quot;</span>), <span class="st">&quot;1 week&quot;</span>),</span>
<span id="cb48-5"><a href="#cb48-5"></a>  <span class="dt">end =</span> <span class="kw">seq</span>(<span class="kw">as.POSIXct</span>(<span class="st">&quot;1900-11-05 05:00:00&quot;</span>), <span class="kw">as.POSIXct</span>(<span class="st">&quot;2100-11-05 05:00:00&quot;</span>), <span class="st">&quot;1 week&quot;</span>))</span>
<span id="cb48-6"><a href="#cb48-6"></a></span>
<span id="cb48-7"><a href="#cb48-7"></a>dateRanges<span class="op">$</span>startDay &lt;-<span class="st"> </span><span class="kw">weekdays</span>(dateRanges<span class="op">$</span>start)</span>
<span id="cb48-8"><a href="#cb48-8"></a>dateRanges<span class="op">$</span>endDay &lt;-<span class="st"> </span><span class="kw">weekdays</span>(dateRanges<span class="op">$</span>end)</span>
<span id="cb48-9"><a href="#cb48-9"></a></span>
<span id="cb48-10"><a href="#cb48-10"></a>taskdata_all &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots<span class="op">$</span></span>
<span id="cb48-11"><a href="#cb48-11"></a><span class="st">                    </span>data_with_tasks_and_dates[[<span class="dv">1</span>]] </span>
<span id="cb48-12"><a href="#cb48-12"></a></span>
<span id="cb48-13"><a href="#cb48-13"></a>taskdata_all <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb48-14"><a href="#cb48-14"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">task_orig =</span> task) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb48-15"><a href="#cb48-15"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(task_orig) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb48-16"><a href="#cb48-16"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">task_n =</span> <span class="kw">n</span>(),</span>
<span id="cb48-17"><a href="#cb48-17"></a>                <span class="dt">task =</span> <span class="kw">paste0</span>(task, <span class="st">&quot; (n = &quot;</span>, task_n, <span class="st">&quot;)&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb48-18"><a href="#cb48-18"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb48-19"><a href="#cb48-19"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(task, Date) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb48-20"><a href="#cb48-20"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(Date) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb48-21"><a href="#cb48-21"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(task)) <span class="op">%&gt;%</span></span>
<span id="cb48-22"><a href="#cb48-22"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="co">#task = forcats::fct_lump(.$task, n = 25, ties.method = &quot;first&quot;, other_level = &quot;Muu&quot;),</span></span>
<span id="cb48-23"><a href="#cb48-23"></a>                <span class="dt">task =</span> <span class="kw">reorder</span>(task, task, <span class="dt">FUN =</span> length)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb48-24"><a href="#cb48-24"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(<span class="kw">as.Date</span>(Date)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb48-25"><a href="#cb48-25"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">consecutive =</span> <span class="kw">ifelse</span>(<span class="kw">lag</span>(task) <span class="op">==</span><span class="st"> </span>task, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb48-26"><a href="#cb48-26"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Date, <span class="dt">y =</span> task)) <span class="op">+</span></span>
<span id="cb48-27"><a href="#cb48-27"></a><span class="st">  </span><span class="co"># The consecutiveness connector does not work for some reason:</span></span>
<span id="cb48-28"><a href="#cb48-28"></a><span class="st">  </span><span class="co"># geom_line(aes(alpha = consecutive, group = task)) +</span></span>
<span id="cb48-29"><a href="#cb48-29"></a><span class="st">  </span><span class="co"># scale_alpha_manual(values=c(0, 1), breaks=c(FALSE, TRUE), guide=&#39;none&#39;) +</span></span>
<span id="cb48-30"><a href="#cb48-30"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> task), <span class="dt">shape =</span> <span class="dv">124</span>, <span class="dt">stroke =</span> <span class="fl">0.08</span>, <span class="dt">size =</span> <span class="dv">3</span>)  <span class="op">+</span></span>
<span id="cb48-31"><a href="#cb48-31"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb48-32"><a href="#cb48-32"></a><span class="st">  </span><span class="kw">geom_rect</span>(<span class="dt">data =</span> dateRanges, </span>
<span id="cb48-33"><a href="#cb48-33"></a>          <span class="kw">aes</span>(<span class="dt">xmin =</span> (start) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">xmax =</span> (end) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">ymax =</span> <span class="ot">Inf</span>),</span>
<span id="cb48-34"><a href="#cb48-34"></a>          <span class="dt">inherit.aes =</span> <span class="ot">FALSE</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;gray90&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># see https://stackoverflow.com/questions/40331685/shading-month-intervals-when-plotting-time-series-data-with-different-start-andtheme_bw() </span></span>
<span id="cb48-35"><a href="#cb48-35"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">270</span>, <span class="dt">hjust =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="dv">5</span>),</span>
<span id="cb48-36"><a href="#cb48-36"></a>        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb48-37"><a href="#cb48-37"></a><span class="st">  </span><span class="kw">scale_x_datetime</span>(<span class="dt">date_labels =</span> <span class="st">&quot;%d/%m&quot;</span>, <span class="dt">date_breaks =</span> <span class="st">&quot;2 days&quot;</span>, <span class="dt">limits =</span> <span class="kw">range</span>(taskdata_all<span class="op">$</span>Date)) <span class="op">+</span></span>
<span id="cb48-38"><a href="#cb48-38"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>, <span class="dt">title =</span> <span class="st">&quot;All tasks&quot;</span>)</span></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/unnamed-chunk-17-1.png" width="2100" /></p>
</div>
</div>
</div>
<div id="section" class="section level1 unnumbered">
<h1 class="unnumbered"></h1>
<p>Research questions to be studied with multidimensional recurrence networks:</p>
<ul>
<li>How are the variables in the multivariate system connected to each other; what is the structure (i.e. the centrality indices) of the recurrence network, and do behaviour change outcomes depend on it?</li>
<li>Do new attractors in the multidimensional recurrence network emerge, after an intervention has been implemented?</li>
</ul>
</div>
<div id="recurrence-measures" class="section level1 tabset">
<h1 class="tabset">Recurrence measures</h1>
<div id="trend" class="section level2">
<h2>Trend</h2>
<p>What it depicts: The stationarity of the system, i.e. whether the recurrent patterns emerge homogenously across the plot (indicating system stationarity), or if they fade to the lower right or and upper left corners (indicating the system changes in time, is non-stationarity). For example, a time series of any gradually but surely increasing or decreasing numbers would show a high trend value, whereas a series in which values fluctuate around more or less the same values, would exhibit a low trend value.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a></span>
<span id="cb49-2"><a href="#cb49-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;./figures/RQA_measures/trendlo.PNG&quot;</span>)</span></code></pre></div>
<p><img src="figures/RQA_measures/trendlo.PNG" width="205" /></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;./figures/RQA_measures/trendhi.PNG&quot;</span>)</span></code></pre></div>
<p><img src="figures/RQA_measures/trendhi.PNG" width="205" /></p>
</div>
<div id="determinism" class="section level2">
<h2>Determinism</h2>
<p>What it depicts: The proportion of all recurrent points which land on diagonal lines, meaning that there is a pattern to re-occurrence. For example, motivation for physical activity might be high (or low) on the same weekdays for several weeks in a row, indicating high determinism. Sleep-wake cycles would also show high determinism, whereas random numbers would show no discernable patterns and the lowest possible determinism values.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a></span>
<span id="cb51-2"><a href="#cb51-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;./figures/RQA_measures/determinismlo.PNG&quot;</span>)</span></code></pre></div>
<p><img src="figures/RQA_measures/determinismlo.PNG" width="205" /></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;./figures/RQA_measures/determinismhi.PNG&quot;</span>)</span></code></pre></div>
<p><img src="figures/RQA_measures/determinismhi.PNG" width="205" /></p>
</div>
<div id="trapping-time-and-laminarity" class="section level2">
<h2>Trapping time and Laminarity</h2>
<p>What it depicts: Laminarity is the proportion or recurrent points, which form vertical lines. Trapping time, on the other hand, depicts the average length of vertical line structures; it quantifies the time series’ tendency to get “stuck” on particular values or states. Trapping time could indicate a lack of healthy variability*, which in turn could be indicative of a system performing suboptimally or exhibiting maladaptive behaviour.</p>
<p>* Navarro, J., &amp; Rueff-Lopes, R. (2015). Healthy variability in organizational behavior: Empirical evidence and new steps for future research. Nonlinear Dynamics, Psychology, and Life Sciences, 19(4), 529–552.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a></span>
<span id="cb53-2"><a href="#cb53-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;./figures/RQA_measures/trappingtimelo.PNG&quot;</span>)</span></code></pre></div>
<p><img src="figures/RQA_measures/trappingtimelo.PNG" width="205" /></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;./figures/RQA_measures/trappingtimehi.PNG&quot;</span>)</span></code></pre></div>
<p><img src="figures/RQA_measures/trappingtimehi.PNG" width="205" /></p>
</div>
<div id="entropy" class="section level2">
<h2>Entropy</h2>
<p>What it depicts: The complexity or unpredictability of pattern lengths (i.e. variability in the length of the lines that are parallel to the diagonal); the heart rate of a person playing in a soccer match would show high entropy, whereas their heart rate in a training session of regular timed sprints would show low entropy.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a></span>
<span id="cb55-2"><a href="#cb55-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;./figures/RQA_measures/entropylo.PNG&quot;</span>)</span></code></pre></div>
<p><img src="figures/RQA_measures/entropylo.PNG" width="205" /></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;./figures/RQA_measures/entropyhi.PNG&quot;</span>)</span></code></pre></div>
<p><img src="figures/RQA_measures/entropyhi.PNG" width="205" /></p>
</div>
<div id="average-diagonal-line-length" class="section level2">
<h2>Average diagonal line length</h2>
<p>What it depicts: The average length of the diagonal line structures, that is, the average time the system repeats a behavioural sequence it has exhibited previously. This can be thought of e.g. as a person’s (or their motivational system’s) consistency in repeating habitual behaviour, such as walking many steps during weekdays and little during weekends; a weekend with many steps (or a weekday with few steps) would break this pattern and reduce the average diagonal line length. Hence: While entropy can be thought of as a type of variance of the diagonal lines lengths, average diagonal line length would represent their mean length. Average diagonal line length can also be interpreted as the mean prediction time.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a></span>
<span id="cb57-2"><a href="#cb57-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;./figures/RQA_measures/averagelinelengthlo.PNG&quot;</span>)</span></code></pre></div>
<p><img src="figures/RQA_measures/averagelinelengthlo.PNG" width="205" /></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;./figures/RQA_measures/averagelinelengthhi.PNG&quot;</span>)</span></code></pre></div>
<p><img src="figures/RQA_measures/averagelinelengthhi.PNG" width="205" /></p>
</div>
</div>
<div id="section-1" class="section level1 unnumbered">
<h1 class="unnumbered"></h1>
<p>Possible substantive research questions include:</p>
<ul>
<li>Is trapping time related to inflexible behaviour (e.g., inability to adapt to environmental demands), and are interventions that lessen it analogous to “loosening up” a person’s reaction repertoire?</li>
<li>Does an intervention destabilise the dynamics of a maladaptive target behaviour, leading to increased entropy in recurrence structures?</li>
<li>At which periods in a time series is the target behaviour stationary, and do initiations of trends collide with interventions, indicating intervention’s impact?</li>
<li>How is determinism connected to facets of habit theory?</li>
<li>Does average diagonal line length go down (conferring decreased predictability with past data) when an intervention is introduced, indicating a shift in the system’s dynamics?</li>
</ul>
</div>
<div id="recurrence-plots" class="section level1">
<h1>Recurrence plots</h1>
<!-- NOTE TO READER: In what follows, chunks alternate between include = FALSE and eval = FALSE. The first performs the operation, and the second is there to show the code; this, because otherwise a lot of clutter is reported even though message = FALSE and warning = FALSE. -->
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a></span>
<span id="cb59-2"><a href="#cb59-2"></a>emadata_nested_wrangled_unthresholded &lt;-<span class="st"> </span>emadata_nested_wrangled <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb59-3"><a href="#cb59-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">unthresholded =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> data_firstlast_divided_by_max, </span>
<span id="cb59-4"><a href="#cb59-4"></a>                                        <span class="dt">.f =</span> <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rp</span>(.x, </span>
<span id="cb59-5"><a href="#cb59-5"></a>                                                         <span class="dt">doEmbed =</span> <span class="ot">FALSE</span>)))</span>
<span id="cb59-6"><a href="#cb59-6"></a></span>
<span id="cb59-7"><a href="#cb59-7"></a></span>
<span id="cb59-8"><a href="#cb59-8"></a>emadata_nested_wrangled_unthresholded &lt;-<span class="st"> </span>emadata_nested_wrangled_unthresholded <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb59-9"><a href="#cb59-9"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">unthresholded_plot =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> unthresholded, </span>
<span id="cb59-10"><a href="#cb59-10"></a>                                                <span class="dt">.f =</span> <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rp_plot</span>(.x, </span>
<span id="cb59-11"><a href="#cb59-11"></a>                                                                      <span class="dt">title =</span> <span class="st">&quot;A)&quot;</span>,</span>
<span id="cb59-12"><a href="#cb59-12"></a>                                                                      <span class="dt">xlabel =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>,</span>
<span id="cb59-13"><a href="#cb59-13"></a>                                                                      <span class="dt">ylabel =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>,</span>
<span id="cb59-14"><a href="#cb59-14"></a>                                                                      <span class="dt">plotRadiusRRbar =</span> <span class="ot">TRUE</span>, </span>
<span id="cb59-15"><a href="#cb59-15"></a>                                                                      <span class="dt">plotDimensions =</span> <span class="ot">TRUE</span>)))</span>
<span id="cb59-16"><a href="#cb59-16"></a></span>
<span id="cb59-17"><a href="#cb59-17"></a>emadata_nested_wrangled_both &lt;-<span class="st"> </span>emadata_nested_wrangled_unthresholded <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb59-18"><a href="#cb59-18"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">thresholded =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> data_firstlast_divided_by_max, </span>
<span id="cb59-19"><a href="#cb59-19"></a>                                        <span class="dt">.f =</span> <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rp</span>(.x, </span>
<span id="cb59-20"><a href="#cb59-20"></a>                                                         <span class="dt">doEmbed =</span> <span class="ot">FALSE</span>,</span>
<span id="cb59-21"><a href="#cb59-21"></a>                                                         <span class="dt">emRad =</span> <span class="ot">NA</span>,</span>
<span id="cb59-22"><a href="#cb59-22"></a>                                                         <span class="dt">doPlot =</span> <span class="ot">TRUE</span>,</span>
<span id="cb59-23"><a href="#cb59-23"></a>                                                         <span class="dt">xlabel =</span> <span class="st">&quot; &quot;</span>,</span>
<span id="cb59-24"><a href="#cb59-24"></a>                                                         <span class="dt">ylabel =</span> <span class="st">&quot; &quot;</span>)))</span>
<span id="cb59-25"><a href="#cb59-25"></a></span>
<span id="cb59-26"><a href="#cb59-26"></a></span>
<span id="cb59-27"><a href="#cb59-27"></a></span>
<span id="cb59-28"><a href="#cb59-28"></a><span class="co"># At 15 Dec 2019, crqa_rp is deprecated but called by rp_plot when plotMeasures = TRUE. This hack helps:</span></span>
<span id="cb59-29"><a href="#cb59-29"></a>crqa_rp &lt;-<span class="st"> </span>casnet<span class="op">::</span>rp_measures</span>
<span id="cb59-30"><a href="#cb59-30"></a></span>
<span id="cb59-31"><a href="#cb59-31"></a>emadata_nested_wrangled_both &lt;-<span class="st"> </span>emadata_nested_wrangled_both <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb59-32"><a href="#cb59-32"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">thresholded_plot =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> thresholded, </span>
<span id="cb59-33"><a href="#cb59-33"></a>                                              <span class="dt">.f =</span> <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rp_plot</span>(.x,</span>
<span id="cb59-34"><a href="#cb59-34"></a>                                                                    <span class="dt">title =</span> <span class="st">&quot;B)&quot;</span>,</span>
<span id="cb59-35"><a href="#cb59-35"></a>                                                                    <span class="dt">xlabel =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>,</span>
<span id="cb59-36"><a href="#cb59-36"></a>                                                                    <span class="dt">ylabel =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>,</span>
<span id="cb59-37"><a href="#cb59-37"></a>                                                                    <span class="dt">plotRadiusRRbar =</span> <span class="ot">FALSE</span>, </span>
<span id="cb59-38"><a href="#cb59-38"></a>                                                                    <span class="dt">plotDimensions =</span> <span class="ot">TRUE</span>,</span>
<span id="cb59-39"><a href="#cb59-39"></a>                                                                    <span class="dt">plotMeasures =</span> <span class="ot">FALSE</span>)))</span>
<span id="cb59-40"><a href="#cb59-40"></a></span>
<span id="cb59-41"><a href="#cb59-41"></a>emadata_nested_wrangled_both_withMeasures &lt;-<span class="st"> </span>emadata_nested_wrangled_both <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb59-42"><a href="#cb59-42"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">measures =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> thresholded, </span>
<span id="cb59-43"><a href="#cb59-43"></a>                                              <span class="dt">.f =</span> <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rp_measures</span>(.x,</span>
<span id="cb59-44"><a href="#cb59-44"></a>                                                                        <span class="dt">emRad =</span> <span class="ot">NA</span>)))</span>
<span id="cb59-45"><a href="#cb59-45"></a></span>
<span id="cb59-46"><a href="#cb59-46"></a>rqa_plot &lt;-<span class="st"> </span>gridExtra<span class="op">::</span><span class="kw">grid.arrange</span>(</span>
<span id="cb59-47"><a href="#cb59-47"></a>                        emadata_nested_wrangled_both_withMeasures<span class="op">$</span>unthresholded_plot[[<span class="dv">1</span>]],</span>
<span id="cb59-48"><a href="#cb59-48"></a>                        emadata_nested_wrangled_both_withMeasures<span class="op">$</span>thresholded_plot[[<span class="dv">1</span>]],</span>
<span id="cb59-49"><a href="#cb59-49"></a>                        <span class="dt">layout_matrix =</span> <span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb59-50"><a href="#cb59-50"></a>                                               <span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">byrow =</span> <span class="ot">FALSE</span>))</span>
<span id="cb59-51"><a href="#cb59-51"></a></span>
<span id="cb59-52"><a href="#cb59-52"></a>cowplot<span class="op">::</span><span class="kw">save_plot</span>(<span class="st">&quot;./figures/rqa_biplot.png&quot;</span>, rqa_plot, <span class="dt">dpi =</span> <span class="dv">300</span>)</span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>emadata_nested_wrangled_unthresholded &lt;-<span class="st"> </span>emadata_nested_wrangled <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb60-2"><a href="#cb60-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">unthresholded =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> data_firstlast_divided_by_max, </span>
<span id="cb60-3"><a href="#cb60-3"></a>                                        <span class="dt">.f =</span> <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rp</span>(.x, </span>
<span id="cb60-4"><a href="#cb60-4"></a>                                                         <span class="dt">doEmbed =</span> <span class="ot">FALSE</span>)))</span>
<span id="cb60-5"><a href="#cb60-5"></a></span>
<span id="cb60-6"><a href="#cb60-6"></a></span>
<span id="cb60-7"><a href="#cb60-7"></a>emadata_nested_wrangled_unthresholded &lt;-<span class="st"> </span>emadata_nested_wrangled_unthresholded <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb60-8"><a href="#cb60-8"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">unthresholded_plot =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> unthresholded, </span>
<span id="cb60-9"><a href="#cb60-9"></a>                                                <span class="dt">.f =</span> <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rp_plot</span>(.x, </span>
<span id="cb60-10"><a href="#cb60-10"></a>                                                                      <span class="dt">title =</span> <span class="st">&quot;C)&quot;</span>,</span>
<span id="cb60-11"><a href="#cb60-11"></a>                                                                      <span class="dt">xlabel =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>,</span>
<span id="cb60-12"><a href="#cb60-12"></a>                                                                      <span class="dt">ylabel =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>,</span>
<span id="cb60-13"><a href="#cb60-13"></a>                                                                      <span class="dt">plotRadiusRRbar =</span> <span class="ot">FALSE</span>, </span>
<span id="cb60-14"><a href="#cb60-14"></a>                                                                      <span class="dt">plotDimensions =</span> <span class="ot">TRUE</span>)))</span>
<span id="cb60-15"><a href="#cb60-15"></a></span>
<span id="cb60-16"><a href="#cb60-16"></a>emadata_nested_wrangled_both &lt;-<span class="st"> </span>emadata_nested_wrangled_unthresholded <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb60-17"><a href="#cb60-17"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">thresholded =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> data_firstlast_divided_by_max, </span>
<span id="cb60-18"><a href="#cb60-18"></a>                                        <span class="dt">.f =</span> <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rp</span>(.x, </span>
<span id="cb60-19"><a href="#cb60-19"></a>                                                         <span class="dt">doEmbed =</span> <span class="ot">FALSE</span>,</span>
<span id="cb60-20"><a href="#cb60-20"></a>                                                         <span class="dt">emRad =</span> <span class="ot">NA</span>,</span>
<span id="cb60-21"><a href="#cb60-21"></a>                                                         <span class="dt">doPlot =</span> <span class="ot">TRUE</span>,</span>
<span id="cb60-22"><a href="#cb60-22"></a>                                                         <span class="dt">xlabel =</span> <span class="st">&quot; &quot;</span>,</span>
<span id="cb60-23"><a href="#cb60-23"></a>                                                         <span class="dt">ylabel =</span> <span class="st">&quot; &quot;</span>)))</span>
<span id="cb60-24"><a href="#cb60-24"></a></span>
<span id="cb60-25"><a href="#cb60-25"></a></span>
<span id="cb60-26"><a href="#cb60-26"></a></span>
<span id="cb60-27"><a href="#cb60-27"></a><span class="co"># At 15 Dec 2019, crqa_rp is deprecated but called by rp_plot when plotMeasures = TRUE. This hack helps:</span></span>
<span id="cb60-28"><a href="#cb60-28"></a>crqa_rp &lt;-<span class="st"> </span>casnet<span class="op">::</span>rp_measures</span>
<span id="cb60-29"><a href="#cb60-29"></a></span>
<span id="cb60-30"><a href="#cb60-30"></a>emadata_nested_wrangled_both &lt;-<span class="st"> </span>emadata_nested_wrangled_both <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb60-31"><a href="#cb60-31"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">thresholded_plot =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> thresholded, </span>
<span id="cb60-32"><a href="#cb60-32"></a>                                              <span class="dt">.f =</span> <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rp_plot</span>(.x,</span>
<span id="cb60-33"><a href="#cb60-33"></a>                                                                    <span class="dt">title =</span> <span class="st">&quot;D)&quot;</span>,</span>
<span id="cb60-34"><a href="#cb60-34"></a>                                                                    <span class="dt">xlabel =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>,</span>
<span id="cb60-35"><a href="#cb60-35"></a>                                                                    <span class="dt">ylabel =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>,</span>
<span id="cb60-36"><a href="#cb60-36"></a>                                                                    <span class="dt">plotRadiusRRbar =</span> <span class="ot">FALSE</span>, </span>
<span id="cb60-37"><a href="#cb60-37"></a>                                                                    <span class="dt">plotDimensions =</span> <span class="ot">TRUE</span>,</span>
<span id="cb60-38"><a href="#cb60-38"></a>                                                                    <span class="dt">plotMeasures =</span> <span class="ot">FALSE</span>)))</span>
<span id="cb60-39"><a href="#cb60-39"></a></span>
<span id="cb60-40"><a href="#cb60-40"></a>emadata_nested_wrangled_both_withMeasures &lt;-<span class="st"> </span>emadata_nested_wrangled_both <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb60-41"><a href="#cb60-41"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">measures =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> thresholded, </span>
<span id="cb60-42"><a href="#cb60-42"></a>                                              <span class="dt">.f =</span> <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rp_measures</span>(.x,</span>
<span id="cb60-43"><a href="#cb60-43"></a>                                                                        <span class="dt">emRad =</span> <span class="ot">NA</span>)))</span>
<span id="cb60-44"><a href="#cb60-44"></a></span>
<span id="cb60-45"><a href="#cb60-45"></a><span class="co"># Bring all the RQA measures into one data frame (from: https://stackoverflow.com/questions/2851327/convert-a-list-of-data-frames-into-one-data-frame):</span></span>
<span id="cb60-46"><a href="#cb60-46"></a>complexity_measures &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">bind_rows</span>(emadata_nested_wrangled_both_withMeasures<span class="op">$</span>measures, <span class="dt">.id =</span> <span class="st">&quot;rowNumber&quot;</span>)</span>
<span id="cb60-47"><a href="#cb60-47"></a><span class="co"># User ID is not the same as row number, so take the id from the earlier object: </span></span>
<span id="cb60-48"><a href="#cb60-48"></a>complexity_measures<span class="op">$</span>userID &lt;-<span class="st"> </span>emadata_nested_wrangled_both_withMeasures<span class="op">$</span>User</span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a></span>
<span id="cb61-2"><a href="#cb61-2"></a><span class="kw">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb61-3"><a href="#cb61-3"></a>emadata_nested_wrangled_shuffled &lt;-<span class="st"> </span>emadata_nested_wrangled <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb61-4"><a href="#cb61-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data_daily_standardised_shuffled =</span> </span>
<span id="cb61-5"><a href="#cb61-5"></a>                  purrr<span class="op">::</span><span class="kw">map</span>(data_firstlast_divided_by_max, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate_if</span>(.x, is.numeric,</span>
<span id="cb61-6"><a href="#cb61-6"></a>                                                                         <span class="op">~</span>(<span class="kw">sample</span>(., </span>
<span id="cb61-7"><a href="#cb61-7"></a>                                                                                  <span class="dt">size =</span> <span class="kw">length</span>(.), </span>
<span id="cb61-8"><a href="#cb61-8"></a>                                                                                  <span class="dt">replace =</span> <span class="ot">FALSE</span>)))))</span>
<span id="cb61-9"><a href="#cb61-9"></a></span>
<span id="cb61-10"><a href="#cb61-10"></a><span class="co"># # These are the same, i.e. shuffling didn&#39;t change summary stats:</span></span>
<span id="cb61-11"><a href="#cb61-11"></a><span class="co"># emadata_nested_wrangled$data_daily_standardised[[1]] %&gt;% summary()</span></span>
<span id="cb61-12"><a href="#cb61-12"></a><span class="co"># emadata_nested_wrangled_shuffled$data_daily_standardised_shuffled[[1]] %&gt;% summary()</span></span>
<span id="cb61-13"><a href="#cb61-13"></a></span>
<span id="cb61-14"><a href="#cb61-14"></a>emadata_nested_wrangled_unthresholded_shuffled &lt;-<span class="st"> </span>emadata_nested_wrangled_shuffled <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb61-15"><a href="#cb61-15"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">unthresholded_shuffled =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> data_daily_standardised_shuffled, </span>
<span id="cb61-16"><a href="#cb61-16"></a>                                        <span class="dt">.f =</span> <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rp</span>(.x, </span>
<span id="cb61-17"><a href="#cb61-17"></a>                                                         <span class="dt">doEmbed =</span> <span class="ot">FALSE</span>)))</span>
<span id="cb61-18"><a href="#cb61-18"></a></span>
<span id="cb61-19"><a href="#cb61-19"></a></span>
<span id="cb61-20"><a href="#cb61-20"></a>emadata_nested_wrangled_unthresholded_shuffled &lt;-<span class="st"> </span>emadata_nested_wrangled_unthresholded_shuffled <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb61-21"><a href="#cb61-21"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">unthresholded_plot_shuffled =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> unthresholded_shuffled, </span>
<span id="cb61-22"><a href="#cb61-22"></a>                                                <span class="dt">.f =</span> <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rp_plot</span>(.x, </span>
<span id="cb61-23"><a href="#cb61-23"></a>                                                                      <span class="dt">title =</span> <span class="st">&quot;E)&quot;</span>,</span>
<span id="cb61-24"><a href="#cb61-24"></a>                                                                      <span class="dt">xlabel =</span> <span class="st">&quot;Shuffled system&quot;</span>,</span>
<span id="cb61-25"><a href="#cb61-25"></a>                                                                      <span class="dt">ylabel =</span> <span class="st">&quot;Shuffled system&quot;</span>,</span>
<span id="cb61-26"><a href="#cb61-26"></a>                                                                      <span class="dt">plotRadiusRRbar =</span> <span class="ot">FALSE</span>, </span>
<span id="cb61-27"><a href="#cb61-27"></a>                                                                      <span class="dt">plotDimensions =</span> <span class="ot">TRUE</span>)))</span>
<span id="cb61-28"><a href="#cb61-28"></a></span>
<span id="cb61-29"><a href="#cb61-29"></a>emadata_nested_wrangled_both_shuffled &lt;-<span class="st"> </span>emadata_nested_wrangled_unthresholded_shuffled <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb61-30"><a href="#cb61-30"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">thresholded_shuffled =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> data_daily_standardised_shuffled, </span>
<span id="cb61-31"><a href="#cb61-31"></a>                                        <span class="dt">.f =</span> <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rp</span>(.x, </span>
<span id="cb61-32"><a href="#cb61-32"></a>                                                         <span class="dt">doEmbed =</span> <span class="ot">FALSE</span>,</span>
<span id="cb61-33"><a href="#cb61-33"></a>                                                         <span class="dt">emRad =</span> <span class="ot">NA</span>,</span>
<span id="cb61-34"><a href="#cb61-34"></a>                                                         <span class="dt">doPlot =</span> <span class="ot">TRUE</span>,</span>
<span id="cb61-35"><a href="#cb61-35"></a>                                                         <span class="dt">xlabel =</span> <span class="st">&quot; &quot;</span>,</span>
<span id="cb61-36"><a href="#cb61-36"></a>                                                         <span class="dt">ylabel =</span> <span class="st">&quot; &quot;</span>)))</span>
<span id="cb61-37"><a href="#cb61-37"></a></span>
<span id="cb61-38"><a href="#cb61-38"></a></span>
<span id="cb61-39"><a href="#cb61-39"></a></span>
<span id="cb61-40"><a href="#cb61-40"></a><span class="co"># At 15 Dec 2019, crqa_rp is deprecated but called by rp_plot when plotMeasures = TRUE. This hack helps:</span></span>
<span id="cb61-41"><a href="#cb61-41"></a>crqa_rp &lt;-<span class="st"> </span>casnet<span class="op">::</span>rp_measures</span>
<span id="cb61-42"><a href="#cb61-42"></a></span>
<span id="cb61-43"><a href="#cb61-43"></a>emadata_nested_wrangled_both_shuffled &lt;-<span class="st"> </span>emadata_nested_wrangled_both_shuffled <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb61-44"><a href="#cb61-44"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">thresholded_plot_shuffled =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> thresholded_shuffled, </span>
<span id="cb61-45"><a href="#cb61-45"></a>                                              <span class="dt">.f =</span> <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rp_plot</span>(.x,</span>
<span id="cb61-46"><a href="#cb61-46"></a>                                                                    <span class="dt">title =</span> <span class="st">&quot;F)&quot;</span>,</span>
<span id="cb61-47"><a href="#cb61-47"></a>                                                                    <span class="dt">xlabel =</span> <span class="st">&quot;Shuffled system&quot;</span>,</span>
<span id="cb61-48"><a href="#cb61-48"></a>                                                                    <span class="dt">ylabel =</span> <span class="st">&quot;Shuffled system&quot;</span>,</span>
<span id="cb61-49"><a href="#cb61-49"></a>                                                                    <span class="dt">plotRadiusRRbar =</span> <span class="ot">FALSE</span>, </span>
<span id="cb61-50"><a href="#cb61-50"></a>                                                                    <span class="dt">plotDimensions =</span> <span class="ot">TRUE</span>,</span>
<span id="cb61-51"><a href="#cb61-51"></a>                                                                    <span class="dt">plotMeasures =</span> <span class="ot">FALSE</span>)))</span>
<span id="cb61-52"><a href="#cb61-52"></a></span>
<span id="cb61-53"><a href="#cb61-53"></a>emadata_nested_wrangled_both_withMeasures_shuffled &lt;-<span class="st"> </span>emadata_nested_wrangled_both_shuffled <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb61-54"><a href="#cb61-54"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">measures_shuffled =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> thresholded_shuffled, </span>
<span id="cb61-55"><a href="#cb61-55"></a>                                              <span class="dt">.f =</span> <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rp_measures</span>(.x,</span>
<span id="cb61-56"><a href="#cb61-56"></a>                                                                        <span class="dt">emRad =</span> <span class="ot">NA</span>)))</span></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a></span>
<span id="cb62-2"><a href="#cb62-2"></a><span class="kw">set.seed</span>(<span class="dv">999</span>)</span>
<span id="cb62-3"><a href="#cb62-3"></a>emadata_dailyAverages &lt;-<span class="st"> </span>emadata_nested_wrangled_both_withMeasures<span class="op">$</span>data_firstlast_divided_by_max[[<span class="dv">1</span>]] <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb62-4"><a href="#cb62-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">uniform_noise =</span> </span>
<span id="cb62-5"><a href="#cb62-5"></a>                  <span class="kw">runif</span>(<span class="dt">n =</span> <span class="kw">nrow</span>(emadata_nested_wrangled_both_withMeasures<span class="op">$</span>data_firstlast_divided_by_max[[<span class="dv">1</span>]]), </span>
<span id="cb62-6"><a href="#cb62-6"></a>                                      <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">49</span>))</span>
<span id="cb62-7"><a href="#cb62-7"></a></span>
<span id="cb62-8"><a href="#cb62-8"></a>emRad &lt;-<span class="st"> </span>casnet<span class="op">::</span><span class="kw">est_radius</span>(<span class="dt">y1 =</span> emadata_dailyAverages<span class="op">$</span>uniform_noise, <span class="dt">emLag =</span> <span class="dv">1</span>, <span class="dt">emDim =</span> <span class="dv">1</span>)<span class="op">$</span>Radius</span>
<span id="cb62-9"><a href="#cb62-9"></a></span>
<span id="cb62-10"><a href="#cb62-10"></a><span class="co"># out &lt;- casnet::crqa_cl(emadata_dailyAverages$uniform_noise, emDim = emDim, emLag = emLag, emRad = emRad)</span></span>
<span id="cb62-11"><a href="#cb62-11"></a></span>
<span id="cb62-12"><a href="#cb62-12"></a>RM &lt;-<span class="st"> </span>casnet<span class="op">::</span><span class="kw">rp</span>(<span class="dt">y1 =</span> emadata_dailyAverages<span class="op">$</span>uniform_noise, <span class="dt">emDim =</span> <span class="dv">1</span>, <span class="dt">emLag =</span> <span class="dv">1</span>)</span>
<span id="cb62-13"><a href="#cb62-13"></a></span>
<span id="cb62-14"><a href="#cb62-14"></a>uniform_noise_unthresholded &lt;-<span class="st"> </span>casnet<span class="op">::</span><span class="kw">rp_plot</span>(RM, </span>
<span id="cb62-15"><a href="#cb62-15"></a>                                               <span class="dt">title =</span> <span class="st">&quot;A)&quot;</span>,</span>
<span id="cb62-16"><a href="#cb62-16"></a>                                               <span class="dt">xlabel =</span> <span class="st">&quot;Uniform noise&quot;</span>,</span>
<span id="cb62-17"><a href="#cb62-17"></a>                                               <span class="dt">ylabel =</span> <span class="st">&quot;Uniform noise&quot;</span>,</span>
<span id="cb62-18"><a href="#cb62-18"></a>                                               <span class="dt">plotRadiusRRbar =</span> <span class="ot">FALSE</span>,</span>
<span id="cb62-19"><a href="#cb62-19"></a>                                               <span class="dt">drawGrid =</span> <span class="ot">FALSE</span>,</span>
<span id="cb62-20"><a href="#cb62-20"></a>                                               <span class="dt">plotDimensions =</span> <span class="ot">TRUE</span>)</span>
<span id="cb62-21"><a href="#cb62-21"></a></span>
<span id="cb62-22"><a href="#cb62-22"></a>RM_thresholded &lt;-<span class="st"> </span>casnet<span class="op">::</span><span class="kw">di2bi</span>(RM, <span class="dt">emRad =</span> emRad)</span>
<span id="cb62-23"><a href="#cb62-23"></a></span>
<span id="cb62-24"><a href="#cb62-24"></a>uniform_noise_thresholded &lt;-<span class="st"> </span>casnet<span class="op">::</span><span class="kw">rp_plot</span>(RM_thresholded, </span>
<span id="cb62-25"><a href="#cb62-25"></a>                                             <span class="dt">title =</span> <span class="st">&quot;B)&quot;</span>,</span>
<span id="cb62-26"><a href="#cb62-26"></a>                                             <span class="dt">xlabel =</span> <span class="st">&quot;Uniform noise&quot;</span>,</span>
<span id="cb62-27"><a href="#cb62-27"></a>                                             <span class="dt">ylabel =</span> <span class="st">&quot;Uniform noise&quot;</span>,</span>
<span id="cb62-28"><a href="#cb62-28"></a>                                             <span class="dt">plotDimensions =</span> <span class="ot">TRUE</span>,</span>
<span id="cb62-29"><a href="#cb62-29"></a>                                             <span class="dt">plotMeasures =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p>In the figure below: The first column (A-B) is a plot made out of a series of random numbers. The middle column (C-D) depicts the result, where a single participant’s responses on several motivation-related variables are subjected to multi-dimensional Recurrence Quantification Analysis (Wallot, 2019; Wallot et al., 2016; Wallot &amp; Leonardi, 2018). The rightmost column (E-F) represents surrogate data, where the participant’s responses are shuffled to dismantle the temporal structure; this shuffling can be done repeatedly to produce confidence intervals for recurrence-based complexity measures.</p>
<ul>
<li><p>Wallot, S., &amp; Leonardi, G. (2018). Analyzing Multivariate Dynamics Using Cross-Recurrence Quantification Analysis (CRQA), Diagonal-Cross-Recurrence Profiles (DCRP), and Multidimensional Recurrence Quantification Analysis (MdRQA) – A Tutorial in R. Frontiers in Psychology, 9. <a href="https://doi.org/10.3389/fpsyg.2018.02232" class="uri">https://doi.org/10.3389/fpsyg.2018.02232</a></p></li>
<li><p>Wallot, S., Roepstorff, A., &amp; Mønster, D. (2016). Multidimensional Recurrence Quantification Analysis (MdRQA) for the Analysis of Multidimensional Time-Series: A Software Implementation in MATLAB and Its Application to Group-Level Data in Joint Action. Frontiers in Psychology, 7. <a href="https://doi.org/10.3389/fpsyg.2016.01835" class="uri">https://doi.org/10.3389/fpsyg.2016.01835</a></p></li>
<li><p>Wallot, S. (2019). Multidimensional Cross-Recurrence Quantification Analysis (MdCRQA) – A Method for Quantifying Correlation between Multivariate Time-Series. Multivariate Behavioral Research, 54(2), 173–191. <a href="https://doi.org/10.1080/00273171.2018.1512846" class="uri">https://doi.org/10.1080/00273171.2018.1512846</a></p></li>
</ul>
<p>The upper row (panels A, C and E) shows unthresholded distance matrices, where each cell represents a measurement occasion, with red colours indicating the value is close (as measured by Euclidean distance) to the corresponding time point on the other axis, while blue colours indicate the contrary, and white implies an intermediate distance. The lower row (Panels B, D and F) shows recurrence plots, where the unthresholded distance matrices have been binarised—leaving only 5% of the closest points—leading to thresholded plots from which quantitative indicators can be calculated. Black points indicate the same or a similar value (in case of B) or a similar configuration “profile” (in case of D and F) occurring. Because values always recur with themselves, we observe full recurrence in the diagonal line.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a></span>
<span id="cb63-2"><a href="#cb63-2"></a>rqa_plot &lt;-<span class="st"> </span>gridExtra<span class="op">::</span><span class="kw">grid.arrange</span>(uniform_noise_unthresholded,</span>
<span id="cb63-3"><a href="#cb63-3"></a>                        uniform_noise_thresholded,</span>
<span id="cb63-4"><a href="#cb63-4"></a>                        emadata_nested_wrangled_both_withMeasures<span class="op">$</span>unthresholded_plot[[<span class="dv">1</span>]],</span>
<span id="cb63-5"><a href="#cb63-5"></a>                        emadata_nested_wrangled_both_withMeasures<span class="op">$</span>thresholded_plot[[<span class="dv">1</span>]],</span>
<span id="cb63-6"><a href="#cb63-6"></a>                        emadata_nested_wrangled_both_withMeasures_shuffled<span class="op">$</span>unthresholded_plot_shuffled[[<span class="dv">1</span>]],</span>
<span id="cb63-7"><a href="#cb63-7"></a>                        emadata_nested_wrangled_both_withMeasures_shuffled<span class="op">$</span>thresholded_plot_shuffled[[<span class="dv">1</span>]],</span>
<span id="cb63-8"><a href="#cb63-8"></a>                        <span class="dt">layout_matrix =</span> <span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>,</span>
<span id="cb63-9"><a href="#cb63-9"></a>                                                 <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>), </span>
<span id="cb63-10"><a href="#cb63-10"></a>                                               <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/rqa-plots-create-1.png" width="2100" /></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a></span>
<span id="cb64-2"><a href="#cb64-2"></a>rqa_plot</span>
<span id="cb64-3"><a href="#cb64-3"></a><span class="co">## TableGrob (2 x 3) &quot;arrange&quot;: 6 grobs</span></span>
<span id="cb64-4"><a href="#cb64-4"></a><span class="co">##   z     cells    name              grob</span></span>
<span id="cb64-5"><a href="#cb64-5"></a><span class="co">## 1 1 (1-1,1-1) arrange gtable[di_rp_dim]</span></span>
<span id="cb64-6"><a href="#cb64-6"></a><span class="co">## 2 2 (2-2,1-1) arrange gtable[bi_rp_dim]</span></span>
<span id="cb64-7"><a href="#cb64-7"></a><span class="co">## 3 3 (1-1,2-2) arrange gtable[di_rp_dim]</span></span>
<span id="cb64-8"><a href="#cb64-8"></a><span class="co">## 4 4 (2-2,2-2) arrange gtable[bi_rp_dim]</span></span>
<span id="cb64-9"><a href="#cb64-9"></a><span class="co">## 5 5 (1-1,3-3) arrange gtable[di_rp_dim]</span></span>
<span id="cb64-10"><a href="#cb64-10"></a><span class="co">## 6 6 (2-2,3-3) arrange gtable[bi_rp_dim]</span></span>
<span id="cb64-11"><a href="#cb64-11"></a></span>
<span id="cb64-12"><a href="#cb64-12"></a><span class="co"># ggsave(&quot;./figures/rqa_multiplot.png&quot;, rqa_plot, width = 11.69, height = 8.27, dpi = 300)</span></span></code></pre></div>
<p>Quantification of temporal patterns is done by extracting complexity measures from line structures in a recurrence plot; the detailed process is beyond the scope here, but fully described in Marwan, Romano, Thiel, &amp; Kurths (pp. 251 and 263-283).</p>
<p>Marwan, N., Romano, M. C., Thiel, M., &amp; Kurths, J. (2007). Recurrence plots for the analysis of complex systems. Physics Reports, 438(5), 237–329. <a href="https://doi.org/10.1016/j.physrep.2006.11.001" class="uri">https://doi.org/10.1016/j.physrep.2006.11.001</a></p>
<p>The table below shows four complexity measures derived from the three recurrence plots (B, D and F) above. Main difference is in Laminarity; the observed real data has much more points forming vertical lines than either of the comparisons. Notably, Trapping Time indicates the length of these line segments does not differ between conditions.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a></span>
<span id="cb65-2"><a href="#cb65-2"></a>measures_multiplot &lt;-<span class="st"> </span></span>
<span id="cb65-3"><a href="#cb65-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">bind_rows</span>(emadata_nested_wrangled_both_withMeasures_uniform,</span>
<span id="cb65-4"><a href="#cb65-4"></a>                   emadata_nested_wrangled_both_withMeasures<span class="op">$</span>measures[[<span class="dv">1</span>]],</span>
<span id="cb65-5"><a href="#cb65-5"></a>                   emadata_nested_wrangled_both_withMeasures_shuffled<span class="op">$</span>measures_shuffled[[<span class="dv">1</span>]]) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb65-6"><a href="#cb65-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Condition =</span> <span class="kw">c</span>(<span class="st">&quot;Uniform noise&quot;</span>,</span>
<span id="cb65-7"><a href="#cb65-7"></a>                              <span class="st">&quot;6-dimensional motivation system&quot;</span>,</span>
<span id="cb65-8"><a href="#cb65-8"></a>                              <span class="st">&quot;Shuffled system&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb65-9"><a href="#cb65-9"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(Condition,</span>
<span id="cb65-10"><a href="#cb65-10"></a>                <span class="dt">Determinism =</span> DET,</span>
<span id="cb65-11"><a href="#cb65-11"></a>                <span class="dt">Laminarity =</span> LAM_vl, <span class="co"># vl and hl are the same</span></span>
<span id="cb65-12"><a href="#cb65-12"></a>                <span class="st">&quot;Trapping Time&quot;</span> =<span class="st"> </span>TT_vl, </span>
<span id="cb65-13"><a href="#cb65-13"></a>                <span class="dt">Entropy =</span> ENT_vl)</span>
<span id="cb65-14"><a href="#cb65-14"></a></span>
<span id="cb65-15"><a href="#cb65-15"></a>measures_multiplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate_if</span>(is.numeric, round, <span class="dt">digits =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb65-16"><a href="#cb65-16"></a><span class="st">  </span>knitr<span class="op">::</span><span class="kw">kable</span>(.)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Condition</th>
<th align="right">Determinism</th>
<th align="right">Laminarity</th>
<th align="right">Trapping Time</th>
<th align="right">Entropy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Uniform noise</td>
<td align="right">0.138</td>
<td align="right">0.048</td>
<td align="right">2.000</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">6-dimensional motivation system</td>
<td align="right">0.091</td>
<td align="right">0.243</td>
<td align="right">2.022</td>
<td align="right">0.107</td>
</tr>
<tr class="odd">
<td align="left">Shuffled system</td>
<td align="right">0.065</td>
<td align="right">0.067</td>
<td align="right">2.083</td>
<td align="right">0.287</td>
</tr>
</tbody>
</table>
</div>
<div id="cross-recurrence-quantification-analysis" class="section level1">
<h1>Cross-Recurrence Quantification Analysis</h1>
<p>Cross-Recurrence Quantification Analysis, or CRQA, is a method of studying the coupling of two time series. As with other types of RQA, the first step of the analysis involves creating recurrence plots. In recurrence plots, the re-occurrence of values is visualised by plotting a time series against another time series (to explore cross-recurrence) or itself (to explore auto-recurrence). Figure below depicts a cross-recurrence plot of two hypothetical time series with discrete states coded as 1 to 6: Yellow (1, 5, 4, 3, 2, 6) and Blue (5, 4, 3, 4, 3, 2). Black cells indicate places where the same value occurs in both series.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a></span>
<span id="cb66-2"><a href="#cb66-2"></a><span class="co"># knitr::include_graphics(path = &quot;./figures/rqa_pedagogical.png&quot;)</span></span>
<span id="cb66-3"><a href="#cb66-3"></a></span>
<span id="cb66-4"><a href="#cb66-4"></a>grid<span class="op">::</span><span class="kw">grid.raster</span>(png<span class="op">::</span><span class="kw">readPNG</span>(<span class="st">&quot;./figures/rqa_pedagogical.png&quot;</span>))</span></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/rqa-pedagogical-1.png" width="330.8" /></p>
<p>These data show a switch in the system state: the blue series precedes the yellow one until time 3-4, after which the yellow series precedes the blue one. While this is merely a pedagogical example (a time series of only six observations would rarely be sufficient to reliably identify patterns), it illustrates the utility of the method in identifying patterns in time series data. For a more in-depth treatment, see:</p>
<ul>
<li><p>Wallot, S., &amp; Leonardi, G. (2018). Analyzing Multivariate Dynamics Using Cross-Recurrence Quantification Analysis (CRQA), Diagonal-Cross-Recurrence Profiles (DCRP), and Multidimensional Recurrence Quantification Analysis (MdRQA) – A Tutorial in R. Frontiers in Psychology, 9. <a href="https://doi.org/10.3389/fpsyg.2018.02232" class="uri">https://doi.org/10.3389/fpsyg.2018.02232</a></p></li>
<li><p>Coco, M. I., &amp; Dale, R. (2014). Cross-recurrence quantification analysis of categorical and continuous time series: an R package. Frontiers in Psychology, 5. <a href="https://doi.org/10.3389/fpsyg.2014.00510" class="uri">https://doi.org/10.3389/fpsyg.2014.00510</a></p></li>
</ul>
</div>
<div id="session-information" class="section level1">
<h1>Session information</h1>
<p>Description of the R environment can be found below.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>devtools<span class="op">::</span><span class="kw">session_info</span>()</span>
<span id="cb67-2"><a href="#cb67-2"></a><span class="co">## - Session info ---------------------------------------------------------------</span></span>
<span id="cb67-3"><a href="#cb67-3"></a><span class="co">##  setting  value                       </span></span>
<span id="cb67-4"><a href="#cb67-4"></a><span class="co">##  version  R version 3.6.1 (2019-07-05)</span></span>
<span id="cb67-5"><a href="#cb67-5"></a><span class="co">##  os       Windows 10 x64              </span></span>
<span id="cb67-6"><a href="#cb67-6"></a><span class="co">##  system   x86_64, mingw32             </span></span>
<span id="cb67-7"><a href="#cb67-7"></a><span class="co">##  ui       RTerm                       </span></span>
<span id="cb67-8"><a href="#cb67-8"></a><span class="co">##  language (EN)                        </span></span>
<span id="cb67-9"><a href="#cb67-9"></a><span class="co">##  collate  Finnish_Finland.1252        </span></span>
<span id="cb67-10"><a href="#cb67-10"></a><span class="co">##  ctype    Finnish_Finland.1252        </span></span>
<span id="cb67-11"><a href="#cb67-11"></a><span class="co">##  tz       Europe/Helsinki             </span></span>
<span id="cb67-12"><a href="#cb67-12"></a><span class="co">##  date     2020-04-23                  </span></span>
<span id="cb67-13"><a href="#cb67-13"></a><span class="co">## </span></span>
<span id="cb67-14"><a href="#cb67-14"></a><span class="co">## - Packages -------------------------------------------------------------------</span></span>
<span id="cb67-15"><a href="#cb67-15"></a><span class="co">##  package      * version date       lib source                               </span></span>
<span id="cb67-16"><a href="#cb67-16"></a><span class="co">##  assertthat     0.2.1   2019-03-21 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-17"><a href="#cb67-17"></a><span class="co">##  backports      1.1.5   2019-10-02 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-18"><a href="#cb67-18"></a><span class="co">##  BiocManager    1.30.10 2019-11-16 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-19"><a href="#cb67-19"></a><span class="co">##  broom          0.5.5   2020-02-29 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-20"><a href="#cb67-20"></a><span class="co">##  callr          3.4.2   2020-02-12 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-21"><a href="#cb67-21"></a><span class="co">##  casnet         0.1.5   2020-01-30 [1] Github (fredhasselman/casnet@35ee389)</span></span>
<span id="cb67-22"><a href="#cb67-22"></a><span class="co">##  cellranger     1.1.0   2016-07-27 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-23"><a href="#cb67-23"></a><span class="co">##  cli            2.0.2   2020-02-28 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-24"><a href="#cb67-24"></a><span class="co">##  codetools      0.2-16  2018-12-24 [2] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-25"><a href="#cb67-25"></a><span class="co">##  colorspace     1.4-1   2019-03-18 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-26"><a href="#cb67-26"></a><span class="co">##  cowplot        1.0.0   2019-07-11 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-27"><a href="#cb67-27"></a><span class="co">##  crayon         1.3.4   2017-09-16 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-28"><a href="#cb67-28"></a><span class="co">##  DBI            1.1.0   2019-12-15 [1] CRAN (R 3.6.2)                       </span></span>
<span id="cb67-29"><a href="#cb67-29"></a><span class="co">##  dbplyr         1.4.2   2019-06-17 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-30"><a href="#cb67-30"></a><span class="co">##  desc           1.2.0   2018-05-01 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-31"><a href="#cb67-31"></a><span class="co">##  devtools       2.2.2   2020-02-17 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-32"><a href="#cb67-32"></a><span class="co">##  digest         0.6.25  2020-02-23 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-33"><a href="#cb67-33"></a><span class="co">##  dplyr        * 0.8.5   2020-03-07 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-34"><a href="#cb67-34"></a><span class="co">##  ellipsis       0.3.0   2019-09-20 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-35"><a href="#cb67-35"></a><span class="co">##  evaluate       0.14    2019-05-28 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-36"><a href="#cb67-36"></a><span class="co">##  fansi          0.4.1   2020-01-08 [1] CRAN (R 3.6.2)                       </span></span>
<span id="cb67-37"><a href="#cb67-37"></a><span class="co">##  farver         2.0.3   2020-01-16 [1] CRAN (R 3.6.2)                       </span></span>
<span id="cb67-38"><a href="#cb67-38"></a><span class="co">##  forcats      * 0.5.0   2020-03-01 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-39"><a href="#cb67-39"></a><span class="co">##  fs             1.3.2   2020-03-05 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-40"><a href="#cb67-40"></a><span class="co">##  generics       0.0.2   2018-11-29 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-41"><a href="#cb67-41"></a><span class="co">##  gganimate      1.0.5   2020-02-09 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-42"><a href="#cb67-42"></a><span class="co">##  ggimage        0.2.7   2020-01-09 [1] CRAN (R 3.6.2)                       </span></span>
<span id="cb67-43"><a href="#cb67-43"></a><span class="co">##  ggplot2      * 3.3.0   2020-03-05 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-44"><a href="#cb67-44"></a><span class="co">##  ggplotify      0.0.5   2020-03-12 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-45"><a href="#cb67-45"></a><span class="co">##  glue           1.3.2   2020-03-12 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-46"><a href="#cb67-46"></a><span class="co">##  gridExtra      2.3     2017-09-09 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-47"><a href="#cb67-47"></a><span class="co">##  gridGraphics   0.5-0   2020-02-25 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-48"><a href="#cb67-48"></a><span class="co">##  gtable         0.3.0   2019-03-25 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-49"><a href="#cb67-49"></a><span class="co">##  haven          2.2.0   2019-11-08 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-50"><a href="#cb67-50"></a><span class="co">##  highr          0.8     2019-03-20 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-51"><a href="#cb67-51"></a><span class="co">##  hms            0.5.3   2020-01-08 [1] CRAN (R 3.6.2)                       </span></span>
<span id="cb67-52"><a href="#cb67-52"></a><span class="co">##  htmltools      0.4.0   2019-10-04 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-53"><a href="#cb67-53"></a><span class="co">##  httr           1.4.1   2019-08-05 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-54"><a href="#cb67-54"></a><span class="co">##  igraph         1.2.4.2 2019-11-27 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-55"><a href="#cb67-55"></a><span class="co">##  invctr         0.1.0   2019-03-07 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-56"><a href="#cb67-56"></a><span class="co">##  jsonlite       1.6.1   2020-02-02 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-57"><a href="#cb67-57"></a><span class="co">##  knitr          1.28    2020-02-06 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-58"><a href="#cb67-58"></a><span class="co">##  labeling       0.3     2014-08-23 [1] CRAN (R 3.6.0)                       </span></span>
<span id="cb67-59"><a href="#cb67-59"></a><span class="co">##  lattice        0.20-40 2020-02-19 [2] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-60"><a href="#cb67-60"></a><span class="co">##  lifecycle      0.2.0   2020-03-06 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-61"><a href="#cb67-61"></a><span class="co">##  lubridate      1.7.4   2018-04-11 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-62"><a href="#cb67-62"></a><span class="co">##  magick         2.3     2020-01-24 [1] CRAN (R 3.6.2)                       </span></span>
<span id="cb67-63"><a href="#cb67-63"></a><span class="co">##  magrittr       1.5     2014-11-22 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-64"><a href="#cb67-64"></a><span class="co">##  Matrix         1.2-18  2019-11-27 [2] CRAN (R 3.6.2)                       </span></span>
<span id="cb67-65"><a href="#cb67-65"></a><span class="co">##  memoise        1.1.0   2017-04-21 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-66"><a href="#cb67-66"></a><span class="co">##  modelr         0.1.6   2020-02-22 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-67"><a href="#cb67-67"></a><span class="co">##  munsell        0.5.0   2018-06-12 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-68"><a href="#cb67-68"></a><span class="co">##  nlme           3.1-145 2020-03-04 [2] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-69"><a href="#cb67-69"></a><span class="co">##  pillar         1.4.3   2019-12-20 [1] CRAN (R 3.6.2)                       </span></span>
<span id="cb67-70"><a href="#cb67-70"></a><span class="co">##  pkgbuild       1.0.6   2019-10-09 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-71"><a href="#cb67-71"></a><span class="co">##  pkgconfig      2.0.3   2019-09-22 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-72"><a href="#cb67-72"></a><span class="co">##  pkgload        1.0.2   2018-10-29 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-73"><a href="#cb67-73"></a><span class="co">##  plyr           1.8.6   2020-03-03 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-74"><a href="#cb67-74"></a><span class="co">##  png            0.1-7   2013-12-03 [1] CRAN (R 3.6.0)                       </span></span>
<span id="cb67-75"><a href="#cb67-75"></a><span class="co">##  prettyunits    1.1.1   2020-01-24 [1] CRAN (R 3.6.2)                       </span></span>
<span id="cb67-76"><a href="#cb67-76"></a><span class="co">##  processx       3.4.2   2020-02-09 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-77"><a href="#cb67-77"></a><span class="co">##  progress       1.2.2   2019-05-16 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-78"><a href="#cb67-78"></a><span class="co">##  proxy          0.4-23  2019-03-05 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-79"><a href="#cb67-79"></a><span class="co">##  ps             1.3.2   2020-02-13 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-80"><a href="#cb67-80"></a><span class="co">##  purrr        * 0.3.3   2019-10-18 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-81"><a href="#cb67-81"></a><span class="co">##  R6             2.4.1   2019-11-12 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-82"><a href="#cb67-82"></a><span class="co">##  Rcpp           1.0.4   2020-03-17 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-83"><a href="#cb67-83"></a><span class="co">##  readr        * 1.3.1   2018-12-21 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-84"><a href="#cb67-84"></a><span class="co">##  readxl         1.3.1   2019-03-13 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-85"><a href="#cb67-85"></a><span class="co">##  remotes        2.1.1   2020-02-15 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-86"><a href="#cb67-86"></a><span class="co">##  reprex         0.3.0   2019-05-16 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-87"><a href="#cb67-87"></a><span class="co">##  reshape2       1.4.3   2017-12-11 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-88"><a href="#cb67-88"></a><span class="co">##  rlang          0.4.5   2020-03-01 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-89"><a href="#cb67-89"></a><span class="co">##  rmarkdown      2.1     2020-01-20 [1] CRAN (R 3.6.2)                       </span></span>
<span id="cb67-90"><a href="#cb67-90"></a><span class="co">##  rprojroot      1.3-2   2018-01-03 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-91"><a href="#cb67-91"></a><span class="co">##  rstudioapi     0.11    2020-02-07 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-92"><a href="#cb67-92"></a><span class="co">##  rvcheck        0.1.8   2020-03-01 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-93"><a href="#cb67-93"></a><span class="co">##  rvest          0.3.5   2019-11-08 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-94"><a href="#cb67-94"></a><span class="co">##  scales         1.1.0   2019-11-18 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-95"><a href="#cb67-95"></a><span class="co">##  sessioninfo    1.1.1   2018-11-05 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-96"><a href="#cb67-96"></a><span class="co">##  stringi        1.4.6   2020-02-17 [1] CRAN (R 3.6.2)                       </span></span>
<span id="cb67-97"><a href="#cb67-97"></a><span class="co">##  stringr      * 1.4.0   2019-02-10 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-98"><a href="#cb67-98"></a><span class="co">##  testthat       2.3.2   2020-03-02 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-99"><a href="#cb67-99"></a><span class="co">##  tibble       * 2.1.3   2019-06-06 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-100"><a href="#cb67-100"></a><span class="co">##  tidyr        * 1.0.2   2020-01-24 [1] CRAN (R 3.6.2)                       </span></span>
<span id="cb67-101"><a href="#cb67-101"></a><span class="co">##  tidyselect     1.0.0   2020-01-27 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-102"><a href="#cb67-102"></a><span class="co">##  tidyverse    * 1.3.0   2019-11-21 [1] CRAN (R 3.6.2)                       </span></span>
<span id="cb67-103"><a href="#cb67-103"></a><span class="co">##  tweenr         1.0.1   2018-12-14 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-104"><a href="#cb67-104"></a><span class="co">##  usethis        1.5.1   2019-07-04 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-105"><a href="#cb67-105"></a><span class="co">##  vctrs          0.2.4   2020-03-10 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-106"><a href="#cb67-106"></a><span class="co">##  viridisLite    0.3.0   2018-02-01 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-107"><a href="#cb67-107"></a><span class="co">##  withr          2.1.2   2018-03-15 [1] CRAN (R 3.6.1)                       </span></span>
<span id="cb67-108"><a href="#cb67-108"></a><span class="co">##  xfun           0.12    2020-01-13 [1] CRAN (R 3.6.2)                       </span></span>
<span id="cb67-109"><a href="#cb67-109"></a><span class="co">##  xml2           1.2.5   2020-03-11 [1] CRAN (R 3.6.3)                       </span></span>
<span id="cb67-110"><a href="#cb67-110"></a><span class="co">##  xts            0.12-0  2020-01-19 [1] CRAN (R 3.6.2)                       </span></span>
<span id="cb67-111"><a href="#cb67-111"></a><span class="co">##  yaml           2.2.1   2020-02-01 [1] CRAN (R 3.6.2)                       </span></span>
<span id="cb67-112"><a href="#cb67-112"></a><span class="co">##  zoo            1.8-7   2020-01-10 [1] CRAN (R 3.6.2)                       </span></span>
<span id="cb67-113"><a href="#cb67-113"></a><span class="co">## </span></span>
<span id="cb67-114"><a href="#cb67-114"></a><span class="co">## [1] C:/localdata/hema/rlibs</span></span>
<span id="cb67-115"><a href="#cb67-115"></a><span class="co">## [2] C:/Program Files/R/R-3.6.1/library</span></span>
<span id="cb67-116"><a href="#cb67-116"></a></span>
<span id="cb67-117"><a href="#cb67-117"></a>pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">sessionInfo</span>())</span></code></pre></div>
<p><strong>R version 3.6.1 (2019-07-05)</strong></p>
<p><strong>Platform:</strong> x86_64-w64-mingw32/x64 (64-bit)</p>
<p><strong>locale:</strong> <em>LC_COLLATE=Finnish_Finland.1252</em>, <em>LC_CTYPE=Finnish_Finland.1252</em>, <em>LC_MONETARY=Finnish_Finland.1252</em>, <em>LC_NUMERIC=C</em> and <em>LC_TIME=Finnish_Finland.1252</em></p>
<p><strong>attached base packages:</strong> <em>stats</em>, <em>graphics</em>, <em>grDevices</em>, <em>utils</em>, <em>datasets</em>, <em>methods</em> and <em>base</em></p>
<p><strong>other attached packages:</strong> <em>forcats(v.0.5.0)</em>, <em>stringr(v.1.4.0)</em>, <em>dplyr(v.0.8.5)</em>, <em>purrr(v.0.3.3)</em>, <em>readr(v.1.3.1)</em>, <em>tidyr(v.1.0.2)</em>, <em>tibble(v.2.1.3)</em>, <em>ggplot2(v.3.3.0)</em> and <em>tidyverse(v.1.3.0)</em></p>
<p><strong>loaded via a namespace (and not attached):</strong> <em>nlme(v.3.1-145)</em>, <em>fs(v.1.3.2)</em>, <em>usethis(v.1.5.1)</em>, <em>invctr(v.0.1.0)</em>, <em>xts(v.0.12-0)</em>, <em>lubridate(v.1.7.4)</em>, <em>devtools(v.2.2.2)</em>, <em>progress(v.1.2.2)</em>, <em>httr(v.1.4.1)</em>, <em>rprojroot(v.1.3-2)</em>, <em>tools(v.3.6.1)</em>, <em>backports(v.1.1.5)</em>, <em>R6(v.2.4.1)</em>, <em>DBI(v.1.1.0)</em>, <em>colorspace(v.1.4-1)</em>, <em>withr(v.2.1.2)</em>, <em>tidyselect(v.1.0.0)</em>, <em>gridExtra(v.2.3)</em>, <em>prettyunits(v.1.1.1)</em>, <em>processx(v.3.4.2)</em>, <em>compiler(v.3.6.1)</em>, <em>cli(v.2.0.2)</em>, <em>rvest(v.0.3.5)</em>, <em>xml2(v.1.2.5)</em>, <em>desc(v.1.2.0)</em>, <em>labeling(v.0.3)</em>, <em>scales(v.1.1.0)</em>, <em>callr(v.3.4.2)</em>, <em>proxy(v.0.4-23)</em>, <em>digest(v.0.6.25)</em>, <em>rmarkdown(v.2.1)</em>, <em>pkgconfig(v.2.0.3)</em>, <em>htmltools(v.0.4.0)</em>, <em>sessioninfo(v.1.1.1)</em>, <em>casnet(v.0.1.5)</em>, <em>dbplyr(v.1.4.2)</em>, <em>highr(v.0.8)</em>, <em>rlang(v.0.4.5)</em>, <em>readxl(v.1.3.1)</em>, <em>rstudioapi(v.0.11)</em>, <em>gridGraphics(v.0.5-0)</em>, <em>farver(v.2.0.3)</em>, <em>generics(v.0.0.2)</em>, <em>zoo(v.1.8-7)</em>, <em>jsonlite(v.1.6.1)</em>, <em>magrittr(v.1.5)</em>, <em>ggplotify(v.0.0.5)</em>, <em>Matrix(v.1.2-18)</em>, <em>Rcpp(v.1.0.4)</em>, <em>munsell(v.0.5.0)</em>, <em>fansi(v.0.4.1)</em>, <em>lifecycle(v.0.2.0)</em>, <em>stringi(v.1.4.6)</em>, <em>yaml(v.2.2.1)</em>, <em>pkgbuild(v.1.0.6)</em>, <em>plyr(v.1.8.6)</em>, <em>grid(v.3.6.1)</em>, <em>crayon(v.1.3.4)</em>, <em>lattice(v.0.20-40)</em>, <em>haven(v.2.2.0)</em>, <em>cowplot(v.1.0.0)</em>, <em>pander(v.0.6.3)</em>, <em>hms(v.0.5.3)</em>, <em>magick(v.2.3)</em>, <em>ps(v.1.3.2)</em>, <em>knitr(v.1.28)</em>, <em>pillar(v.1.4.3)</em>, <em>igraph(v.1.2.4.2)</em>, <em>pkgload(v.1.0.2)</em>, <em>reshape2(v.1.4.3)</em>, <em>codetools(v.0.2-16)</em>, <em>reprex(v.0.3.0)</em>, <em>glue(v.1.3.2)</em>, <em>evaluate(v.0.14)</em>, <em>ggimage(v.0.2.7)</em>, <em>gganimate(v.1.0.5)</em>, <em>remotes(v.2.1.1)</em>, <em>BiocManager(v.1.30.10)</em>, <em>modelr(v.0.1.6)</em>, <em>vctrs(v.0.2.4)</em>, <em>png(v.0.1-7)</em>, <em>tweenr(v.1.0.1)</em>, <em>testthat(v.2.3.2)</em>, <em>cellranger(v.1.1.0)</em>, <em>gtable(v.0.3.0)</em>, <em>assertthat(v.0.2.1)</em>, <em>xfun(v.0.12)</em>, <em>broom(v.0.5.5)</em>, <em>viridisLite(v.0.3.0)</em>, <em>rvcheck(v.0.1.8)</em>, <em>memoise(v.1.1.0)</em> and <em>ellipsis(v.0.3.0)</em></p>
<!-- </div> -->
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
