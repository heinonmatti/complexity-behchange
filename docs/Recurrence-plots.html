<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Recurrence plots</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Complexity in behaviour change</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">About</a>
</li>
<li>
  <a href="psyarxiv-in-progress">Manuscript</a>
</li>
<li>
  <a href="assumption-tests.html">Assumption tests</a>
</li>
<li>
  <a href="Recurrence-plots.html">Recurrence Quantification Analysis</a>
</li>
<li>
  <a href="dataset-info.html">Dataset</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Recurrence plots</h1>

</div>


<!-- <div style="line-height: 1.7em;"> -->
<p>Source code for this document is found <a href="https://raw.githubusercontent.com/heinonmatti/complexity-behchange/master/Recurrence-plots.Rmd">here</a>.</p>
<p>In this document, we provide supplementary information about recurrence quantification analysis, with examples of recurrence measures that can be extracted from recurrence plots. We also provide code for the figures in the manuscript.</p>
<div id="recurrence-measures" class="section level1 tabset">
<h1>Recurrence measures</h1>
<div id="trend" class="section level2">
<h2>Trend</h2>
<p>What it depicts: The stationarity of the system, i.e. whether the recurrent patterns emerge homogenously across the plot (indicating system stationarity), or if they fade to the lower right or and upper left corners (indicating the system changes in time, is non-stationarity). For example, a time series of any gradually but surely increasing or decreasing numbers would show a high trend value, whereas a series in which values fluctuate around more or less the same values, would exhibit a low trend value.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"></a>
<a class="sourceLine" id="cb1-2" title="2">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;./figures/RQA_measures/trendlo.PNG&quot;</span>)</a></code></pre></div>
<p><img src="figures/RQA_measures/trendlo.PNG" width="640" /></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;./figures/RQA_measures/trendhi.PNG&quot;</span>)</a></code></pre></div>
<p><img src="figures/RQA_measures/trendhi.PNG" width="640" /></p>
</div>
<div id="determinism" class="section level2">
<h2>Determinism</h2>
<p>What it depicts: The proportion of all recurrent points which land on diagonal lines, meaning that there is a pattern to re-occurrence. For example, motivation for physical activity might be high (or low) on the same weekdays for several weeks in a row, indicating high determinism. Sleep-wake cycles would also show high determinism, whereas random numbers would show no discernable patterns and the lowest possible determinism values.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"></a>
<a class="sourceLine" id="cb3-2" title="2">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;./figures/RQA_measures/determinismlo.PNG&quot;</span>)</a></code></pre></div>
<p><img src="figures/RQA_measures/determinismlo.PNG" width="640" /></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;./figures/RQA_measures/determinismhi.PNG&quot;</span>)</a></code></pre></div>
<p><img src="figures/RQA_measures/determinismhi.PNG" width="640" /></p>
</div>
<div id="trapping-time-and-laminarity" class="section level2">
<h2>Trapping time and Laminarity</h2>
<p>What it depicts: Laminarity is the proportion or recurrent points, which form vertical lines. Trapping time, on the other hand, depicts the average length of vertical line structures; it quantifies the time series’ tendency to get “stuck” on particular values or states. Trapping time could indicate a lack of healthy variability*, which in turn could be indicative of a system performing suboptimally or exhibiting maladaptive behaviour.</p>
<p>* Navarro, J., &amp; Rueff-Lopes, R. (2015). Healthy variability in organizational behavior: Empirical evidence and new steps for future research. Nonlinear Dynamics, Psychology, and Life Sciences, 19(4), 529–552.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"></a>
<a class="sourceLine" id="cb5-2" title="2">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;./figures/RQA_measures/trappingtimelo.PNG&quot;</span>)</a></code></pre></div>
<p><img src="figures/RQA_measures/trappingtimelo.PNG" width="640" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;./figures/RQA_measures/trappingtimehi.PNG&quot;</span>)</a></code></pre></div>
<p><img src="figures/RQA_measures/trappingtimehi.PNG" width="640" /></p>
</div>
<div id="entropy" class="section level2">
<h2>Entropy</h2>
<p>What it depicts: The complexity or unpredictability of pattern lengths (i.e. variability in the length of the lines that are parallel to the diagonal); the heart rate of a person playing in a soccer match would show high entropy, whereas their heart rate in a training session of regular timed sprints would show low entropy.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"></a>
<a class="sourceLine" id="cb7-2" title="2">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;./figures/RQA_measures/entropylo.PNG&quot;</span>)</a></code></pre></div>
<p><img src="figures/RQA_measures/entropylo.PNG" width="640" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;./figures/RQA_measures/entropyhi.PNG&quot;</span>)</a></code></pre></div>
<p><img src="figures/RQA_measures/entropyhi.PNG" width="640" /></p>
</div>
<div id="average-diagonal-line-length" class="section level2">
<h2>Average diagonal line length</h2>
<p>What it depicts: The average length of the diagonal line structures, that is, the average time the system repeats a behavioural sequence it has exhibited previously. This can be thought of e.g. as a person’s (or their motivational system’s) consistency in repeating habitual behaviour, such as walking many steps during weekdays and little during weekends; a weekend with many steps (or a weekday with few steps) would break this pattern and reduce the average diagonal line length. Hence: While entropy can be thought of as a type of variance of the diagonal lines lengths, average diagonal line length would represent their mean length. Average diagonal line length can also be interpreted as the mean prediction time.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"></a>
<a class="sourceLine" id="cb9-2" title="2">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;./figures/RQA_measures/averagelinelengthlo.PNG&quot;</span>)</a></code></pre></div>
<p><img src="figures/RQA_measures/averagelinelengthlo.PNG" width="640" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="dt">path =</span> <span class="st">&quot;./figures/RQA_measures/averagelinelengthhi.PNG&quot;</span>)</a></code></pre></div>
<p><img src="figures/RQA_measures/averagelinelengthhi.PNG" width="640" /></p>
</div>
</div>
<div id="section" class="section level1 unnumbered">
<h1></h1>
<p>Possible substantive research questions include:</p>
<ul>
<li>Is trapping time related to inflexible behaviour (e.g., inability to adapt to environmental demands), and are interventions that lessen it analogous to “loosening up” a person’s reaction repertoire?</li>
<li>Does an intervention destabilise the dynamics of a maladaptive target behaviour, leading to increased entropy in recurrence structures?</li>
<li>At which periods in a time series is the target behaviour stationary, and do initiations of trends collide with interventions, indicating intervention’s impact?</li>
<li>How is determinism connected to facets of habit theory?</li>
<li>Does average diagonal line length go down (conferring decreased predictability with past data) when an intervention is introduced, indicating a shift in the system’s dynamics?</li>
</ul>
</div>
<div id="rqa-figure-in-manuscript" class="section level1">
<h1>RQA figure in manuscript</h1>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">emadata &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_rds</span>(<span class="st">&quot;./data/EMA_data_Moti13.RDS&quot;</span>)</a>
<a class="sourceLine" id="cb11-2" title="2"></a>
<a class="sourceLine" id="cb11-3" title="3">emadata_nested &lt;-<span class="st"> </span>emadata <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(User) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="st">                  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="co">#autonomy, competence, relatedness,</span></a>
<a class="sourceLine" id="cb11-5" title="5">                                pleasure, interest, importance,</a>
<a class="sourceLine" id="cb11-6" title="6">                                <span class="dt">situation_requires =</span> required, </a>
<a class="sourceLine" id="cb11-7" title="7">                                <span class="dt">anxiety_guilt_avoidance =</span> anxiety_guilt, </a>
<a class="sourceLine" id="cb11-8" title="8">                                <span class="dt">another_wants =</span> for_others,</a>
<a class="sourceLine" id="cb11-9" title="9">                                <span class="dt">Date =</span> dateTime,</a>
<a class="sourceLine" id="cb11-10" title="10">                                User,</a>
<a class="sourceLine" id="cb11-11" title="11">                                task) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-12" title="12"><span class="st">                  </span><span class="kw">na.omit</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="co">### </span><span class="al">NOTE</span><span class="co">! NAs removed!</span></a>
<a class="sourceLine" id="cb11-13" title="13"><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">nest</span>() </a>
<a class="sourceLine" id="cb11-14" title="14"></a>
<a class="sourceLine" id="cb11-15" title="15"><span class="co"># Show sample size for each participant:</span></a>
<a class="sourceLine" id="cb11-16" title="16"><span class="co"># emadata_nested %&gt;% </span></a>
<a class="sourceLine" id="cb11-17" title="17"><span class="co">#   mutate(n = map_dbl(data, nrow))</span></a>
<a class="sourceLine" id="cb11-18" title="18"></a>
<a class="sourceLine" id="cb11-19" title="19">emadata_nested_wrangled &lt;-<span class="st"> </span>emadata_nested <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-20" title="20"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data =</span> purrr<span class="op">::</span><span class="kw">map</span>(data, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate</span>(.x, </a>
<a class="sourceLine" id="cb11-21" title="21">                                                       <span class="dt">date =</span> <span class="kw">as.Date</span>(Date),</a>
<a class="sourceLine" id="cb11-22" title="22">                                                       <span class="dt">timediff =</span> <span class="kw">c</span>(<span class="ot">NA</span>, <span class="kw">diff</span>(Date))))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-23" title="23"><span class="st">  </span><span class="co"># Filter out answers less than 15 minutes from the last one, then remove the difference variable</span></a>
<a class="sourceLine" id="cb11-24" title="24"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data =</span> purrr<span class="op">::</span><span class="kw">map</span>(data, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">filter</span>(.x, timediff <span class="op">&gt;</span><span class="st"> </span><span class="dv">15</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-25" title="25"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data =</span> purrr<span class="op">::</span><span class="kw">map</span>(data, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">select</span>(.x, <span class="op">-</span>timediff))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-26" title="26"><span class="st">  </span><span class="co"># Create &quot;task-normed&quot; variables, where the previous instance of the task is substracted from the current one:</span></a>
<a class="sourceLine" id="cb11-27" title="27"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">taskNormed =</span> purrr<span class="op">::</span><span class="kw">map</span>(data, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">group_by</span>(., task))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-28" title="28"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">taskNormed =</span> purrr<span class="op">::</span><span class="kw">map</span>(taskNormed, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate_if</span>(.x, is.numeric, <span class="op">~</span>(.<span class="op">-</span><span class="kw">lag</span>(.))))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-29" title="29"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">taskNormed =</span> purrr<span class="op">::</span><span class="kw">map</span>(taskNormed, <span class="op">~</span><span class="kw">na.omit</span>(.x))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-30" title="30"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">taskNormed =</span> purrr<span class="op">::</span><span class="kw">map</span>(taskNormed, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">ungroup</span>(.x))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-31" title="31"><span class="st">  </span><span class="co"># # Take daily averages to ensure ~equally spaced observations: </span></a>
<a class="sourceLine" id="cb11-32" title="32"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data_daily =</span> purrr<span class="op">::</span><span class="kw">map</span>(data, </a>
<a class="sourceLine" id="cb11-33" title="33">                                        <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">group_by</span>(., date))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-34" title="34"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data_daily =</span> purrr<span class="op">::</span><span class="kw">map</span>(data_daily, </a>
<a class="sourceLine" id="cb11-35" title="35">                                        <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">summarise_if</span>(.x, is.numeric, mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-36" title="36"><span class="st">  </span><span class="co"># Remove day and task variables</span></a>
<a class="sourceLine" id="cb11-37" title="37"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data_with_tasks_and_dates =</span> data,</a>
<a class="sourceLine" id="cb11-38" title="38">                <span class="dt">data =</span> purrr<span class="op">::</span><span class="kw">map</span>(data, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">select</span>(.x, <span class="op">-</span>Date, <span class="op">-</span>date, <span class="op">-</span>task))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-39" title="39"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data_daily_with_tasks_and_dates =</span> data_daily,</a>
<a class="sourceLine" id="cb11-40" title="40">                <span class="dt">data_daily =</span> purrr<span class="op">::</span><span class="kw">map</span>(data_daily, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">select</span>(.x, <span class="op">-</span>date))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-41" title="41"><span class="st">  </span><span class="co"># Normalise all numeric variables</span></a>
<a class="sourceLine" id="cb11-42" title="42"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data_standardised =</span> purrr<span class="op">::</span><span class="kw">map</span>(data, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate_if</span>(.x, is.numeric,</a>
<a class="sourceLine" id="cb11-43" title="43">                                                           <span class="op">~</span>((.x <span class="op">/</span><span class="st"> </span><span class="kw">max</span>(.x)))))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-44" title="44"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data_daily_standardised =</span> purrr<span class="op">::</span><span class="kw">map</span>(data_daily, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate_if</span>(.x, is.numeric,</a>
<a class="sourceLine" id="cb11-45" title="45">                                                           <span class="op">~</span>((.x <span class="op">/</span><span class="st"> </span><span class="kw">max</span>(.x)))))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-46" title="46"><span class="st">  </span><span class="co"># Retain first and last observation of the day:</span></a>
<a class="sourceLine" id="cb11-47" title="47"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data_firstlast_divided_by_max =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> data_with_tasks_and_dates, </a>
<a class="sourceLine" id="cb11-48" title="48">                                           <span class="dt">.f =</span> <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">group_by</span>(.x, date) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-49" title="49"><span class="st">                                             </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(Date) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-50" title="50"><span class="st">                                             </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">row_number</span>() <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span><span class="kw">row_number</span>() <span class="op">==</span><span class="st"> </span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-51" title="51"><span class="st">                                             </span>dplyr<span class="op">::</span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-52" title="52"><span class="st">                                             </span>dplyr<span class="op">::</span><span class="kw">mutate_if</span>(., is.numeric,</a>
<a class="sourceLine" id="cb11-53" title="53">                                                              <span class="op">~</span>(. <span class="op">/</span><span class="st"> </span><span class="kw">max</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)))),</a>
<a class="sourceLine" id="cb11-54" title="54">                <span class="dt">data_firstlast_divided_by_max_with_tasks_and_dates =</span> data_firstlast_divided_by_max,</a>
<a class="sourceLine" id="cb11-55" title="55">                <span class="dt">data_firstlast_divided_by_max =</span> purrr<span class="op">::</span><span class="kw">map</span>(data_firstlast_divided_by_max, </a>
<a class="sourceLine" id="cb11-56" title="56">                                                           <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">select</span>(.x, <span class="op">-</span>Date, <span class="op">-</span>date, <span class="op">-</span>task)))</a></code></pre></div>
<!-- NOTE TO READER: In what follows, chunks alternate between include = FALSE and eval = FALSE. The first performs the operation, and the second is there to show the code; this, because otherwise a lot of clutter is reported even though message = FALSE and warning = FALSE. -->
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">emadata_nested_wrangled_unthresholded &lt;-<span class="st"> </span>emadata_nested_wrangled <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">unthresholded =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> data_firstlast_divided_by_max, </a>
<a class="sourceLine" id="cb12-3" title="3">                                        <span class="dt">.f =</span> <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rp</span>(.x, </a>
<a class="sourceLine" id="cb12-4" title="4">                                                         <span class="dt">doEmbed =</span> <span class="ot">FALSE</span>)))</a>
<a class="sourceLine" id="cb12-5" title="5"></a>
<a class="sourceLine" id="cb12-6" title="6"></a>
<a class="sourceLine" id="cb12-7" title="7">emadata_nested_wrangled_unthresholded &lt;-<span class="st"> </span>emadata_nested_wrangled_unthresholded <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">unthresholded_plot =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> unthresholded, </a>
<a class="sourceLine" id="cb12-9" title="9">                                                <span class="dt">.f =</span> <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rp_plot</span>(.x, </a>
<a class="sourceLine" id="cb12-10" title="10">                                                                      <span class="dt">title =</span> <span class="st">&quot;C)&quot;</span>,</a>
<a class="sourceLine" id="cb12-11" title="11">                                                                      <span class="dt">xlabel =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>,</a>
<a class="sourceLine" id="cb12-12" title="12">                                                                      <span class="dt">ylabel =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>,</a>
<a class="sourceLine" id="cb12-13" title="13">                                                                      <span class="dt">plotRadiusRRbar =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb12-14" title="14">                                                                      <span class="dt">plotDimensions =</span> <span class="ot">TRUE</span>)))</a>
<a class="sourceLine" id="cb12-15" title="15"></a>
<a class="sourceLine" id="cb12-16" title="16">emadata_nested_wrangled_both &lt;-<span class="st"> </span>emadata_nested_wrangled_unthresholded <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-17" title="17"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">thresholded =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> data_firstlast_divided_by_max, </a>
<a class="sourceLine" id="cb12-18" title="18">                                        <span class="dt">.f =</span> <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rp</span>(.x, </a>
<a class="sourceLine" id="cb12-19" title="19">                                                         <span class="dt">doEmbed =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb12-20" title="20">                                                         <span class="dt">emRad =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb12-21" title="21">                                                         <span class="dt">doPlot =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb12-22" title="22">                                                         <span class="dt">xlabel =</span> <span class="st">&quot; &quot;</span>,</a>
<a class="sourceLine" id="cb12-23" title="23">                                                         <span class="dt">ylabel =</span> <span class="st">&quot; &quot;</span>)))</a>
<a class="sourceLine" id="cb12-24" title="24"></a>
<a class="sourceLine" id="cb12-25" title="25"></a>
<a class="sourceLine" id="cb12-26" title="26"></a>
<a class="sourceLine" id="cb12-27" title="27"><span class="co"># At 15 Dec 2019, crqa_rp is deprecated but called by rp_plot when plotMeasures = TRUE. This hack helps:</span></a>
<a class="sourceLine" id="cb12-28" title="28">crqa_rp &lt;-<span class="st"> </span>casnet<span class="op">::</span>rp_measures</a>
<a class="sourceLine" id="cb12-29" title="29"></a>
<a class="sourceLine" id="cb12-30" title="30">emadata_nested_wrangled_both &lt;-<span class="st"> </span>emadata_nested_wrangled_both <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-31" title="31"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">thresholded_plot =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> thresholded, </a>
<a class="sourceLine" id="cb12-32" title="32">                                              <span class="dt">.f =</span> <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rp_plot</span>(.x,</a>
<a class="sourceLine" id="cb12-33" title="33">                                                                    <span class="dt">title =</span> <span class="st">&quot;D)&quot;</span>,</a>
<a class="sourceLine" id="cb12-34" title="34">                                                                    <span class="dt">xlabel =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>,</a>
<a class="sourceLine" id="cb12-35" title="35">                                                                    <span class="dt">ylabel =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>,</a>
<a class="sourceLine" id="cb12-36" title="36">                                                                    <span class="dt">plotRadiusRRbar =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb12-37" title="37">                                                                    <span class="dt">plotDimensions =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb12-38" title="38">                                                                    <span class="dt">plotMeasures =</span> <span class="ot">FALSE</span>)))</a>
<a class="sourceLine" id="cb12-39" title="39"></a>
<a class="sourceLine" id="cb12-40" title="40">emadata_nested_wrangled_both_withMeasures &lt;-<span class="st"> </span>emadata_nested_wrangled_both <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-41" title="41"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">measures =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> thresholded, </a>
<a class="sourceLine" id="cb12-42" title="42">                                              <span class="dt">.f =</span> <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rp_measures</span>(.x,</a>
<a class="sourceLine" id="cb12-43" title="43">                                                                        <span class="dt">emRad =</span> <span class="ot">NA</span>)))</a>
<a class="sourceLine" id="cb12-44" title="44"></a>
<a class="sourceLine" id="cb12-45" title="45"><span class="co"># Bring all the RQA measures into one data frame (from: https://stackoverflow.com/questions/2851327/convert-a-list-of-data-frames-into-one-data-frame):</span></a>
<a class="sourceLine" id="cb12-46" title="46">complexity_measures &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">bind_rows</span>(emadata_nested_wrangled_both_withMeasures<span class="op">$</span>measures, <span class="dt">.id =</span> <span class="st">&quot;rowNumber&quot;</span>)</a>
<a class="sourceLine" id="cb12-47" title="47"><span class="co"># User ID is not the same as row number, so take the id from the earlier object: </span></a>
<a class="sourceLine" id="cb12-48" title="48">complexity_measures<span class="op">$</span>userID &lt;-<span class="st"> </span>emadata_nested_wrangled_both_withMeasures<span class="op">$</span>User</a></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="kw">set.seed</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb13-3" title="3">emadata_nested_wrangled_shuffled &lt;-<span class="st"> </span>emadata_nested_wrangled <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data_daily_standardised_shuffled =</span> </a>
<a class="sourceLine" id="cb13-5" title="5">                  purrr<span class="op">::</span><span class="kw">map</span>(data_firstlast_divided_by_max, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate_if</span>(.x, is.numeric,</a>
<a class="sourceLine" id="cb13-6" title="6">                                                                         <span class="op">~</span>(<span class="kw">sample</span>(., </a>
<a class="sourceLine" id="cb13-7" title="7">                                                                                  <span class="dt">size =</span> <span class="kw">length</span>(.), </a>
<a class="sourceLine" id="cb13-8" title="8">                                                                                  <span class="dt">replace =</span> <span class="ot">FALSE</span>)))))</a>
<a class="sourceLine" id="cb13-9" title="9"></a>
<a class="sourceLine" id="cb13-10" title="10"><span class="co"># # These are the same, i.e. shuffling didn&#39;t change summary stats:</span></a>
<a class="sourceLine" id="cb13-11" title="11"><span class="co"># emadata_nested_wrangled$data_daily_standardised[[1]] %&gt;% summary()</span></a>
<a class="sourceLine" id="cb13-12" title="12"><span class="co"># emadata_nested_wrangled_shuffled$data_daily_standardised_shuffled[[1]] %&gt;% summary()</span></a>
<a class="sourceLine" id="cb13-13" title="13"></a>
<a class="sourceLine" id="cb13-14" title="14">emadata_nested_wrangled_unthresholded_shuffled &lt;-<span class="st"> </span>emadata_nested_wrangled_shuffled <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-15" title="15"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">unthresholded_shuffled =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> data_daily_standardised_shuffled, </a>
<a class="sourceLine" id="cb13-16" title="16">                                        <span class="dt">.f =</span> <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rp</span>(.x, </a>
<a class="sourceLine" id="cb13-17" title="17">                                                         <span class="dt">doEmbed =</span> <span class="ot">FALSE</span>)))</a>
<a class="sourceLine" id="cb13-18" title="18"></a>
<a class="sourceLine" id="cb13-19" title="19"></a>
<a class="sourceLine" id="cb13-20" title="20">emadata_nested_wrangled_unthresholded_shuffled &lt;-<span class="st"> </span>emadata_nested_wrangled_unthresholded_shuffled <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-21" title="21"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">unthresholded_plot_shuffled =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> unthresholded_shuffled, </a>
<a class="sourceLine" id="cb13-22" title="22">                                                <span class="dt">.f =</span> <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rp_plot</span>(.x, </a>
<a class="sourceLine" id="cb13-23" title="23">                                                                      <span class="dt">title =</span> <span class="st">&quot;E)&quot;</span>,</a>
<a class="sourceLine" id="cb13-24" title="24">                                                                      <span class="dt">xlabel =</span> <span class="st">&quot;Shuffled system&quot;</span>,</a>
<a class="sourceLine" id="cb13-25" title="25">                                                                      <span class="dt">ylabel =</span> <span class="st">&quot;Shuffled system&quot;</span>,</a>
<a class="sourceLine" id="cb13-26" title="26">                                                                      <span class="dt">plotRadiusRRbar =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb13-27" title="27">                                                                      <span class="dt">plotDimensions =</span> <span class="ot">TRUE</span>)))</a>
<a class="sourceLine" id="cb13-28" title="28"></a>
<a class="sourceLine" id="cb13-29" title="29">emadata_nested_wrangled_both_shuffled &lt;-<span class="st"> </span>emadata_nested_wrangled_unthresholded_shuffled <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-30" title="30"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">thresholded_shuffled =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> data_daily_standardised_shuffled, </a>
<a class="sourceLine" id="cb13-31" title="31">                                        <span class="dt">.f =</span> <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rp</span>(.x, </a>
<a class="sourceLine" id="cb13-32" title="32">                                                         <span class="dt">doEmbed =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb13-33" title="33">                                                         <span class="dt">emRad =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb13-34" title="34">                                                         <span class="dt">doPlot =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb13-35" title="35">                                                         <span class="dt">xlabel =</span> <span class="st">&quot; &quot;</span>,</a>
<a class="sourceLine" id="cb13-36" title="36">                                                         <span class="dt">ylabel =</span> <span class="st">&quot; &quot;</span>)))</a>
<a class="sourceLine" id="cb13-37" title="37"></a>
<a class="sourceLine" id="cb13-38" title="38"></a>
<a class="sourceLine" id="cb13-39" title="39"></a>
<a class="sourceLine" id="cb13-40" title="40"><span class="co"># At 15 Dec 2019, crqa_rp is deprecated but called by rp_plot when plotMeasures = TRUE. This hack helps:</span></a>
<a class="sourceLine" id="cb13-41" title="41">crqa_rp &lt;-<span class="st"> </span>casnet<span class="op">::</span>rp_measures</a>
<a class="sourceLine" id="cb13-42" title="42"></a>
<a class="sourceLine" id="cb13-43" title="43">emadata_nested_wrangled_both_shuffled &lt;-<span class="st"> </span>emadata_nested_wrangled_both_shuffled <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-44" title="44"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">thresholded_plot_shuffled =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> thresholded_shuffled, </a>
<a class="sourceLine" id="cb13-45" title="45">                                              <span class="dt">.f =</span> <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rp_plot</span>(.x,</a>
<a class="sourceLine" id="cb13-46" title="46">                                                                    <span class="dt">title =</span> <span class="st">&quot;F)&quot;</span>,</a>
<a class="sourceLine" id="cb13-47" title="47">                                                                    <span class="dt">xlabel =</span> <span class="st">&quot;Shuffled system&quot;</span>,</a>
<a class="sourceLine" id="cb13-48" title="48">                                                                    <span class="dt">ylabel =</span> <span class="st">&quot;Shuffled system&quot;</span>,</a>
<a class="sourceLine" id="cb13-49" title="49">                                                                    <span class="dt">plotRadiusRRbar =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb13-50" title="50">                                                                    <span class="dt">plotDimensions =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb13-51" title="51">                                                                    <span class="dt">plotMeasures =</span> <span class="ot">FALSE</span>)))</a>
<a class="sourceLine" id="cb13-52" title="52"></a>
<a class="sourceLine" id="cb13-53" title="53">emadata_nested_wrangled_both_withMeasures_shuffled &lt;-<span class="st"> </span>emadata_nested_wrangled_both_shuffled <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-54" title="54"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">measures_shuffled =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> thresholded_shuffled, </a>
<a class="sourceLine" id="cb13-55" title="55">                                              <span class="dt">.f =</span> <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rp_measures</span>(.x,</a>
<a class="sourceLine" id="cb13-56" title="56">                                                                        <span class="dt">emRad =</span> <span class="ot">NA</span>)))</a></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="kw">set.seed</span>(<span class="dv">999</span>)</a>
<a class="sourceLine" id="cb14-3" title="3">emadata_dailyAverages &lt;-<span class="st"> </span>emadata_nested_wrangled_both_withMeasures<span class="op">$</span>data_firstlast_divided_by_max[[<span class="dv">1</span>]] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">uniform_noise =</span> </a>
<a class="sourceLine" id="cb14-5" title="5">                  <span class="kw">runif</span>(<span class="dt">n =</span> <span class="kw">nrow</span>(emadata_nested_wrangled_both_withMeasures<span class="op">$</span>data_firstlast_divided_by_max[[<span class="dv">1</span>]]), </a>
<a class="sourceLine" id="cb14-6" title="6">                                      <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">49</span>))</a>
<a class="sourceLine" id="cb14-7" title="7"></a>
<a class="sourceLine" id="cb14-8" title="8">emRad &lt;-<span class="st"> </span>casnet<span class="op">::</span><span class="kw">est_radius</span>(<span class="dt">y1 =</span> emadata_dailyAverages<span class="op">$</span>uniform_noise, <span class="dt">emLag =</span> <span class="dv">1</span>, <span class="dt">emDim =</span> <span class="dv">1</span>)<span class="op">$</span>Radius</a>
<a class="sourceLine" id="cb14-9" title="9"></a>
<a class="sourceLine" id="cb14-10" title="10"><span class="co"># out &lt;- casnet::crqa_cl(emadata_dailyAverages$uniform_noise, emDim = emDim, emLag = emLag, emRad = emRad)</span></a>
<a class="sourceLine" id="cb14-11" title="11"></a>
<a class="sourceLine" id="cb14-12" title="12">RM &lt;-<span class="st"> </span>casnet<span class="op">::</span><span class="kw">rp</span>(<span class="dt">y1 =</span> emadata_dailyAverages<span class="op">$</span>uniform_noise, <span class="dt">emDim =</span> <span class="dv">1</span>, <span class="dt">emLag =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb14-13" title="13"></a>
<a class="sourceLine" id="cb14-14" title="14">uniform_noise_unthresholded &lt;-<span class="st"> </span>casnet<span class="op">::</span><span class="kw">rp_plot</span>(RM, </a>
<a class="sourceLine" id="cb14-15" title="15">                                               <span class="dt">title =</span> <span class="st">&quot;A)&quot;</span>,</a>
<a class="sourceLine" id="cb14-16" title="16">                                               <span class="dt">xlabel =</span> <span class="st">&quot;Uniform noise&quot;</span>,</a>
<a class="sourceLine" id="cb14-17" title="17">                                               <span class="dt">ylabel =</span> <span class="st">&quot;Uniform noise&quot;</span>,</a>
<a class="sourceLine" id="cb14-18" title="18">                                               <span class="dt">plotRadiusRRbar =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb14-19" title="19">                                               <span class="dt">drawGrid =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb14-20" title="20">                                               <span class="dt">plotDimensions =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-21" title="21"></a>
<a class="sourceLine" id="cb14-22" title="22">RM_thresholded &lt;-<span class="st"> </span>casnet<span class="op">::</span><span class="kw">di2bi</span>(RM, <span class="dt">emRad =</span> emRad)</a>
<a class="sourceLine" id="cb14-23" title="23"></a>
<a class="sourceLine" id="cb14-24" title="24">uniform_noise_thresholded &lt;-<span class="st"> </span>casnet<span class="op">::</span><span class="kw">rp_plot</span>(RM_thresholded, </a>
<a class="sourceLine" id="cb14-25" title="25">                                             <span class="dt">title =</span> <span class="st">&quot;B)&quot;</span>,</a>
<a class="sourceLine" id="cb14-26" title="26">                                             <span class="dt">xlabel =</span> <span class="st">&quot;Uniform noise&quot;</span>,</a>
<a class="sourceLine" id="cb14-27" title="27">                                             <span class="dt">ylabel =</span> <span class="st">&quot;Uniform noise&quot;</span>,</a>
<a class="sourceLine" id="cb14-28" title="28">                                             <span class="dt">plotDimensions =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb14-29" title="29">                                             <span class="dt">plotMeasures =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>In the figure below: Columns, from left to right depict plots of uniformly distributed noise (A-B), a 6-dimensional motivation system of a single participant (C-D), and the same system with shuffled values (E-F). Panels A, C and E show unthresholded distance matrices, where each cell (or pixel) represents a measurement occasion, with red colours indicating the value is close to the corresponding time point on the other axis, while blue colours indicate the contrary. Panels B, D and F show recurrence plots, where these unthresholded plots have been binarised—leaving only 5% of the closest points—leading to thresholded plots from which quantitative indicators can be calculated. Black points indicate the same or a similar value (in case of B) or a similar configuration “profile” (in case of D and F) occurring.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"></a>
<a class="sourceLine" id="cb15-2" title="2">rqa_plot &lt;-<span class="st"> </span>gridExtra<span class="op">::</span><span class="kw">grid.arrange</span>(uniform_noise_unthresholded,</a>
<a class="sourceLine" id="cb15-3" title="3">                        uniform_noise_thresholded,</a>
<a class="sourceLine" id="cb15-4" title="4">                        emadata_nested_wrangled_both_withMeasures<span class="op">$</span>unthresholded_plot[[<span class="dv">1</span>]],</a>
<a class="sourceLine" id="cb15-5" title="5">                        emadata_nested_wrangled_both_withMeasures<span class="op">$</span>thresholded_plot[[<span class="dv">1</span>]],</a>
<a class="sourceLine" id="cb15-6" title="6">                        emadata_nested_wrangled_both_withMeasures_shuffled<span class="op">$</span>unthresholded_plot_shuffled[[<span class="dv">1</span>]],</a>
<a class="sourceLine" id="cb15-7" title="7">                        emadata_nested_wrangled_both_withMeasures_shuffled<span class="op">$</span>thresholded_plot_shuffled[[<span class="dv">1</span>]],</a>
<a class="sourceLine" id="cb15-8" title="8">                        <span class="dt">layout_matrix =</span> <span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb15-9" title="9">                                                 <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>), </a>
<a class="sourceLine" id="cb15-10" title="10">                                               <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">FALSE</span>))</a></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/rqa-plots-create-1.png" width="672" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"></a>
<a class="sourceLine" id="cb16-2" title="2">rqa_plot</a>
<a class="sourceLine" id="cb16-3" title="3"><span class="co">## TableGrob (2 x 3) &quot;arrange&quot;: 6 grobs</span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="co">##   z     cells    name              grob</span></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="co">## 1 1 (1-1,1-1) arrange gtable[di_rp_dim]</span></a>
<a class="sourceLine" id="cb16-6" title="6"><span class="co">## 2 2 (2-2,1-1) arrange gtable[bi_rp_dim]</span></a>
<a class="sourceLine" id="cb16-7" title="7"><span class="co">## 3 3 (1-1,2-2) arrange gtable[di_rp_dim]</span></a>
<a class="sourceLine" id="cb16-8" title="8"><span class="co">## 4 4 (2-2,2-2) arrange gtable[bi_rp_dim]</span></a>
<a class="sourceLine" id="cb16-9" title="9"><span class="co">## 5 5 (1-1,3-3) arrange gtable[di_rp_dim]</span></a>
<a class="sourceLine" id="cb16-10" title="10"><span class="co">## 6 6 (2-2,3-3) arrange gtable[bi_rp_dim]</span></a>
<a class="sourceLine" id="cb16-11" title="11"></a>
<a class="sourceLine" id="cb16-12" title="12"><span class="co"># ggsave(&quot;./figures/rqa_multiplot.png&quot;, rqa_plot, width = 11.69, height = 8.27, dpi = 300)</span></a></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"></a>
<a class="sourceLine" id="cb17-2" title="2">measures_multiplot &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">bind_rows</span>(emadata_nested_wrangled_both_withMeasures_uniform,</a>
<a class="sourceLine" id="cb17-4" title="4">                   emadata_nested_wrangled_both_withMeasures<span class="op">$</span>measures[[<span class="dv">1</span>]],</a>
<a class="sourceLine" id="cb17-5" title="5">                   emadata_nested_wrangled_both_withMeasures_shuffled<span class="op">$</span>measures_shuffled[[<span class="dv">1</span>]]) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Condition =</span> <span class="kw">c</span>(<span class="st">&quot;Uniform noise&quot;</span>,</a>
<a class="sourceLine" id="cb17-7" title="7">                              <span class="st">&quot;6-dimensional motivation system&quot;</span>,</a>
<a class="sourceLine" id="cb17-8" title="8">                              <span class="st">&quot;Shuffled system&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-9" title="9"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(Condition,</a>
<a class="sourceLine" id="cb17-10" title="10">                <span class="dt">Determinism =</span> DET,</a>
<a class="sourceLine" id="cb17-11" title="11">                <span class="dt">Laminarity =</span> LAM_vl, <span class="co"># vl and hl are the same</span></a>
<a class="sourceLine" id="cb17-12" title="12">                <span class="st">&quot;Trapping Time&quot;</span> =<span class="st"> </span>TT_vl, </a>
<a class="sourceLine" id="cb17-13" title="13">                <span class="dt">Entropy =</span> ENT_vl)</a>
<a class="sourceLine" id="cb17-14" title="14"></a>
<a class="sourceLine" id="cb17-15" title="15">measures_multiplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate_if</span>(is.numeric, round, <span class="dt">digits =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-16" title="16"><span class="st">  </span>knitr<span class="op">::</span><span class="kw">kable</span>(.,</a>
<a class="sourceLine" id="cb17-17" title="17">               <span class="dt">caption =</span> </a>
<a class="sourceLine" id="cb17-18" title="18">                 <span class="st">&quot;Complexity measures derived from the three recurrence plots.</span></a>
<a class="sourceLine" id="cb17-19" title="19"><span class="st">                  Main difference is in Laminarity; the observed real data has</span></a>
<a class="sourceLine" id="cb17-20" title="20"><span class="st">                  much more points forming vertical lines than either of the </span></a>
<a class="sourceLine" id="cb17-21" title="21"><span class="st">                  comparisons. Notably, Trapping Time indicates the length of </span></a>
<a class="sourceLine" id="cb17-22" title="22"><span class="st">                  these line segments does not differ between conditions.&quot;</span>)</a></code></pre></div>
<table>
<caption>Complexity measures derived from the three recurrence plots. Main difference is in Laminarity; the observed real data has much more points forming vertical lines than either of the comparisons. Notably, Trapping Time indicates the length of these line segments does not differ between conditions.</caption>
<thead>
<tr class="header">
<th align="left">Condition</th>
<th align="right">Determinism</th>
<th align="right">Laminarity</th>
<th align="right">Trapping Time</th>
<th align="right">Entropy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Uniform noise</td>
<td align="right">0.138</td>
<td align="right">0.048</td>
<td align="right">2.000</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">6-dimensional motivation system</td>
<td align="right">0.091</td>
<td align="right">0.243</td>
<td align="right">2.022</td>
<td align="right">0.107</td>
</tr>
<tr class="odd">
<td align="left">Shuffled system</td>
<td align="right">0.065</td>
<td align="right">0.067</td>
<td align="right">2.083</td>
<td align="right">0.287</td>
</tr>
</tbody>
</table>
</div>
<div id="recurrence-network-demo" class="section level1">
<h1>Recurrence network demo</h1>
<p>Here’s the 6-dimensional motivation system’s recurrence plot, weighted by similarity.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb18-2" title="2"></a>
<a class="sourceLine" id="cb18-3" title="3"><span class="co">#######################</span></a>
<a class="sourceLine" id="cb18-4" title="4"></a>
<a class="sourceLine" id="cb18-5" title="5"><span class="co"># si = similarity under the radius</span></a>
<a class="sourceLine" id="cb18-6" title="6">emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-7" title="7"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">RN =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> data_firstlast_divided_by_max,</a>
<a class="sourceLine" id="cb18-8" title="8">                                <span class="dt">.f =</span>  <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rn</span>(.x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="co">#autonomy, competence, relatedness,</span></a>
<a class="sourceLine" id="cb18-9" title="9">                                                                       pleasure, interest, importance,</a>
<a class="sourceLine" id="cb18-10" title="10">                                                                       situation_requires, </a>
<a class="sourceLine" id="cb18-11" title="11">                                                                       anxiety_guilt_avoidance, </a>
<a class="sourceLine" id="cb18-12" title="12">                                                                       another_wants), </a>
<a class="sourceLine" id="cb18-13" title="13">                                                  <span class="dt">doEmbed =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb18-14" title="14">                                                  <span class="dt">weighted =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb18-15" title="15">                                                  <span class="dt">weightedBy =</span> <span class="st">&quot;si&quot;</span>, </a>
<a class="sourceLine" id="cb18-16" title="16">                                                  <span class="dt">emRad =</span> <span class="ot">NA</span>)))</a>
<a class="sourceLine" id="cb18-17" title="17"><span class="co">## </span></a>
<a class="sourceLine" id="cb18-18" title="18"><span class="co">## Auto-recurrence: Setting diagonal to (1 + max. distance) for analyses</span></a>
<a class="sourceLine" id="cb18-19" title="19"><span class="co">## </span></a>
<a class="sourceLine" id="cb18-20" title="20"><span class="co">## Searching for a radius that will yield 0.05 for RR</span></a>
<a class="sourceLine" id="cb18-21" title="21"></a>
<a class="sourceLine" id="cb18-22" title="22">emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-23" title="23"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">graph_from_adjacency =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> RN,</a>
<a class="sourceLine" id="cb18-24" title="24">                                                  <span class="dt">.f =</span> <span class="op">~</span>igraph<span class="op">::</span><span class="kw">graph_from_adjacency_matrix</span>(.x, </a>
<a class="sourceLine" id="cb18-25" title="25">                                                                                            <span class="dt">weighted =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb18-26" title="26">                                                                                            <span class="dt">mode =</span> <span class="st">&quot;upper&quot;</span>, </a>
<a class="sourceLine" id="cb18-27" title="27">                                                                                            <span class="dt">diag =</span> <span class="ot">FALSE</span>)))</a>
<a class="sourceLine" id="cb18-28" title="28"></a>
<a class="sourceLine" id="cb18-29" title="29"><span class="co"># Edges with their distances</span></a>
<a class="sourceLine" id="cb18-30" title="30">emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-31" title="31"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">edges_with_distances =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> graph_from_adjacency,</a>
<a class="sourceLine" id="cb18-32" title="32">                                                  <span class="dt">.f =</span> <span class="op">~</span>igraph<span class="op">::</span><span class="kw">E</span>(.x)<span class="op">$</span>weight),</a>
<a class="sourceLine" id="cb18-33" title="33">                <span class="dt">graph_from_adjacency_orig =</span> graph_from_adjacency)</a>
<a class="sourceLine" id="cb18-34" title="34"></a>
<a class="sourceLine" id="cb18-35" title="35"><span class="co"># Larger values are closer to the state; inverse of weight makes it more intuitive</span></a>
<a class="sourceLine" id="cb18-36" title="36"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets)) {</a>
<a class="sourceLine" id="cb18-37" title="37">igraph<span class="op">::</span><span class="kw">E</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>weight &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>emadata_nested_wrangled_both_recnets<span class="op">$</span>edges_with_distances[[i]])</a>
<a class="sourceLine" id="cb18-38" title="38">}</a>
<a class="sourceLine" id="cb18-39" title="39"><span class="co"># A later note to self: Now weight is a measure of distance; how far apart two time points are</span></a>
<a class="sourceLine" id="cb18-40" title="40"><span class="co"># (under the radius, i.e. they&#39;re reasonably similar to begin with)</span></a>
<a class="sourceLine" id="cb18-41" title="41"></a>
<a class="sourceLine" id="cb18-42" title="42"><span class="co">####### To check:</span></a>
<a class="sourceLine" id="cb18-43" title="43"><span class="co"># igraph::E(emadata_nested_wrangled_both_recnets$graph_from_adjacency[[1]])$weight</span></a>
<a class="sourceLine" id="cb18-44" title="44"><span class="co"># igraph::E(emadata_nested_wrangled_both_recnets$graph_from_adjacency_orig[[1]])$weight</span></a>
<a class="sourceLine" id="cb18-45" title="45"></a>
<a class="sourceLine" id="cb18-46" title="46">emadata_nested_wrangled_both_recnets &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-47" title="47"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">RN_plot =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> RN,</a>
<a class="sourceLine" id="cb18-48" title="48">                                <span class="dt">.f =</span>  <span class="op">~</span>casnet<span class="op">::</span><span class="kw">rn_plot</span>(.x,</a>
<a class="sourceLine" id="cb18-49" title="49">                                                       <span class="dt">plotDimensions =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb18-50" title="50">                                                       <span class="dt">xlab =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>,</a>
<a class="sourceLine" id="cb18-51" title="51">                                                       <span class="dt">ylab =</span> <span class="st">&quot;6-dimensional motivation system&quot;</span>)))</a></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="co"># Make node size equal to strength. Strength is the sum of a node&#39;s edge weights.</span></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets)) {</a>
<a class="sourceLine" id="cb19-4" title="4">igraph<span class="op">::</span><span class="kw">V</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>size &lt;-<span class="st"> </span>(igraph<span class="op">::</span><span class="kw">strength</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]]))</a>
<a class="sourceLine" id="cb19-5" title="5">}</a>
<a class="sourceLine" id="cb19-6" title="6"></a>
<a class="sourceLine" id="cb19-7" title="7"><span class="co"># Rescaling weight as &quot;width&quot;; varies between 5 and 10</span></a>
<a class="sourceLine" id="cb19-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets)) {</a>
<a class="sourceLine" id="cb19-9" title="9">igraph<span class="op">::</span><span class="kw">E</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>width &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb19-10" title="10"><span class="st">  </span>casnet<span class="op">::</span><span class="kw">elascer</span>(igraph<span class="op">::</span><span class="kw">E</span>(emadata_nested_wrangled_both_recnets<span class="op">$</span>graph_from_adjacency[[i]])<span class="op">$</span>weight, <span class="dt">lo =</span> <span class="dv">5</span>, <span class="dt">hi =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb19-11" title="11">}</a></code></pre></div>
<p>The lengthy code chunk below extracts and marks attractors in the data.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="co"># Get number of maximally connected node</span></a>
<a class="sourceLine" id="cb20-2" title="2">emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">max_connected_day =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> graph_from_adjacency,</a>
<a class="sourceLine" id="cb20-4" title="4">                                     <span class="dt">.f =</span>  <span class="op">~</span><span class="kw">which.max</span>(igraph<span class="op">::</span><span class="kw">degree</span>(.x))</a>
<a class="sourceLine" id="cb20-5" title="5">                                     ))</a>
<a class="sourceLine" id="cb20-6" title="6"></a>
<a class="sourceLine" id="cb20-7" title="7"></a>
<a class="sourceLine" id="cb20-8" title="8"></a>
<a class="sourceLine" id="cb20-9" title="9">emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-10" title="10"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">list_of_edges =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> graph_from_adjacency,</a>
<a class="sourceLine" id="cb20-11" title="11">                                     <span class="dt">.f =</span>  <span class="op">~</span>igraph<span class="op">::</span><span class="kw">get.data.frame</span>(.x)</a>
<a class="sourceLine" id="cb20-12" title="12">                                     ))</a>
<a class="sourceLine" id="cb20-13" title="13"></a>
<a class="sourceLine" id="cb20-14" title="14">emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-15" title="15"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> </a>
<a class="sourceLine" id="cb20-16" title="16">                  purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> data_firstlast_divided_by_max,</a>
<a class="sourceLine" id="cb20-17" title="17">                              <span class="dt">.y =</span> graph_from_adjacency,</a>
<a class="sourceLine" id="cb20-18" title="18">                              <span class="dt">.f =</span> <span class="op">~</span>{</a>
<a class="sourceLine" id="cb20-19" title="19">                                <span class="kw">data.frame</span>(.x <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-20" title="20"><span class="st">                                             </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="co">#autonomy, competence, relatedness,</span></a>
<a class="sourceLine" id="cb20-21" title="21">                                                                       pleasure, interest, importance,</a>
<a class="sourceLine" id="cb20-22" title="22">                                                                       situation_requires, anxiety_guilt_avoidance, another_wants), </a>
<a class="sourceLine" id="cb20-23" title="23">                                           <span class="dt">strength =</span> igraph<span class="op">::</span><span class="kw">strength</span>(.y)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-24" title="24"><span class="st">                                  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">time =</span> dplyr<span class="op">::</span><span class="kw">row_number</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-25" title="25"><span class="st">                                  </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(<span class="op">-</span>strength, <span class="op">-</span>time))</a>
<a class="sourceLine" id="cb20-26" title="26">                              }</a>
<a class="sourceLine" id="cb20-27" title="27">  ))</a>
<a class="sourceLine" id="cb20-28" title="28"></a>
<a class="sourceLine" id="cb20-29" title="29"><span class="co"># Extract nodes (i.e. times) which connect to the strongest (i.e. most connected) node</span></a>
<a class="sourceLine" id="cb20-30" title="30">emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-31" title="31"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</a>
<a class="sourceLine" id="cb20-32" title="32">                                                      <span class="dt">.y =</span> max_connected_day,</a>
<a class="sourceLine" id="cb20-33" title="33">                                                      <span class="dt">.f =</span> <span class="op">~</span>{</a>
<a class="sourceLine" id="cb20-34" title="34">                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-35" title="35"><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-36" title="36"><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</a>
<a class="sourceLine" id="cb20-37" title="37">                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-38" title="38"><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </a>
<a class="sourceLine" id="cb20-39" title="39">                                                                          <span class="co">#.keep_all = TRUE</span></a>
<a class="sourceLine" id="cb20-40" title="40">                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-41" title="41"><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</a>
<a class="sourceLine" id="cb20-42" title="42">                                                      }</a>
<a class="sourceLine" id="cb20-43" title="43">                                                      )</a>
<a class="sourceLine" id="cb20-44" title="44">  )</a>
<a class="sourceLine" id="cb20-45" title="45"></a>
<a class="sourceLine" id="cb20-46" title="46">emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-47" title="47"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</a>
<a class="sourceLine" id="cb20-48" title="48">                                                       <span class="dt">.y =</span> connecting_to_strongest,</a>
<a class="sourceLine" id="cb20-49" title="49">                                                       <span class="dt">.f =</span> <span class="op">~</span>{</a>
<a class="sourceLine" id="cb20-50" title="50">                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</a>
<a class="sourceLine" id="cb20-51" title="51">                                                                       <span class="dt">connecting_to_strongest =</span> </a>
<a class="sourceLine" id="cb20-52" title="52">                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb20-53" title="53">                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb20-54" title="54">                                                       }</a>
<a class="sourceLine" id="cb20-55" title="55">  ))</a>
<a class="sourceLine" id="cb20-56" title="56"></a>
<a class="sourceLine" id="cb20-57" title="57"><span class="co"># Get number of 2nd maximally connected node, which doesn&#39;t connect to the 1st</span></a>
<a class="sourceLine" id="cb20-58" title="58">emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-59" title="59"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">secondary_attractor_day =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> graph_from_adjacency,</a>
<a class="sourceLine" id="cb20-60" title="60">                                                      <span class="dt">.y =</span> connecting_to_strongest,</a>
<a class="sourceLine" id="cb20-61" title="61">                                                      <span class="dt">.f =</span>  <span class="op">~</span>{</a>
<a class="sourceLine" id="cb20-62" title="62">                                                        <span class="kw">data.frame</span>(<span class="dt">degree =</span> igraph<span class="op">::</span><span class="kw">degree</span>(.x), </a>
<a class="sourceLine" id="cb20-63" title="63">                                                                   <span class="dt">time =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(igraph<span class="op">::</span><span class="kw">degree</span>(.x))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-64" title="64"><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-65" title="65"><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(degree)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-66" title="66"><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-67" title="67"><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(time)</a>
<a class="sourceLine" id="cb20-68" title="68">                                                      }                                                    </a>
<a class="sourceLine" id="cb20-69" title="69">  ))</a>
<a class="sourceLine" id="cb20-70" title="70"></a>
<a class="sourceLine" id="cb20-71" title="71"><span class="co"># Extract nodes (i.e. times) which connect to the 2nd strongest node, which doesn&#39;t connect to the 1st</span></a>
<a class="sourceLine" id="cb20-72" title="72">emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-73" title="73"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_2nd_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</a>
<a class="sourceLine" id="cb20-74" title="74">                                                      <span class="dt">.y =</span> secondary_attractor_day,</a>
<a class="sourceLine" id="cb20-75" title="75">                                                      <span class="dt">.f =</span> <span class="op">~</span>{</a>
<a class="sourceLine" id="cb20-76" title="76">                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-77" title="77"><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-78" title="78"><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</a>
<a class="sourceLine" id="cb20-79" title="79">                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-80" title="80"><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </a>
<a class="sourceLine" id="cb20-81" title="81">                                                                          <span class="co">#.keep_all = TRUE</span></a>
<a class="sourceLine" id="cb20-82" title="82">                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-83" title="83"><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</a>
<a class="sourceLine" id="cb20-84" title="84">                                                      }</a>
<a class="sourceLine" id="cb20-85" title="85">                                                      )</a>
<a class="sourceLine" id="cb20-86" title="86">  )</a>
<a class="sourceLine" id="cb20-87" title="87"></a>
<a class="sourceLine" id="cb20-88" title="88"><span class="co"># Save as a variable in the dataset</span></a>
<a class="sourceLine" id="cb20-89" title="89">emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-90" title="90"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</a>
<a class="sourceLine" id="cb20-91" title="91">                                                       <span class="dt">.y =</span> connecting_to_2nd_strongest,</a>
<a class="sourceLine" id="cb20-92" title="92">                                                       <span class="dt">.f =</span> <span class="op">~</span>{</a>
<a class="sourceLine" id="cb20-93" title="93">                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</a>
<a class="sourceLine" id="cb20-94" title="94">                                                                       <span class="dt">connecting_to_2nd_strongest =</span> </a>
<a class="sourceLine" id="cb20-95" title="95">                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb20-96" title="96">                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb20-97" title="97">                                                       }</a>
<a class="sourceLine" id="cb20-98" title="98">  ))</a>
<a class="sourceLine" id="cb20-99" title="99"></a>
<a class="sourceLine" id="cb20-100" title="100"><span class="co"># Get number of 3rd maximally connected node, which doesn&#39;t connect to the 1st or second</span></a>
<a class="sourceLine" id="cb20-101" title="101">emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-102" title="102"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">tertiary_attractor_day =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> graph_from_adjacency,</a>
<a class="sourceLine" id="cb20-103" title="103">                                                      <span class="dt">..2 =</span> connecting_to_strongest,</a>
<a class="sourceLine" id="cb20-104" title="104">                                                      <span class="dt">..3 =</span> connecting_to_2nd_strongest),</a>
<a class="sourceLine" id="cb20-105" title="105">                                                      <span class="dt">.f =</span>  <span class="op">~</span>{</a>
<a class="sourceLine" id="cb20-106" title="106">                                                        <span class="kw">data.frame</span>(<span class="dt">degree =</span> igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>), </a>
<a class="sourceLine" id="cb20-107" title="107">                                                                   <span class="dt">time =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-108" title="108"><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">2</span>, </a>
<a class="sourceLine" id="cb20-109" title="109">                                                                        <span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-110" title="110"><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(degree)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-111" title="111"><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-112" title="112"><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(time)</a>
<a class="sourceLine" id="cb20-113" title="113">                                                      }                                                    </a>
<a class="sourceLine" id="cb20-114" title="114">  ))</a>
<a class="sourceLine" id="cb20-115" title="115"></a>
<a class="sourceLine" id="cb20-116" title="116"><span class="co"># Extract nodes (i.e. times) which connect to the 3rd strongest node</span></a>
<a class="sourceLine" id="cb20-117" title="117">emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-118" title="118"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_3rd_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</a>
<a class="sourceLine" id="cb20-119" title="119">                                                      <span class="dt">.y =</span> tertiary_attractor_day,</a>
<a class="sourceLine" id="cb20-120" title="120">                                                      <span class="dt">.f =</span> <span class="op">~</span>{</a>
<a class="sourceLine" id="cb20-121" title="121">                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-122" title="122"><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-123" title="123"><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</a>
<a class="sourceLine" id="cb20-124" title="124">                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-125" title="125"><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </a>
<a class="sourceLine" id="cb20-126" title="126">                                                                          <span class="co">#.keep_all = TRUE</span></a>
<a class="sourceLine" id="cb20-127" title="127">                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-128" title="128"><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</a>
<a class="sourceLine" id="cb20-129" title="129">                                                      }</a>
<a class="sourceLine" id="cb20-130" title="130">                                                      )</a>
<a class="sourceLine" id="cb20-131" title="131">  )</a>
<a class="sourceLine" id="cb20-132" title="132"></a>
<a class="sourceLine" id="cb20-133" title="133"><span class="co"># Save as a variable</span></a>
<a class="sourceLine" id="cb20-134" title="134">emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-135" title="135"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</a>
<a class="sourceLine" id="cb20-136" title="136">                                                       <span class="dt">.y =</span> connecting_to_3rd_strongest,</a>
<a class="sourceLine" id="cb20-137" title="137">                                                       <span class="dt">.f =</span> <span class="op">~</span>{</a>
<a class="sourceLine" id="cb20-138" title="138">                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</a>
<a class="sourceLine" id="cb20-139" title="139">                                                                       <span class="dt">connecting_to_3rd_strongest =</span> </a>
<a class="sourceLine" id="cb20-140" title="140">                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb20-141" title="141">                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb20-142" title="142">                                                       }</a>
<a class="sourceLine" id="cb20-143" title="143">  ))</a>
<a class="sourceLine" id="cb20-144" title="144"></a>
<a class="sourceLine" id="cb20-145" title="145"></a>
<a class="sourceLine" id="cb20-146" title="146"></a>
<a class="sourceLine" id="cb20-147" title="147"><span class="co"># Get number of 4th maximally connected node, which doesn&#39;t connect to the 1st or second</span></a>
<a class="sourceLine" id="cb20-148" title="148">emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-149" title="149"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">fourth_attractor_day =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> graph_from_adjacency,</a>
<a class="sourceLine" id="cb20-150" title="150">                                                      <span class="dt">..2 =</span> connecting_to_strongest,</a>
<a class="sourceLine" id="cb20-151" title="151">                                                      <span class="dt">..3 =</span> connecting_to_2nd_strongest,</a>
<a class="sourceLine" id="cb20-152" title="152">                                                      <span class="dt">..4 =</span> connecting_to_3rd_strongest),</a>
<a class="sourceLine" id="cb20-153" title="153">                                                      <span class="dt">.f =</span>  <span class="op">~</span>{</a>
<a class="sourceLine" id="cb20-154" title="154">                                                        <span class="kw">data.frame</span>(<span class="dt">degree =</span> igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>), </a>
<a class="sourceLine" id="cb20-155" title="155">                                                                   <span class="dt">time =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(igraph<span class="op">::</span><span class="kw">degree</span>(..<span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-156" title="156"><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">2</span>, </a>
<a class="sourceLine" id="cb20-157" title="157">                                                                        <span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">3</span>, </a>
<a class="sourceLine" id="cb20-158" title="158">                                                                        <span class="op">!</span>time <span class="op">%in%</span><span class="st"> </span>..<span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-159" title="159"><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(degree)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-160" title="160"><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-161" title="161"><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(time)</a>
<a class="sourceLine" id="cb20-162" title="162">                                                      }                                                    </a>
<a class="sourceLine" id="cb20-163" title="163">  ))</a>
<a class="sourceLine" id="cb20-164" title="164"></a>
<a class="sourceLine" id="cb20-165" title="165"><span class="co"># Extract nodes (i.e. times) which connect to the 3rd strongest node</span></a>
<a class="sourceLine" id="cb20-166" title="166">emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-167" title="167"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">connecting_to_4th_strongest =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> list_of_edges,</a>
<a class="sourceLine" id="cb20-168" title="168">                                                      <span class="dt">.y =</span> fourth_attractor_day,</a>
<a class="sourceLine" id="cb20-169" title="169">                                                      <span class="dt">.f =</span> <span class="op">~</span>{</a>
<a class="sourceLine" id="cb20-170" title="170">                                                        .x <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(from <span class="op">==</span><span class="st"> </span>.y <span class="op">|</span><span class="st"> </span>to <span class="op">==</span><span class="st"> </span>.y) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-171" title="171"><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(weight) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-172" title="172"><span class="st">                                                          </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(from, to),</a>
<a class="sourceLine" id="cb20-173" title="173">                                                                              <span class="dt">values_to =</span> <span class="st">&quot;node&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-174" title="174"><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(node, </a>
<a class="sourceLine" id="cb20-175" title="175">                                                                          <span class="co">#.keep_all = TRUE</span></a>
<a class="sourceLine" id="cb20-176" title="176">                                                          ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-177" title="177"><span class="st">                                                          </span>dplyr<span class="op">::</span><span class="kw">pull</span>(node)</a>
<a class="sourceLine" id="cb20-178" title="178">                                                      }</a>
<a class="sourceLine" id="cb20-179" title="179">                                                      )</a>
<a class="sourceLine" id="cb20-180" title="180">  )</a>
<a class="sourceLine" id="cb20-181" title="181"></a>
<a class="sourceLine" id="cb20-182" title="182"><span class="co"># Save as a variable</span></a>
<a class="sourceLine" id="cb20-183" title="183">emadata_nested_wrangled_both_recnets_nodes &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-184" title="184"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</a>
<a class="sourceLine" id="cb20-185" title="185">                                                       <span class="dt">.y =</span> connecting_to_4th_strongest,</a>
<a class="sourceLine" id="cb20-186" title="186">                                                       <span class="dt">.f =</span> <span class="op">~</span>{</a>
<a class="sourceLine" id="cb20-187" title="187">                                                         dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</a>
<a class="sourceLine" id="cb20-188" title="188">                                                                       <span class="dt">connecting_to_4th_strongest =</span> </a>
<a class="sourceLine" id="cb20-189" title="189">                                                                         dplyr<span class="op">::</span><span class="kw">case_when</span>(time <span class="op">%in%</span><span class="st"> </span>.y <span class="op">~</span><span class="st"> </span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb20-190" title="190">                                                                                          <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb20-191" title="191">                                                       }</a>
<a class="sourceLine" id="cb20-192" title="192">  ))</a>
<a class="sourceLine" id="cb20-193" title="193"></a>
<a class="sourceLine" id="cb20-194" title="194"><span class="co">################### Make plots</span></a>
<a class="sourceLine" id="cb20-195" title="195"></a>
<a class="sourceLine" id="cb20-196" title="196">emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-197" title="197"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">all_nodes_with_strengths =</span> </a>
<a class="sourceLine" id="cb20-198" title="198">                  purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</a>
<a class="sourceLine" id="cb20-199" title="199">                             <span class="dt">.f =</span> <span class="op">~</span>{</a>
<a class="sourceLine" id="cb20-200" title="200">                               dplyr<span class="op">::</span><span class="kw">mutate</span>(.x,</a>
<a class="sourceLine" id="cb20-201" title="201">                                             <span class="dt">attractors =</span> dplyr<span class="op">::</span><span class="kw">case_when</span>(</a>
<a class="sourceLine" id="cb20-202" title="202">                                               strength <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> &quot;Unique&quot;</span>,</a>
<a class="sourceLine" id="cb20-203" title="203">                                               connecting_to_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;1st&quot;</span>,</a>
<a class="sourceLine" id="cb20-204" title="204">                                               connecting_to_2nd_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;2nd&quot;</span>,</a>
<a class="sourceLine" id="cb20-205" title="205">                                               connecting_to_3rd_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;3rd&quot;</span>,</a>
<a class="sourceLine" id="cb20-206" title="206">                                               connecting_to_4th_strongest <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;4th&quot;</span>,</a>
<a class="sourceLine" id="cb20-207" title="207">                                               <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Uncategorised&quot;</span>),</a>
<a class="sourceLine" id="cb20-208" title="208">                                             <span class="dt">attractors =</span> <span class="kw">factor</span>(attractors,</a>
<a class="sourceLine" id="cb20-209" title="209">                                                                 <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;1st&quot;</span>,</a>
<a class="sourceLine" id="cb20-210" title="210">                                                                            <span class="st">&quot;2nd&quot;</span>,</a>
<a class="sourceLine" id="cb20-211" title="211">                                                                            <span class="st">&quot;3rd&quot;</span>,</a>
<a class="sourceLine" id="cb20-212" title="212">                                                                            <span class="st">&quot;4th&quot;</span>,</a>
<a class="sourceLine" id="cb20-213" title="213">                                                                            <span class="st">&quot;Uncategorised&quot;</span>,</a>
<a class="sourceLine" id="cb20-214" title="214">                                                                            <span class="st">&quot;Unique&quot;</span>)),</a>
<a class="sourceLine" id="cb20-215" title="215">                                             <span class="dt">name =</span> <span class="kw">factor</span>(name,</a>
<a class="sourceLine" id="cb20-216" title="216">                                                           <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;pleasure&quot;</span>,</a>
<a class="sourceLine" id="cb20-217" title="217">                                                                      <span class="st">&quot;interest&quot;</span>,</a>
<a class="sourceLine" id="cb20-218" title="218">                                                                      <span class="st">&quot;importance&quot;</span>,</a>
<a class="sourceLine" id="cb20-219" title="219">                                                                      <span class="st">&quot;situation_requires&quot;</span>,</a>
<a class="sourceLine" id="cb20-220" title="220">                                                                      <span class="st">&quot;anxiety_guilt_avoidance&quot;</span>,</a>
<a class="sourceLine" id="cb20-221" title="221">                                                                      <span class="st">&quot;another_wants&quot;</span>),</a>
<a class="sourceLine" id="cb20-222" title="222">                                                           <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Pleasure&quot;</span>,</a>
<a class="sourceLine" id="cb20-223" title="223">                                                                      <span class="st">&quot;Interest&quot;</span>,</a>
<a class="sourceLine" id="cb20-224" title="224">                                                                      <span class="st">&quot;Importance&quot;</span>,</a>
<a class="sourceLine" id="cb20-225" title="225">                                                                      <span class="st">&quot;Situation requires&quot;</span>,</a>
<a class="sourceLine" id="cb20-226" title="226">                                                                      <span class="st">&quot;Anxiety guilt avoidance&quot;</span>,</a>
<a class="sourceLine" id="cb20-227" title="227">                                                                      <span class="st">&quot;Another wants&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-228" title="228"><span class="st">                                               </span>forcats<span class="op">::</span><span class="kw">fct_drop</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-229" title="229"><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(attractors, name) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-230" title="230"><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-231" title="231"><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-232" title="232"><span class="st">                                 </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">maxtime =</span> <span class="kw">max</span>(time),</a>
<a class="sourceLine" id="cb20-233" title="233">                                               <span class="dt">percentage_of_total =</span></a>
<a class="sourceLine" id="cb20-234" title="234">                                                 (n <span class="op">/</span><span class="st"> </span>maxtime) <span class="op">%&gt;%</span><span class="st"> </span>scales<span class="op">::</span><span class="kw">percent</span>(<span class="dt">accuracy =</span> <span class="fl">0.1</span>),</a>
<a class="sourceLine" id="cb20-235" title="235">                                               <span class="dt">proportion_of_total =</span> n<span class="op">/</span>maxtime,</a>
<a class="sourceLine" id="cb20-236" title="236">                                               <span class="dt">attractors_n =</span> </a>
<a class="sourceLine" id="cb20-237" title="237">                                                 <span class="kw">factor</span>(<span class="kw">paste0</span>(attractors,</a>
<a class="sourceLine" id="cb20-238" title="238">                                                               <span class="st">&quot; (n = &quot;</span>, n, <span class="st">&quot;; &quot;</span>, </a>
<a class="sourceLine" id="cb20-239" title="239">                                                               percentage_of_total, <span class="st">&quot;)&quot;</span>)))</a>
<a class="sourceLine" id="cb20-240" title="240">                             }</a>
<a class="sourceLine" id="cb20-241" title="241">                  ))</a></code></pre></div>
<div id="spiral-graph-with-colored-nodes" class="section level3">
<h3>Spiral graph with colored nodes</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">node_colors =</span> purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> all_nodes_with_strengths,</a>
<a class="sourceLine" id="cb21-3" title="3">                                         <span class="dt">.f =</span> <span class="op">~</span>{tidyr<span class="op">::</span><span class="kw">pivot_wider</span>(.x, <span class="dt">names_from =</span> name) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="st">                                             </span>dplyr<span class="op">::</span><span class="kw">pull</span>(attractors)}))</a>
<a class="sourceLine" id="cb21-5" title="5"></a>
<a class="sourceLine" id="cb21-6" title="6"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(emadata_nested_wrangled_both_recnets_nodes_plots)) {</a>
<a class="sourceLine" id="cb21-7" title="7"><span class="kw">levels</span>(emadata_nested_wrangled_both_recnets_nodes_plots<span class="op">$</span>node_colors[[i]]) &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb21-8" title="8"><span class="st">  </span><span class="kw">c</span>(viridisLite<span class="op">::</span><span class="kw">plasma</span>(<span class="dv">4</span>, </a>
<a class="sourceLine" id="cb21-9" title="9">                      <span class="dt">end =</span> <span class="fl">0.8</span>, </a>
<a class="sourceLine" id="cb21-10" title="10">                      <span class="dt">direction =</span> <span class="dv">-1</span>), <span class="st">&quot;gray48&quot;</span>, <span class="st">&quot;white&quot;</span>)</a>
<a class="sourceLine" id="cb21-11" title="11">  }</a>
<a class="sourceLine" id="cb21-12" title="12"></a>
<a class="sourceLine" id="cb21-13" title="13">emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-14" title="14"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">spiralgraph_epochs =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> graph_from_adjacency,</a>
<a class="sourceLine" id="cb21-15" title="15">                                          <span class="dt">..2 =</span> node_colors,</a>
<a class="sourceLine" id="cb21-16" title="16">                                          <span class="dt">..3 =</span> User),</a>
<a class="sourceLine" id="cb21-17" title="17">                                     <span class="dt">.f =</span>  <span class="op">~</span>casnet<span class="op">::</span><span class="kw">make_spiral_graph</span>(<span class="dt">g =</span> ..<span class="dv">1</span>, </a>
<a class="sourceLine" id="cb21-18" title="18">                                                                      <span class="dt">arcs =</span> <span class="dv">4</span>, </a>
<a class="sourceLine" id="cb21-19" title="19">                                                                      <span class="co"># a = .1, </span></a>
<a class="sourceLine" id="cb21-20" title="20">                                                                      <span class="co"># b = 2, </span></a>
<a class="sourceLine" id="cb21-21" title="21">                                                                      <span class="dt">markTimeBy =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb21-22" title="22">                                                                      <span class="dt">markEpochsBy =</span> ..<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb21-23" title="23">                                                                      <span class="dt">epochColours =</span> ..<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb21-24" title="24">                                                                      <span class="dt">showEpochLegend =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb21-25" title="25">                                                                      <span class="dt">scaleEdgeSize =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb21-26" title="26">                                                                      <span class="dt">scaleVertexSize =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">5</span>),</a>
<a class="sourceLine" id="cb21-27" title="27">                                                                      <span class="dt">showSizeLegend =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb21-28" title="28">                                                                      <span class="dt">sizeLabel =</span> <span class="st">&quot;Node strength&quot;</span>,</a>
<a class="sourceLine" id="cb21-29" title="29">                                                                      <span class="dt">type =</span> <span class="st">&quot;Euler&quot;</span>,</a>
<a class="sourceLine" id="cb21-30" title="30">                                                                      <span class="co"># alphaE = 0.1</span></a>
<a class="sourceLine" id="cb21-31" title="31">                                                                      <span class="co"># title = ..3</span></a>
<a class="sourceLine" id="cb21-32" title="32">                                     )))</a></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="co"># emadata_nested_wrangled_both_recnets_nodes_plots$spiralgraph_epochs[[1]] +</span></a>
<a class="sourceLine" id="cb22-3" title="3"><span class="co">#   theme(plot.margin=grid::unit(c(0,0,0,0), &quot;mm&quot;))</span></a>
<a class="sourceLine" id="cb22-4" title="4"></a>
<a class="sourceLine" id="cb22-5" title="5"><span class="kw">ggsave</span>(<span class="dt">filename =</span> <span class="st">&quot;./figures/recnetwork.png&quot;</span>,</a>
<a class="sourceLine" id="cb22-6" title="6">       <span class="dt">width =</span> <span class="dv">7</span>, </a>
<a class="sourceLine" id="cb22-7" title="7">       <span class="dt">height =</span> <span class="dv">7</span>)</a>
<a class="sourceLine" id="cb22-8" title="8"></a>
<a class="sourceLine" id="cb22-9" title="9"><span class="co"># emadata_nested_wrangled_both_recnets_nodes_plots$all_nodes_with_strengths[[1]]</span></a></code></pre></div>
</div>
<div id="attractor-plot" class="section level3">
<h3>Attractor plot</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">observations =</span> purrr<span class="op">::</span><span class="kw">map_dbl</span>(<span class="dt">.x =</span> data_firstlast_divided_by_max,</a>
<a class="sourceLine" id="cb23-3" title="3">                                              <span class="dt">.f =</span> <span class="op">~</span><span class="kw">nrow</span>(.)))</a>
<a class="sourceLine" id="cb23-4" title="4"></a>
<a class="sourceLine" id="cb23-5" title="5">emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-6" title="6"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">observations_daily =</span> purrr<span class="op">::</span><span class="kw">map_dbl</span>(<span class="dt">.x =</span> data_daily,</a>
<a class="sourceLine" id="cb23-7" title="7">                                              <span class="dt">.f =</span> <span class="op">~</span><span class="kw">nrow</span>(.)))</a>
<a class="sourceLine" id="cb23-8" title="8"></a>
<a class="sourceLine" id="cb23-9" title="9"></a>
<a class="sourceLine" id="cb23-10" title="10">emadata_nested_wrangled_both_recnets_nodes_plots &lt;-<span class="st"> </span>emadata_nested_wrangled_both_recnets_nodes_plots <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-11" title="11"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">attractor_plots =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(<span class="dt">..1 =</span> all_nodes_with_strengths,</a>
<a class="sourceLine" id="cb23-12" title="12">                                                   <span class="dt">..2 =</span> observations,</a>
<a class="sourceLine" id="cb23-13" title="13">                                                   <span class="dt">..3 =</span> observations_daily,</a>
<a class="sourceLine" id="cb23-14" title="14">                                                   <span class="dt">..4 =</span> User),</a>
<a class="sourceLine" id="cb23-15" title="15">                                             <span class="dt">.f =</span> <span class="op">~</span>{</a>
<a class="sourceLine" id="cb23-16" title="16">                                               dplyr<span class="op">::</span><span class="kw">mutate</span>(..<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb23-17" title="17">                                                             <span class="dt">strength_rescaled =</span> scales<span class="op">::</span><span class="kw">rescale</span>(strength, <span class="dt">to =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">2</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-18" title="18"><span class="st">                                                 </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</a>
<a class="sourceLine" id="cb23-19" title="19">                                                        <span class="kw">aes</span>(<span class="dt">x =</span> forcats<span class="op">::</span><span class="kw">fct_rev</span>(name), </a>
<a class="sourceLine" id="cb23-20" title="20">                                                            <span class="dt">y =</span> value, </a>
<a class="sourceLine" id="cb23-21" title="21">                                                            <span class="dt">size =</span> strength_rescaled,</a>
<a class="sourceLine" id="cb23-22" title="22">                                                            <span class="dt">alpha =</span> <span class="kw">ifelse</span>(strength_rescaled <span class="op">==</span><span class="st"> </span><span class="fl">0.1</span>, <span class="dv">1</span>, strength_rescaled),</a>
<a class="sourceLine" id="cb23-23" title="23">                                                            <span class="dt">color =</span> attractors_n)) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-24" title="24"><span class="st">                                                   </span><span class="kw">scale_size_identity</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb23-25" title="25"><span class="st">                                                 </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> time)) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-26" title="26"><span class="st">                                                 </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb23-27" title="27"><span class="st">                                                 </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(viridisLite<span class="op">::</span><span class="kw">plasma</span>(<span class="dv">4</span>, </a>
<a class="sourceLine" id="cb23-28" title="28">                                                                                                   <span class="dt">end =</span> <span class="fl">0.8</span>, </a>
<a class="sourceLine" id="cb23-29" title="29">                                                                                                   <span class="dt">direction =</span> <span class="dv">-1</span>), </a>
<a class="sourceLine" id="cb23-30" title="30">                                                                               <span class="st">&quot;gray48&quot;</span>, <span class="st">&quot;gray87&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-31" title="31"><span class="st">                                                 </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">label_percent</span>(<span class="dt">accuracy =</span> <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-32" title="32"><span class="st">                                                 </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb23-33" title="33"><span class="st">                                                 </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-34" title="34"><span class="st">                                                 </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Percentage of maximum reported value of variable, across full time series&quot;</span>,</a>
<a class="sourceLine" id="cb23-35" title="35">                                                      <span class="dt">x =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb23-36" title="36">                                                      <span class="dt">title =</span> <span class="kw">paste0</span>(..<span class="dv">4</span>, <span class="st">&quot; - based on &quot;</span>, ..<span class="dv">2</span>, <span class="st">&quot; data points (&quot;</span>, ..<span class="dv">3</span>, <span class="st">&quot; days)&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-37" title="37"><span class="st">                                                 </span><span class="kw">facet_wrap</span>(<span class="op">~</span>attractors_n) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-38" title="38"><span class="st">                                                 </span><span class="kw">coord_flip</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb23-39" title="39">                                             }</a>
<a class="sourceLine" id="cb23-40" title="40">  ))</a>
<a class="sourceLine" id="cb23-41" title="41"></a>
<a class="sourceLine" id="cb23-42" title="42">emadata_nested_wrangled_both_recnets_nodes_plots<span class="op">$</span>attractor_plots[[<span class="dv">1</span>]]</a></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/attractor-plots-1.png" width="672" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="co"># emadata_nested_wrangled_both_recnets_nodes_plots$all_nodes_with_strengths[[1]]</span></a></code></pre></div>
</div>
</div>
<div id="section-1" class="section level1 unnumbered">
<h1></h1>
<p>Research questions to be studied with multidimensional recurrence networks:</p>
<ul>
<li>How are the variables in the multivariate system connected to each other; what is the structure (i.e. the centrality indices) of the recurrence network, and do behaviour change outcomes depend on it?</li>
<li>Do new attractors in the multidimensional recurrence network emerge, after an intervention has been implemented?</li>
</ul>
</div>
<div id="cross-recurrence-quantification-analysis" class="section level1">
<h1>Cross-Recurrence Quantification Analysis</h1>
<p>Cross-Recurrence Quantification Analysis, or CRQA, is a method of studying the coupling of two time series. As with other types of RQA, the first step of the analysis involves creating recurrence plots. In recurrence plots, the re-occurrence of values is visualised by plotting a time series against another time series (to explore cross-recurrence) or itself (to explore auto-recurrence). Figure below depicts a cross-recurrence plot of two hypothetical time series with discrete states coded as 1 to 6: Yellow (1, 5, 4, 3, 2, 6) and Blue (5, 4, 3, 4, 3, 2). Black cells indicate places where the same value occurs in both series.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"></a>
<a class="sourceLine" id="cb25-2" title="2"><span class="co"># knitr::include_graphics(path = &quot;./figures/rqa_pedagogical.png&quot;)</span></a>
<a class="sourceLine" id="cb25-3" title="3"></a>
<a class="sourceLine" id="cb25-4" title="4">grid<span class="op">::</span><span class="kw">grid.raster</span>(png<span class="op">::</span><span class="kw">readPNG</span>(<span class="st">&quot;./figures/rqa_pedagogical.png&quot;</span>))</a></code></pre></div>
<p><img src="Recurrence-plots_files/figure-html/rqa-pedagogical-1.png" width="105.856" /></p>
<p>These data show a switch in the system state: the blue series precedes the yellow one until time 3-4, after which the yellow series precedes the blue one. While this is merely a pedagogical example (a time series of only six observations would rarely be sufficient to reliably identify patterns), it illustrates the utility of the method in identifying patterns in time series data. For a more in-depth treatment, see:</p>
<ul>
<li><p>Wallot, S., &amp; Leonardi, G. (2018). Analyzing Multivariate Dynamics Using Cross-Recurrence Quantification Analysis (CRQA), Diagonal-Cross-Recurrence Profiles (DCRP), and Multidimensional Recurrence Quantification Analysis (MdRQA) – A Tutorial in R. Frontiers in Psychology, 9. <a href="https://doi.org/10.3389/fpsyg.2018.02232" class="uri">https://doi.org/10.3389/fpsyg.2018.02232</a></p></li>
<li><p>Coco, M. I., &amp; Dale, R. (2014). Cross-recurrence quantification analysis of categorical and continuous time series: an R package. Frontiers in Psychology, 5. <a href="https://doi.org/10.3389/fpsyg.2014.00510" class="uri">https://doi.org/10.3389/fpsyg.2014.00510</a></p></li>
</ul>
</div>
<div id="session-information" class="section level1">
<h1>Session information</h1>
<p>Description of the R environment can be found below.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">devtools<span class="op">::</span><span class="kw">session_info</span>()</a>
<a class="sourceLine" id="cb26-2" title="2"><span class="co">## - Session info ---------------------------</span></a>
<a class="sourceLine" id="cb26-3" title="3"><span class="co">##  setting  value                       </span></a>
<a class="sourceLine" id="cb26-4" title="4"><span class="co">##  version  R version 3.6.1 (2019-07-05)</span></a>
<a class="sourceLine" id="cb26-5" title="5"><span class="co">##  os       Windows 10 x64              </span></a>
<a class="sourceLine" id="cb26-6" title="6"><span class="co">##  system   x86_64, mingw32             </span></a>
<a class="sourceLine" id="cb26-7" title="7"><span class="co">##  ui       RStudio                     </span></a>
<a class="sourceLine" id="cb26-8" title="8"><span class="co">##  language (EN)                        </span></a>
<a class="sourceLine" id="cb26-9" title="9"><span class="co">##  collate  Finnish_Finland.1252        </span></a>
<a class="sourceLine" id="cb26-10" title="10"><span class="co">##  ctype    Finnish_Finland.1252        </span></a>
<a class="sourceLine" id="cb26-11" title="11"><span class="co">##  tz       Europe/Helsinki             </span></a>
<a class="sourceLine" id="cb26-12" title="12"><span class="co">##  date     2020-04-14                  </span></a>
<a class="sourceLine" id="cb26-13" title="13"><span class="co">## </span></a>
<a class="sourceLine" id="cb26-14" title="14"><span class="co">## - Packages -------------------------------</span></a>
<a class="sourceLine" id="cb26-15" title="15"><span class="co">##  package      * version    date       lib</span></a>
<a class="sourceLine" id="cb26-16" title="16"><span class="co">##  abind          1.4-5      2016-07-21 [1]</span></a>
<a class="sourceLine" id="cb26-17" title="17"><span class="co">##  acepack        1.4.1      2016-10-29 [1]</span></a>
<a class="sourceLine" id="cb26-18" title="18"><span class="co">##  assertthat     0.2.1      2019-03-21 [1]</span></a>
<a class="sourceLine" id="cb26-19" title="19"><span class="co">##  backports      1.1.5      2019-10-02 [1]</span></a>
<a class="sourceLine" id="cb26-20" title="20"><span class="co">##  base64enc      0.1-3      2015-07-28 [1]</span></a>
<a class="sourceLine" id="cb26-21" title="21"><span class="co">##  BDgraph        2.62       2019-12-05 [1]</span></a>
<a class="sourceLine" id="cb26-22" title="22"><span class="co">##  bibtex         0.4.2.2    2020-01-02 [1]</span></a>
<a class="sourceLine" id="cb26-23" title="23"><span class="co">##  BiocManager    1.30.10    2019-11-16 [1]</span></a>
<a class="sourceLine" id="cb26-24" title="24"><span class="co">##  bookdown     * 0.18       2020-03-05 [1]</span></a>
<a class="sourceLine" id="cb26-25" title="25"><span class="co">##  broom          0.5.5      2020-02-29 [1]</span></a>
<a class="sourceLine" id="cb26-26" title="26"><span class="co">##  callr          3.4.2      2020-02-12 [1]</span></a>
<a class="sourceLine" id="cb26-27" title="27"><span class="co">##  casnet         0.1.5      2020-01-30 [1]</span></a>
<a class="sourceLine" id="cb26-28" title="28"><span class="co">##  cellranger     1.1.0      2016-07-27 [1]</span></a>
<a class="sourceLine" id="cb26-29" title="29"><span class="co">##  checkmate      2.0.0      2020-02-06 [1]</span></a>
<a class="sourceLine" id="cb26-30" title="30"><span class="co">##  citr           0.3.2      2019-08-19 [1]</span></a>
<a class="sourceLine" id="cb26-31" title="31"><span class="co">##  cli            2.0.2      2020-02-28 [1]</span></a>
<a class="sourceLine" id="cb26-32" title="32"><span class="co">##  cluster        2.1.0      2019-06-19 [2]</span></a>
<a class="sourceLine" id="cb26-33" title="33"><span class="co">##  codetools      0.2-16     2018-12-24 [2]</span></a>
<a class="sourceLine" id="cb26-34" title="34"><span class="co">##  colorspace     1.4-1      2019-03-18 [1]</span></a>
<a class="sourceLine" id="cb26-35" title="35"><span class="co">##  corpcor        1.6.9      2017-04-01 [1]</span></a>
<a class="sourceLine" id="cb26-36" title="36"><span class="co">##  cowplot        1.0.0      2019-07-11 [1]</span></a>
<a class="sourceLine" id="cb26-37" title="37"><span class="co">##  crayon         1.3.4      2017-09-16 [1]</span></a>
<a class="sourceLine" id="cb26-38" title="38"><span class="co">##  crosstalk      1.1.0.1    2020-03-13 [1]</span></a>
<a class="sourceLine" id="cb26-39" title="39"><span class="co">##  curl           4.3        2019-12-02 [1]</span></a>
<a class="sourceLine" id="cb26-40" title="40"><span class="co">##  d3Network      0.5.2.1    2015-01-31 [1]</span></a>
<a class="sourceLine" id="cb26-41" title="41"><span class="co">##  data.table     1.12.8     2019-12-09 [1]</span></a>
<a class="sourceLine" id="cb26-42" title="42"><span class="co">##  DBI            1.1.0      2019-12-15 [1]</span></a>
<a class="sourceLine" id="cb26-43" title="43"><span class="co">##  dbplyr         1.4.2      2019-06-17 [1]</span></a>
<a class="sourceLine" id="cb26-44" title="44"><span class="co">##  desc           1.2.0      2018-05-01 [1]</span></a>
<a class="sourceLine" id="cb26-45" title="45"><span class="co">##  devtools       2.2.2      2020-02-17 [1]</span></a>
<a class="sourceLine" id="cb26-46" title="46"><span class="co">##  digest         0.6.25     2020-02-23 [1]</span></a>
<a class="sourceLine" id="cb26-47" title="47"><span class="co">##  dplyr        * 0.8.5      2020-03-07 [1]</span></a>
<a class="sourceLine" id="cb26-48" title="48"><span class="co">##  DT             0.13       2020-03-23 [1]</span></a>
<a class="sourceLine" id="cb26-49" title="49"><span class="co">##  ellipsis       0.3.0      2019-09-20 [1]</span></a>
<a class="sourceLine" id="cb26-50" title="50"><span class="co">##  evaluate       0.14       2019-05-28 [1]</span></a>
<a class="sourceLine" id="cb26-51" title="51"><span class="co">##  fansi          0.4.1      2020-01-08 [1]</span></a>
<a class="sourceLine" id="cb26-52" title="52"><span class="co">##  farver         2.0.3      2020-01-16 [1]</span></a>
<a class="sourceLine" id="cb26-53" title="53"><span class="co">##  fastmap        1.0.1      2019-10-08 [1]</span></a>
<a class="sourceLine" id="cb26-54" title="54"><span class="co">##  fdrtool        1.2.15     2015-07-08 [1]</span></a>
<a class="sourceLine" id="cb26-55" title="55"><span class="co">##  forcats      * 0.5.0      2020-03-01 [1]</span></a>
<a class="sourceLine" id="cb26-56" title="56"><span class="co">##  foreach        1.4.8      2020-02-09 [1]</span></a>
<a class="sourceLine" id="cb26-57" title="57"><span class="co">##  forecast       8.11       2020-02-09 [1]</span></a>
<a class="sourceLine" id="cb26-58" title="58"><span class="co">##  foreign        0.8-76     2020-03-03 [2]</span></a>
<a class="sourceLine" id="cb26-59" title="59"><span class="co">##  Formula        1.2-3      2018-05-03 [1]</span></a>
<a class="sourceLine" id="cb26-60" title="60"><span class="co">##  fracdiff       1.5-1      2020-01-24 [1]</span></a>
<a class="sourceLine" id="cb26-61" title="61"><span class="co">##  fs             1.3.2      2020-03-05 [1]</span></a>
<a class="sourceLine" id="cb26-62" title="62"><span class="co">##  generics       0.0.2      2018-11-29 [1]</span></a>
<a class="sourceLine" id="cb26-63" title="63"><span class="co">##  gganimate      1.0.5      2020-02-09 [1]</span></a>
<a class="sourceLine" id="cb26-64" title="64"><span class="co">##  ggimage        0.2.7      2020-01-09 [1]</span></a>
<a class="sourceLine" id="cb26-65" title="65"><span class="co">##  ggplot2      * 3.3.0      2020-03-05 [1]</span></a>
<a class="sourceLine" id="cb26-66" title="66"><span class="co">##  ggplotify      0.0.5      2020-03-12 [1]</span></a>
<a class="sourceLine" id="cb26-67" title="67"><span class="co">##  glasso         1.11       2019-10-01 [1]</span></a>
<a class="sourceLine" id="cb26-68" title="68"><span class="co">##  glmnet         3.0-2      2019-12-11 [1]</span></a>
<a class="sourceLine" id="cb26-69" title="69"><span class="co">##  glue           1.3.2      2020-03-12 [1]</span></a>
<a class="sourceLine" id="cb26-70" title="70"><span class="co">##  gridExtra      2.3        2017-09-09 [1]</span></a>
<a class="sourceLine" id="cb26-71" title="71"><span class="co">##  gridGraphics   0.5-0      2020-02-25 [1]</span></a>
<a class="sourceLine" id="cb26-72" title="72"><span class="co">##  gtable         0.3.0      2019-03-25 [1]</span></a>
<a class="sourceLine" id="cb26-73" title="73"><span class="co">##  gtools         3.8.1      2018-06-26 [1]</span></a>
<a class="sourceLine" id="cb26-74" title="74"><span class="co">##  haven          2.2.0      2019-11-08 [1]</span></a>
<a class="sourceLine" id="cb26-75" title="75"><span class="co">##  highr          0.8        2019-03-20 [1]</span></a>
<a class="sourceLine" id="cb26-76" title="76"><span class="co">##  Hmisc          4.4-0      2020-03-23 [1]</span></a>
<a class="sourceLine" id="cb26-77" title="77"><span class="co">##  hms            0.5.3      2020-01-08 [1]</span></a>
<a class="sourceLine" id="cb26-78" title="78"><span class="co">##  htmlTable      1.13.3     2019-12-04 [1]</span></a>
<a class="sourceLine" id="cb26-79" title="79"><span class="co">##  htmltools      0.4.0      2019-10-04 [1]</span></a>
<a class="sourceLine" id="cb26-80" title="80"><span class="co">##  htmlwidgets    1.5.1      2019-10-08 [1]</span></a>
<a class="sourceLine" id="cb26-81" title="81"><span class="co">##  httpuv         1.5.2      2019-09-11 [1]</span></a>
<a class="sourceLine" id="cb26-82" title="82"><span class="co">##  httr           1.4.1      2019-08-05 [1]</span></a>
<a class="sourceLine" id="cb26-83" title="83"><span class="co">##  huge           1.3.4      2019-10-28 [1]</span></a>
<a class="sourceLine" id="cb26-84" title="84"><span class="co">##  igraph         1.2.4.2    2019-11-27 [1]</span></a>
<a class="sourceLine" id="cb26-85" title="85"><span class="co">##  invctr         0.1.0      2019-03-07 [1]</span></a>
<a class="sourceLine" id="cb26-86" title="86"><span class="co">##  iterators      1.0.12     2019-07-26 [1]</span></a>
<a class="sourceLine" id="cb26-87" title="87"><span class="co">##  jpeg           0.1-8.1    2019-10-24 [1]</span></a>
<a class="sourceLine" id="cb26-88" title="88"><span class="co">##  jsonlite       1.6.1      2020-02-02 [1]</span></a>
<a class="sourceLine" id="cb26-89" title="89"><span class="co">##  knitr        * 1.28       2020-02-06 [1]</span></a>
<a class="sourceLine" id="cb26-90" title="90"><span class="co">##  labeling       0.3        2014-08-23 [1]</span></a>
<a class="sourceLine" id="cb26-91" title="91"><span class="co">##  later          1.0.0      2019-10-04 [1]</span></a>
<a class="sourceLine" id="cb26-92" title="92"><span class="co">##  lattice        0.20-40    2020-02-19 [2]</span></a>
<a class="sourceLine" id="cb26-93" title="93"><span class="co">##  latticeExtra   0.6-29     2019-12-19 [1]</span></a>
<a class="sourceLine" id="cb26-94" title="94"><span class="co">##  lavaan         0.6-5      2019-08-28 [1]</span></a>
<a class="sourceLine" id="cb26-95" title="95"><span class="co">##  leaps          3.1        2020-01-16 [1]</span></a>
<a class="sourceLine" id="cb26-96" title="96"><span class="co">##  lifecycle      0.2.0      2020-03-06 [1]</span></a>
<a class="sourceLine" id="cb26-97" title="97"><span class="co">##  lmtest         0.9-37     2019-04-30 [1]</span></a>
<a class="sourceLine" id="cb26-98" title="98"><span class="co">##  locfit         1.5-9.2    2020-03-23 [1]</span></a>
<a class="sourceLine" id="cb26-99" title="99"><span class="co">##  lubridate      1.7.4      2018-04-11 [1]</span></a>
<a class="sourceLine" id="cb26-100" title="100"><span class="co">##  magick         2.3        2020-01-24 [1]</span></a>
<a class="sourceLine" id="cb26-101" title="101"><span class="co">##  magrittr       1.5        2014-11-22 [1]</span></a>
<a class="sourceLine" id="cb26-102" title="102"><span class="co">##  MASS           7.3-51.5   2019-12-20 [2]</span></a>
<a class="sourceLine" id="cb26-103" title="103"><span class="co">##  Matrix         1.2-18     2019-11-27 [2]</span></a>
<a class="sourceLine" id="cb26-104" title="104"><span class="co">##  matrixcalc     1.0-3      2012-09-15 [1]</span></a>
<a class="sourceLine" id="cb26-105" title="105"><span class="co">##  memoise        1.1.0      2017-04-21 [1]</span></a>
<a class="sourceLine" id="cb26-106" title="106"><span class="co">##  mgcv           1.8-31     2019-11-09 [2]</span></a>
<a class="sourceLine" id="cb26-107" title="107"><span class="co">##  mgm          * 1.2-8      2019-11-19 [1]</span></a>
<a class="sourceLine" id="cb26-108" title="108"><span class="co">##  mime           0.9        2020-02-04 [1]</span></a>
<a class="sourceLine" id="cb26-109" title="109"><span class="co">##  miniUI         0.1.1.1    2018-05-18 [1]</span></a>
<a class="sourceLine" id="cb26-110" title="110"><span class="co">##  mnormt         1.5-6      2020-02-03 [1]</span></a>
<a class="sourceLine" id="cb26-111" title="111"><span class="co">##  modelr         0.1.6      2020-02-22 [1]</span></a>
<a class="sourceLine" id="cb26-112" title="112"><span class="co">##  munsell        0.5.0      2018-06-12 [1]</span></a>
<a class="sourceLine" id="cb26-113" title="113"><span class="co">##  nlme           3.1-145    2020-03-04 [2]</span></a>
<a class="sourceLine" id="cb26-114" title="114"><span class="co">##  nnet           7.3-13     2020-02-25 [2]</span></a>
<a class="sourceLine" id="cb26-115" title="115"><span class="co">##  pander         0.6.3      2018-11-06 [1]</span></a>
<a class="sourceLine" id="cb26-116" title="116"><span class="co">##  papaja         0.1.0.9942 2020-03-23 [1]</span></a>
<a class="sourceLine" id="cb26-117" title="117"><span class="co">##  patchwork    * 1.0.0      2019-12-01 [1]</span></a>
<a class="sourceLine" id="cb26-118" title="118"><span class="co">##  pbapply        1.4-2      2019-08-31 [1]</span></a>
<a class="sourceLine" id="cb26-119" title="119"><span class="co">##  pbivnorm       0.6.0      2015-01-23 [1]</span></a>
<a class="sourceLine" id="cb26-120" title="120"><span class="co">##  pillar         1.4.3      2019-12-20 [1]</span></a>
<a class="sourceLine" id="cb26-121" title="121"><span class="co">##  pkgbuild       1.0.6      2019-10-09 [1]</span></a>
<a class="sourceLine" id="cb26-122" title="122"><span class="co">##  pkgconfig      2.0.3      2019-09-22 [1]</span></a>
<a class="sourceLine" id="cb26-123" title="123"><span class="co">##  pkgload        1.0.2      2018-10-29 [1]</span></a>
<a class="sourceLine" id="cb26-124" title="124"><span class="co">##  plyr           1.8.6      2020-03-03 [1]</span></a>
<a class="sourceLine" id="cb26-125" title="125"><span class="co">##  png            0.1-7      2013-12-03 [1]</span></a>
<a class="sourceLine" id="cb26-126" title="126"><span class="co">##  prettyunits    1.1.1      2020-01-24 [1]</span></a>
<a class="sourceLine" id="cb26-127" title="127"><span class="co">##  processx       3.4.2      2020-02-09 [1]</span></a>
<a class="sourceLine" id="cb26-128" title="128"><span class="co">##  progress       1.2.2      2019-05-16 [1]</span></a>
<a class="sourceLine" id="cb26-129" title="129"><span class="co">##  promises       1.1.0      2019-10-04 [1]</span></a>
<a class="sourceLine" id="cb26-130" title="130"><span class="co">##  proxy          0.4-23     2019-03-05 [1]</span></a>
<a class="sourceLine" id="cb26-131" title="131"><span class="co">##  ps             1.3.2      2020-02-13 [1]</span></a>
<a class="sourceLine" id="cb26-132" title="132"><span class="co">##  psych          1.9.12.31  2020-01-08 [1]</span></a>
<a class="sourceLine" id="cb26-133" title="133"><span class="co">##  purrr        * 0.3.3      2019-10-18 [1]</span></a>
<a class="sourceLine" id="cb26-134" title="134"><span class="co">##  qgraph         1.6.5      2020-02-21 [1]</span></a>
<a class="sourceLine" id="cb26-135" title="135"><span class="co">##  quadprog       1.5-8      2019-11-20 [1]</span></a>
<a class="sourceLine" id="cb26-136" title="136"><span class="co">##  quantmod       0.4-16     2020-03-08 [1]</span></a>
<a class="sourceLine" id="cb26-137" title="137"><span class="co">##  R6             2.4.1      2019-11-12 [1]</span></a>
<a class="sourceLine" id="cb26-138" title="138"><span class="co">##  randtests      1.0        2014-11-17 [1]</span></a>
<a class="sourceLine" id="cb26-139" title="139"><span class="co">##  RColorBrewer   1.1-2      2014-12-07 [1]</span></a>
<a class="sourceLine" id="cb26-140" title="140"><span class="co">##  Rcpp           1.0.4      2020-03-17 [1]</span></a>
<a class="sourceLine" id="cb26-141" title="141"><span class="co">##  readr        * 1.3.1      2018-12-21 [1]</span></a>
<a class="sourceLine" id="cb26-142" title="142"><span class="co">##  readxl         1.3.1      2019-03-13 [1]</span></a>
<a class="sourceLine" id="cb26-143" title="143"><span class="co">##  RefManageR     1.2.12     2019-04-03 [1]</span></a>
<a class="sourceLine" id="cb26-144" title="144"><span class="co">##  remotes        2.1.1      2020-02-15 [1]</span></a>
<a class="sourceLine" id="cb26-145" title="145"><span class="co">##  reprex         0.3.0      2019-05-16 [1]</span></a>
<a class="sourceLine" id="cb26-146" title="146"><span class="co">##  reshape2       1.4.3      2017-12-11 [1]</span></a>
<a class="sourceLine" id="cb26-147" title="147"><span class="co">##  rjson          0.2.20     2018-06-08 [1]</span></a>
<a class="sourceLine" id="cb26-148" title="148"><span class="co">##  rlang          0.4.5      2020-03-01 [1]</span></a>
<a class="sourceLine" id="cb26-149" title="149"><span class="co">##  rmarkdown      2.1        2020-01-20 [1]</span></a>
<a class="sourceLine" id="cb26-150" title="150"><span class="co">##  rmdfiltr       0.1.2      2019-12-11 [1]</span></a>
<a class="sourceLine" id="cb26-151" title="151"><span class="co">##  rpart          4.1-15     2019-04-12 [2]</span></a>
<a class="sourceLine" id="cb26-152" title="152"><span class="co">##  rprojroot      1.3-2      2018-01-03 [1]</span></a>
<a class="sourceLine" id="cb26-153" title="153"><span class="co">##  rstudioapi     0.11       2020-02-07 [1]</span></a>
<a class="sourceLine" id="cb26-154" title="154"><span class="co">##  rvcheck        0.1.8      2020-03-01 [1]</span></a>
<a class="sourceLine" id="cb26-155" title="155"><span class="co">##  rvest          0.3.5      2019-11-08 [1]</span></a>
<a class="sourceLine" id="cb26-156" title="156"><span class="co">##  scales         1.1.0      2019-11-18 [1]</span></a>
<a class="sourceLine" id="cb26-157" title="157"><span class="co">##  sessioninfo    1.1.1      2018-11-05 [1]</span></a>
<a class="sourceLine" id="cb26-158" title="158"><span class="co">##  shape          1.4.4      2018-02-07 [1]</span></a>
<a class="sourceLine" id="cb26-159" title="159"><span class="co">##  shiny        * 1.4.0.2    2020-03-13 [1]</span></a>
<a class="sourceLine" id="cb26-160" title="160"><span class="co">##  shinyjs        1.1        2020-01-13 [1]</span></a>
<a class="sourceLine" id="cb26-161" title="161"><span class="co">##  stringi        1.4.6      2020-02-17 [1]</span></a>
<a class="sourceLine" id="cb26-162" title="162"><span class="co">##  stringr      * 1.4.0      2019-02-10 [1]</span></a>
<a class="sourceLine" id="cb26-163" title="163"><span class="co">##  survival       3.1-11     2020-03-07 [2]</span></a>
<a class="sourceLine" id="cb26-164" title="164"><span class="co">##  testthat       2.3.2      2020-03-02 [1]</span></a>
<a class="sourceLine" id="cb26-165" title="165"><span class="co">##  tibble       * 2.1.3      2019-06-06 [1]</span></a>
<a class="sourceLine" id="cb26-166" title="166"><span class="co">##  tidyr        * 1.0.2      2020-01-24 [1]</span></a>
<a class="sourceLine" id="cb26-167" title="167"><span class="co">##  tidyselect     1.0.0      2020-01-27 [1]</span></a>
<a class="sourceLine" id="cb26-168" title="168"><span class="co">##  tidyverse    * 1.3.0      2019-11-21 [1]</span></a>
<a class="sourceLine" id="cb26-169" title="169"><span class="co">##  timeDate       3043.102   2018-02-21 [1]</span></a>
<a class="sourceLine" id="cb26-170" title="170"><span class="co">##  TSA            1.2        2018-06-30 [1]</span></a>
<a class="sourceLine" id="cb26-171" title="171"><span class="co">##  tseries        0.10-47    2019-06-05 [1]</span></a>
<a class="sourceLine" id="cb26-172" title="172"><span class="co">##  TTR            0.23-6     2019-12-15 [1]</span></a>
<a class="sourceLine" id="cb26-173" title="173"><span class="co">##  tweenr         1.0.1      2018-12-14 [1]</span></a>
<a class="sourceLine" id="cb26-174" title="174"><span class="co">##  urca           1.3-0      2016-09-06 [1]</span></a>
<a class="sourceLine" id="cb26-175" title="175"><span class="co">##  usethis        1.5.1      2019-07-04 [1]</span></a>
<a class="sourceLine" id="cb26-176" title="176"><span class="co">##  vctrs          0.2.4      2020-03-10 [1]</span></a>
<a class="sourceLine" id="cb26-177" title="177"><span class="co">##  viridis        0.5.1      2018-03-29 [1]</span></a>
<a class="sourceLine" id="cb26-178" title="178"><span class="co">##  viridisLite    0.3.0      2018-02-01 [1]</span></a>
<a class="sourceLine" id="cb26-179" title="179"><span class="co">##  webshot        0.5.2      2019-11-22 [1]</span></a>
<a class="sourceLine" id="cb26-180" title="180"><span class="co">##  whisker        0.4        2019-08-28 [1]</span></a>
<a class="sourceLine" id="cb26-181" title="181"><span class="co">##  withr          2.1.2      2018-03-15 [1]</span></a>
<a class="sourceLine" id="cb26-182" title="182"><span class="co">##  xfun           0.12       2020-01-13 [1]</span></a>
<a class="sourceLine" id="cb26-183" title="183"><span class="co">##  xml2           1.2.5      2020-03-11 [1]</span></a>
<a class="sourceLine" id="cb26-184" title="184"><span class="co">##  xtable         1.8-4      2019-04-21 [1]</span></a>
<a class="sourceLine" id="cb26-185" title="185"><span class="co">##  xts            0.12-0     2020-01-19 [1]</span></a>
<a class="sourceLine" id="cb26-186" title="186"><span class="co">##  yaml           2.2.1      2020-02-01 [1]</span></a>
<a class="sourceLine" id="cb26-187" title="187"><span class="co">##  zip            2.0.4      2019-09-01 [1]</span></a>
<a class="sourceLine" id="cb26-188" title="188"><span class="co">##  zoo            1.8-7      2020-01-10 [1]</span></a>
<a class="sourceLine" id="cb26-189" title="189"><span class="co">##  source                               </span></a>
<a class="sourceLine" id="cb26-190" title="190"><span class="co">##  CRAN (R 3.6.0)                       </span></a>
<a class="sourceLine" id="cb26-191" title="191"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-192" title="192"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-193" title="193"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-194" title="194"><span class="co">##  CRAN (R 3.6.0)                       </span></a>
<a class="sourceLine" id="cb26-195" title="195"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-196" title="196"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-197" title="197"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-198" title="198"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-199" title="199"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-200" title="200"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-201" title="201"><span class="co">##  Github (fredhasselman/casnet@35ee389)</span></a>
<a class="sourceLine" id="cb26-202" title="202"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-203" title="203"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-204" title="204"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-205" title="205"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-206" title="206"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-207" title="207"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-208" title="208"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-209" title="209"><span class="co">##  CRAN (R 3.6.0)                       </span></a>
<a class="sourceLine" id="cb26-210" title="210"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-211" title="211"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-212" title="212"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-213" title="213"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-214" title="214"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-215" title="215"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-216" title="216"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-217" title="217"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-218" title="218"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-219" title="219"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-220" title="220"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-221" title="221"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-222" title="222"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-223" title="223"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-224" title="224"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-225" title="225"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-226" title="226"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-227" title="227"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-228" title="228"><span class="co">##  CRAN (R 3.6.0)                       </span></a>
<a class="sourceLine" id="cb26-229" title="229"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-230" title="230"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-231" title="231"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-232" title="232"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-233" title="233"><span class="co">##  CRAN (R 3.6.0)                       </span></a>
<a class="sourceLine" id="cb26-234" title="234"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-235" title="235"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-236" title="236"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-237" title="237"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-238" title="238"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-239" title="239"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-240" title="240"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-241" title="241"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-242" title="242"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-243" title="243"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-244" title="244"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-245" title="245"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-246" title="246"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-247" title="247"><span class="co">##  CRAN (R 3.6.0)                       </span></a>
<a class="sourceLine" id="cb26-248" title="248"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-249" title="249"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-250" title="250"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-251" title="251"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-252" title="252"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-253" title="253"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-254" title="254"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-255" title="255"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-256" title="256"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-257" title="257"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-258" title="258"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-259" title="259"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-260" title="260"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-261" title="261"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-262" title="262"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-263" title="263"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-264" title="264"><span class="co">##  CRAN (R 3.6.0)                       </span></a>
<a class="sourceLine" id="cb26-265" title="265"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-266" title="266"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-267" title="267"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-268" title="268"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-269" title="269"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-270" title="270"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-271" title="271"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-272" title="272"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-273" title="273"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-274" title="274"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-275" title="275"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-276" title="276"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-277" title="277"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-278" title="278"><span class="co">##  CRAN (R 3.6.0)                       </span></a>
<a class="sourceLine" id="cb26-279" title="279"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-280" title="280"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-281" title="281"><span class="co">##  Github (jmbh/mgm@bacd9c5)            </span></a>
<a class="sourceLine" id="cb26-282" title="282"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-283" title="283"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-284" title="284"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-285" title="285"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-286" title="286"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-287" title="287"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-288" title="288"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-289" title="289"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-290" title="290"><span class="co">##  Github (crsh/papaja@02f3bd1)         </span></a>
<a class="sourceLine" id="cb26-291" title="291"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-292" title="292"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-293" title="293"><span class="co">##  CRAN (R 3.6.0)                       </span></a>
<a class="sourceLine" id="cb26-294" title="294"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-295" title="295"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-296" title="296"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-297" title="297"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-298" title="298"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-299" title="299"><span class="co">##  CRAN (R 3.6.0)                       </span></a>
<a class="sourceLine" id="cb26-300" title="300"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-301" title="301"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-302" title="302"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-303" title="303"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-304" title="304"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-305" title="305"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-306" title="306"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-307" title="307"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-308" title="308"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-309" title="309"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-310" title="310"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-311" title="311"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-312" title="312"><span class="co">##  CRAN (R 3.6.0)                       </span></a>
<a class="sourceLine" id="cb26-313" title="313"><span class="co">##  CRAN (R 3.6.0)                       </span></a>
<a class="sourceLine" id="cb26-314" title="314"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-315" title="315"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-316" title="316"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-317" title="317"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-318" title="318"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-319" title="319"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-320" title="320"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-321" title="321"><span class="co">##  CRAN (R 3.6.0)                       </span></a>
<a class="sourceLine" id="cb26-322" title="322"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-323" title="323"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-324" title="324"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-325" title="325"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-326" title="326"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-327" title="327"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-328" title="328"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-329" title="329"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-330" title="330"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-331" title="331"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-332" title="332"><span class="co">##  CRAN (R 3.6.0)                       </span></a>
<a class="sourceLine" id="cb26-333" title="333"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-334" title="334"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-335" title="335"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-336" title="336"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-337" title="337"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-338" title="338"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-339" title="339"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-340" title="340"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-341" title="341"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-342" title="342"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-343" title="343"><span class="co">##  CRAN (R 3.6.0)                       </span></a>
<a class="sourceLine" id="cb26-344" title="344"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-345" title="345"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-346" title="346"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-347" title="347"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-348" title="348"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-349" title="349"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-350" title="350"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-351" title="351"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-352" title="352"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-353" title="353"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-354" title="354"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-355" title="355"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-356" title="356"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-357" title="357"><span class="co">##  CRAN (R 3.6.3)                       </span></a>
<a class="sourceLine" id="cb26-358" title="358"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-359" title="359"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-360" title="360"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-361" title="361"><span class="co">##  CRAN (R 3.6.1)                       </span></a>
<a class="sourceLine" id="cb26-362" title="362"><span class="co">##  CRAN (R 3.6.2)                       </span></a>
<a class="sourceLine" id="cb26-363" title="363"><span class="co">## </span></a>
<a class="sourceLine" id="cb26-364" title="364"><span class="co">## [1] C:/localdata/hema/rlibs</span></a>
<a class="sourceLine" id="cb26-365" title="365"><span class="co">## [2] C:/Program Files/R/R-3.6.1/library</span></a>
<a class="sourceLine" id="cb26-366" title="366"></a>
<a class="sourceLine" id="cb26-367" title="367">pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">sessionInfo</span>())</a></code></pre></div>
<p><strong>R version 3.6.1 (2019-07-05)</strong></p>
<p><strong>Platform:</strong> x86_64-w64-mingw32/x64 (64-bit)</p>
<p><strong>locale:</strong> <em>LC_COLLATE=Finnish_Finland.1252</em>, <em>LC_CTYPE=Finnish_Finland.1252</em>, <em>LC_MONETARY=Finnish_Finland.1252</em>, <em>LC_NUMERIC=C</em> and <em>LC_TIME=Finnish_Finland.1252</em></p>
<p><strong>attached base packages:</strong> <em>stats</em>, <em>graphics</em>, <em>grDevices</em>, <em>utils</em>, <em>datasets</em>, <em>methods</em> and <em>base</em></p>
<p><strong>other attached packages:</strong> <em>shiny(v.1.4.0.2)</em>, <em>patchwork(v.1.0.0)</em>, <em>bookdown(v.0.18)</em>, <em>knitr(v.1.28)</em>, <em>mgm(v.1.2-8)</em>, <em>forcats(v.0.5.0)</em>, <em>stringr(v.1.4.0)</em>, <em>dplyr(v.0.8.5)</em>, <em>purrr(v.0.3.3)</em>, <em>readr(v.1.3.1)</em>, <em>tidyr(v.1.0.2)</em>, <em>tibble(v.2.1.3)</em>, <em>ggplot2(v.3.3.0)</em> and <em>tidyverse(v.1.3.0)</em></p>
<p><strong>loaded via a namespace (and not attached):</strong> <em>tidyselect(v.1.0.0)</em>, <em>htmlwidgets(v.1.5.1)</em>, <em>grid(v.3.6.1)</em>, <em>devtools(v.2.2.2)</em>, <em>munsell(v.0.5.0)</em>, <em>codetools(v.0.2-16)</em>, <em>papaja(v.0.1.0.9942)</em>, <em>DT(v.0.13)</em>, <em>miniUI(v.0.1.1.1)</em>, <em>withr(v.2.1.2)</em>, <em>colorspace(v.1.4-1)</em>, <em>highr(v.0.8)</em>, <em>rstudioapi(v.0.11)</em>, <em>leaps(v.3.1)</em>, <em>stats4(v.3.6.1)</em>, <em>TTR(v.0.23-6)</em>, <em>huge(v.1.3.4)</em>, <em>labeling(v.0.3)</em>, <em>mnormt(v.1.5-6)</em>, <em>farver(v.2.0.3)</em>, <em>rprojroot(v.1.3-2)</em>, <em>vctrs(v.0.2.4)</em>, <em>generics(v.0.0.2)</em>, <em>xfun(v.0.12)</em>, <em>R6(v.2.4.1)</em>, <em>locfit(v.1.5-9.2)</em>, <em>gridGraphics(v.0.5-0)</em>, <em>assertthat(v.0.2.1)</em>, <em>promises(v.1.1.0)</em>, <em>scales(v.1.1.0)</em>, <em>nnet(v.7.3-13)</em>, <em>forecast(v.8.11)</em>, <em>gtable(v.0.3.0)</em>, <em>processx(v.3.4.2)</em>, <em>timeDate(v.3043.102)</em>, <em>rlang(v.0.4.5)</em>, <em>splines(v.3.6.1)</em>, <em>casnet(v.0.1.5)</em>, <em>acepack(v.1.4.1)</em>, <em>broom(v.0.5.5)</em>, <em>checkmate(v.2.0.0)</em>, <em>BiocManager(v.1.30.10)</em>, <em>yaml(v.2.2.1)</em>, <em>reshape2(v.1.4.3)</em>, <em>abind(v.1.4-5)</em>, <em>modelr(v.0.1.6)</em>, <em>d3Network(v.0.5.2.1)</em>, <em>ggimage(v.0.2.7)</em>, <em>crosstalk(v.1.1.0.1)</em>, <em>backports(v.1.1.5)</em>, <em>httpuv(v.1.5.2)</em>, <em>quantmod(v.0.4-16)</em>, <em>Hmisc(v.4.4-0)</em>, <em>tools(v.3.6.1)</em>, <em>usethis(v.1.5.1)</em>, <em>psych(v.1.9.12.31)</em>, <em>lavaan(v.0.6-5)</em>, <em>ggplotify(v.0.0.5)</em>, <em>ellipsis(v.0.3.0)</em>, <em>RColorBrewer(v.1.1-2)</em>, <em>proxy(v.0.4-23)</em>, <em>sessioninfo(v.1.1.1)</em>, <em>Rcpp(v.1.0.4)</em>, <em>plyr(v.1.8.6)</em>, <em>base64enc(v.0.1-3)</em>, <em>progress(v.1.2.2)</em>, <em>ps(v.1.3.2)</em>, <em>prettyunits(v.1.1.1)</em>, <em>rpart(v.4.1-15)</em>, <em>pbapply(v.1.4-2)</em>, <em>viridis(v.0.5.1)</em>, <em>cowplot(v.1.0.0)</em>, <em>fracdiff(v.1.5-1)</em>, <em>zoo(v.1.8-7)</em>, <em>qgraph(v.1.6.5)</em>, <em>haven(v.2.2.0)</em>, <em>cluster(v.2.1.0)</em>, <em>fs(v.1.3.2)</em>, <em>invctr(v.0.1.0)</em>, <em>magrittr(v.1.5)</em>, <em>data.table(v.1.12.8)</em>, <em>magick(v.2.3)</em>, <em>lmtest(v.0.9-37)</em>, <em>reprex(v.0.3.0)</em>, <em>matrixcalc(v.1.0-3)</em>, <em>whisker(v.0.4)</em>, <em>pkgload(v.1.0.2)</em>, <em>shinyjs(v.1.1)</em>, <em>hms(v.0.5.3)</em>, <em>mime(v.0.9)</em>, <em>evaluate(v.0.14)</em>, <em>xtable(v.1.8-4)</em>, <em>citr(v.0.3.2)</em>, <em>jpeg(v.0.1-8.1)</em>, <em>readxl(v.1.3.1)</em>, <em>gridExtra(v.2.3)</em>, <em>shape(v.1.4.4)</em>, <em>testthat(v.2.3.2)</em>, <em>compiler(v.3.6.1)</em>, <em>crayon(v.1.3.4)</em>, <em>htmltools(v.0.4.0)</em>, <em>mgcv(v.1.8-31)</em>, <em>corpcor(v.1.6.9)</em>, <em>later(v.1.0.0)</em>, <em>rmdfiltr(v.0.1.2)</em>, <em>Formula(v.1.2-3)</em>, <em>lubridate(v.1.7.4)</em>, <em>DBI(v.1.1.0)</em>, <em>tweenr(v.1.0.1)</em>, <em>dbplyr(v.1.4.2)</em>, <em>MASS(v.7.3-51.5)</em>, <em>Matrix(v.1.2-18)</em>, <em>cli(v.2.0.2)</em>, <em>quadprog(v.1.5-8)</em>, <em>parallel(v.3.6.1)</em>, <em>igraph(v.1.2.4.2)</em>, <em>BDgraph(v.2.62)</em>, <em>pkgconfig(v.2.0.3)</em>, <em>rvcheck(v.0.1.8)</em>, <em>RefManageR(v.1.2.12)</em>, <em>foreign(v.0.8-76)</em>, <em>xml2(v.1.2.5)</em>, <em>foreach(v.1.4.8)</em>, <em>pbivnorm(v.0.6.0)</em>, <em>webshot(v.0.5.2)</em>, <em>bibtex(v.0.4.2.2)</em>, <em>rvest(v.0.3.5)</em>, <em>callr(v.3.4.2)</em>, <em>digest(v.0.6.25)</em>, <em>rmarkdown(v.2.1)</em>, <em>cellranger(v.1.1.0)</em>, <em>htmlTable(v.1.13.3)</em>, <em>curl(v.4.3)</em>, <em>gtools(v.3.8.1)</em>, <em>urca(v.1.3-0)</em>, <em>rjson(v.0.2.20)</em>, <em>lifecycle(v.0.2.0)</em>, <em>nlme(v.3.1-145)</em>, <em>glasso(v.1.11)</em>, <em>jsonlite(v.1.6.1)</em>, <em>tseries(v.0.10-47)</em>, <em>desc(v.1.2.0)</em>, <em>viridisLite(v.0.3.0)</em>, <em>fansi(v.0.4.1)</em>, <em>pillar(v.1.4.3)</em>, <em>lattice(v.0.20-40)</em>, <em>fastmap(v.1.0.1)</em>, <em>httr(v.1.4.1)</em>, <em>pkgbuild(v.1.0.6)</em>, <em>survival(v.3.1-11)</em>, <em>TSA(v.1.2)</em>, <em>glue(v.1.3.2)</em>, <em>xts(v.0.12-0)</em>, <em>remotes(v.2.1.1)</em>, <em>gganimate(v.1.0.5)</em>, <em>zip(v.2.0.4)</em>, <em>fdrtool(v.1.2.15)</em>, <em>png(v.0.1-7)</em>, <em>iterators(v.1.0.12)</em>, <em>pander(v.0.6.3)</em>, <em>glmnet(v.3.0-2)</em>, <em>stringi(v.1.4.6)</em>, <em>latticeExtra(v.0.6-29)</em>, <em>randtests(v.1.0)</em> and <em>memoise(v.1.1.0)</em></p>
<!-- </div> -->
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
